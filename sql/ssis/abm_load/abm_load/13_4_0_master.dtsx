<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="11/14/2017 2:33:50 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="SQL2014A8"
  DTS:CreatorName="SANDAGNET\gsc"
  DTS:DTSID="{DA2BB4B7-3F37-43A0-85B5-F8B787C50C1E}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:FailParentOnFailure="True"
  DTS:LastModifiedProductVersion="14.0.3002.68"
  DTS:LocaleID="1033"
  DTS:MaxErrorCount="0"
  DTS:ObjectName="13_4_0_master"
  DTS:PackageType="5"
  DTS:VersionBuild="65"
  DTS:VersionGUID="{67BF37D1-7AC1-4314-A4E9-E7FFFEFBD1EE}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{BAA274F3-B65C-4314-9D01-91D4D344BB2D}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="scenario_id">
      <DTS:VariableValue
        DTS:DataType="2">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{7480B0B9-521E-400B-BFC2-8BE3C3494200}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="scenario_iteration">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{5E64A466-49B8-49FE-BA55-137AE8E3681D}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="scenario_path">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{968F3B00-775D-4773-8BD7-762A2FA4FF9E}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="scenario_year">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\13_2_4_complete"
      DTS:CreationName="Microsoft.ExecutePackageTask"
      DTS:DelayValidation="True"
      DTS:Description="Execute Package Task"
      DTS:DTSID="{19EAD5A6-D18B-430D-A4BF-9B445F485FF9}"
      DTS:ExecutableType="Microsoft.ExecutePackageTask"
      DTS:FailPackageOnFailure="True"
      DTS:FailParentOnFailure="True"
      DTS:LocaleID="-1"
      DTS:MaxErrorCount="0"
      DTS:ObjectName="13_2_4_complete"
      DTS:TaskContact="Microsoft Corporation; Microsoft SQL Server; Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <ExecutePackageTask>
          <UseProjectReference>True</UseProjectReference>
          <PackageName>13_2_4_complete.dtsx</PackageName>
          <ParameterAssignment>
            <ParameterName>scenario_id</ParameterName>
            <BindedVariableOrParameterName>User::scenario_id</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_iteration</ParameterName>
            <BindedVariableOrParameterName>User::scenario_iteration</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_path</ParameterName>
            <BindedVariableOrParameterName>User::scenario_path</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_year</ParameterName>
            <BindedVariableOrParameterName>User::scenario_year</BindedVariableOrParameterName>
          </ParameterAssignment>
        </ExecutePackageTask>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\13_2_4_network"
      DTS:CreationName="Microsoft.ExecutePackageTask"
      DTS:DelayValidation="True"
      DTS:Description="Execute Package Task"
      DTS:DTSID="{8345D9FD-A2A4-41EB-8D57-01FAF52A5FDB}"
      DTS:ExecutableType="Microsoft.ExecutePackageTask"
      DTS:FailPackageOnFailure="True"
      DTS:FailParentOnFailure="True"
      DTS:LocaleID="-1"
      DTS:MaxErrorCount="0"
      DTS:ObjectName="13_2_4_network"
      DTS:TaskContact="Microsoft Corporation; Microsoft SQL Server; Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <ExecutePackageTask>
          <UseProjectReference>True</UseProjectReference>
          <PackageName>13_2_4_network.dtsx</PackageName>
          <ParameterAssignment>
            <ParameterName>scenario_id</ParameterName>
            <BindedVariableOrParameterName>User::scenario_id</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_iteration</ParameterName>
            <BindedVariableOrParameterName>User::scenario_iteration</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_path</ParameterName>
            <BindedVariableOrParameterName>User::scenario_path</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_year</ParameterName>
            <BindedVariableOrParameterName>User::scenario_year</BindedVariableOrParameterName>
          </ParameterAssignment>
        </ExecutePackageTask>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\13_2_4_other"
      DTS:CreationName="Microsoft.ExecutePackageTask"
      DTS:DelayValidation="True"
      DTS:Description="Execute Package Task"
      DTS:DTSID="{1695F5D6-B7A9-4D01-825C-3E6123FBF93D}"
      DTS:ExecutableType="Microsoft.ExecutePackageTask"
      DTS:FailPackageOnFailure="True"
      DTS:FailParentOnFailure="True"
      DTS:LocaleID="-1"
      DTS:MaxErrorCount="0"
      DTS:ObjectName="13_2_4_other"
      DTS:TaskContact="Microsoft Corporation; Microsoft SQL Server; Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <ExecutePackageTask>
          <UseProjectReference>True</UseProjectReference>
          <PackageName>13_2_4_other.dtsx</PackageName>
          <ParameterAssignment>
            <ParameterName>scenario_id</ParameterName>
            <BindedVariableOrParameterName>User::scenario_id</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_iteration</ParameterName>
            <BindedVariableOrParameterName>User::scenario_iteration</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_path</ParameterName>
            <BindedVariableOrParameterName>User::scenario_path</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_year</ParameterName>
            <BindedVariableOrParameterName>User::scenario_year</BindedVariableOrParameterName>
          </ParameterAssignment>
        </ExecutePackageTask>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\13_2_4_skims"
      DTS:CreationName="Microsoft.ExecutePackageTask"
      DTS:DelayValidation="True"
      DTS:Description="Execute Package Task"
      DTS:DTSID="{33BD6378-2578-45F6-A771-C94D7D807C8E}"
      DTS:ExecutableType="Microsoft.ExecutePackageTask"
      DTS:FailPackageOnFailure="True"
      DTS:FailParentOnFailure="True"
      DTS:LocaleID="-1"
      DTS:MaxErrorCount="0"
      DTS:ObjectName="13_2_4_skims"
      DTS:TaskContact="Microsoft Corporation; Microsoft SQL Server; Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <ExecutePackageTask>
          <UseProjectReference>True</UseProjectReference>
          <PackageName>13_2_4_skims.dtsx</PackageName>
          <ParameterAssignment>
            <ParameterName>scenario_id</ParameterName>
            <BindedVariableOrParameterName>User::scenario_id</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_iteration</ParameterName>
            <BindedVariableOrParameterName>User::scenario_iteration</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_path</ParameterName>
            <BindedVariableOrParameterName>User::scenario_path</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_year</ParameterName>
            <BindedVariableOrParameterName>User::scenario_year</BindedVariableOrParameterName>
          </ParameterAssignment>
        </ExecutePackageTask>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\13_2_4_tripagg"
      DTS:CreationName="Microsoft.ExecutePackageTask"
      DTS:DelayValidation="True"
      DTS:Description="Execute Package Task"
      DTS:DTSID="{B09FF55F-7BD8-4EB8-BDA5-727AA7DB92D8}"
      DTS:ExecutableType="Microsoft.ExecutePackageTask"
      DTS:FailPackageOnFailure="True"
      DTS:FailParentOnFailure="True"
      DTS:LocaleID="-1"
      DTS:MaxErrorCount="0"
      DTS:ObjectName="13_2_4_tripagg"
      DTS:TaskContact="Microsoft Corporation; Microsoft SQL Server; Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <ExecutePackageTask>
          <UseProjectReference>True</UseProjectReference>
          <PackageName>13_2_4_tripagg.dtsx</PackageName>
          <ParameterAssignment>
            <ParameterName>scenario_id</ParameterName>
            <BindedVariableOrParameterName>User::scenario_id</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_iteration</ParameterName>
            <BindedVariableOrParameterName>User::scenario_iteration</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_path</ParameterName>
            <BindedVariableOrParameterName>User::scenario_path</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_year</ParameterName>
            <BindedVariableOrParameterName>User::scenario_year</BindedVariableOrParameterName>
          </ParameterAssignment>
        </ExecutePackageTask>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\13_2_4_tripmicro"
      DTS:CreationName="Microsoft.ExecutePackageTask"
      DTS:DelayValidation="True"
      DTS:Description="Execute Package Task"
      DTS:DTSID="{DD4E2D63-4989-4C57-9301-3C374441A62D}"
      DTS:ExecutableType="Microsoft.ExecutePackageTask"
      DTS:FailPackageOnFailure="True"
      DTS:FailParentOnFailure="True"
      DTS:LocaleID="-1"
      DTS:MaxErrorCount="0"
      DTS:ObjectName="13_2_4_tripmicro"
      DTS:TaskContact="Microsoft Corporation; Microsoft SQL Server; Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <ExecutePackageTask>
          <UseProjectReference>True</UseProjectReference>
          <PackageName>13_2_4_tripmicro.dtsx</PackageName>
          <ParameterAssignment>
            <ParameterName>scenario_id</ParameterName>
            <BindedVariableOrParameterName>User::scenario_id</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_iteration</ParameterName>
            <BindedVariableOrParameterName>User::scenario_iteration</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_path</ParameterName>
            <BindedVariableOrParameterName>User::scenario_path</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_year</ParameterName>
            <BindedVariableOrParameterName>User::scenario_year</BindedVariableOrParameterName>
          </ParameterAssignment>
        </ExecutePackageTask>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\13_4_0_lu"
      DTS:CreationName="Microsoft.ExecutePackageTask"
      DTS:DelayValidation="True"
      DTS:Description="Execute Package Task"
      DTS:DTSID="{5DD69216-B619-44AF-9BA8-6A97A5A6AFC5}"
      DTS:ExecutableType="Microsoft.ExecutePackageTask"
      DTS:FailPackageOnFailure="True"
      DTS:FailParentOnFailure="True"
      DTS:LocaleID="-1"
      DTS:MaxErrorCount="0"
      DTS:ObjectName="13_4_0_lu"
      DTS:TaskContact="Microsoft Corporation; Microsoft SQL Server; Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <ExecutePackageTask>
          <UseProjectReference>True</UseProjectReference>
          <PackageName>13_4_0_lu.dtsx</PackageName>
          <ParameterAssignment>
            <ParameterName>scenario_id</ParameterName>
            <BindedVariableOrParameterName>User::scenario_id</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_iteration</ParameterName>
            <BindedVariableOrParameterName>User::scenario_iteration</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_path</ParameterName>
            <BindedVariableOrParameterName>User::scenario_path</BindedVariableOrParameterName>
          </ParameterAssignment>
          <ParameterAssignment>
            <ParameterName>scenario_year</ParameterName>
            <BindedVariableOrParameterName>User::scenario_year</BindedVariableOrParameterName>
          </ParameterAssignment>
        </ExecutePackageTask>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\alter_partition"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:DelayValidation="True"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{A8984DFA-5927-4EBA-9F30-A510090EBD28}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:FailPackageOnFailure="True"
      DTS:FailParentOnFailure="True"
      DTS:LocaleID="-1"
      DTS:MaxErrorCount="0"
      DTS:ObjectName="alter_partition"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{63EC16A6-50B6-4C84-BB16-3FF88DD74D01}"
          SQLTask:SqlStatementSource="DECLARE @scenario_id smallint = ?&#xA;DECLARE @db_name nvarchar(50) = ?&#xA;DECLARE @db_file_path nvarchar(200) = ?&#xA;&#xA;DECLARE @next_scenario_id smallint = @scenario_id + 1&#xA;DECLARE @SQL nvarchar(max)&#xA;&#xA;&#xA;-- Step 1. Add filegroup for next scenario if it does not already exist&#xA;-- All scenarios have filegroup size at 45GB&#xA;IF NOT EXISTS (SELECT name FROM sys.filegroups WHERE name = 'scenario_fg_' + CAST(@next_scenario_id AS NVARCHAR))&#xA;BEGIN&#xA; SET @SQL = N' ALTER DATABASE ' + @db_name + N'&#xA;   ADD FILEGROUP scenario_fg_' + CAST(@next_scenario_id AS NVARCHAR) + N';'&#xA; EXECUTE sp_executesql @SQL&#xA;END&#xA;&#xA;IF NOT EXISTS (SELECT [name] FROM sys.sysfiles WHERE name = 'scenario_file_' + CAST(@next_scenario_id AS NVARCHAR) + '_1')&#xA;BEGIN  &#xA; SET @SQL = N' ALTER DATABASE ' + @db_name + N'&#xA;   ADD FILE&#xA;   (&#xA;    NAME = scenario_file_' + CAST(@next_scenario_id AS NVARCHAR) + N'_1,&#xA;    FILENAME = ''' + @db_file_path + '\scenario_file_' + CAST(@next_scenario_id AS NVARCHAR) + N'_1.ndf'',&#xA;    SIZE = 15GB,&#xA;    MAXSIZE = 15GB,&#xA;    FILEGROWTH = 0&#xA;   )&#xA;   TO FILEGROUP scenario_fg_' + CAST(@next_scenario_id AS NVARCHAR) + N';'&#xA; EXECUTE sp_executesql @SQL&#xA;END&#xA;&#xA;IF NOT EXISTS (SELECT [name] FROM sys.sysfiles WHERE name = 'scenario_file_' + CAST(@next_scenario_id AS NVARCHAR) + '_2')&#xA;BEGIN &#xA; SET @SQL = N' ALTER DATABASE ' + @db_name + N'&#xA;   ADD FILE&#xA;   (&#xA;    NAME = scenario_file_' + CAST(@next_scenario_id AS NVARCHAR) + N'_2,&#xA;    FILENAME = ''' + @db_file_path + '\scenario_file_' + CAST(@next_scenario_id AS NVARCHAR) + N'_2.ndf'',&#xA;    SIZE = 15GB,&#xA;    MAXSIZE = 15GB,&#xA;    FILEGROWTH = 0&#xA;   )&#xA;   TO FILEGROUP scenario_fg_' + CAST(@next_scenario_id AS NVARCHAR) + N';'&#xA; EXECUTE sp_executesql @SQL&#xA;END&#xA;&#xA;IF NOT EXISTS (SELECT [name] FROM sys.sysfiles WHERE name = 'scenario_file_' + CAST(@next_scenario_id AS NVARCHAR) + '_3')&#xA;BEGIN  &#xA; SET @SQL = N' ALTER DATABASE ' + @db_name + N'&#xA;   ADD FILE&#xA;   (&#xA;    NAME = scenario_file_' + CAST(@next_scenario_id AS NVARCHAR) + N'_3,&#xA;    FILENAME = ''' + @db_file_path + '\scenario_file_' + CAST(@next_scenario_id AS NVARCHAR) + N'_3.ndf'',&#xA;    SIZE = 15GB,&#xA;    MAXSIZE = 15GB,&#xA;    FILEGROWTH = 0&#xA;   )&#xA;   TO FILEGROUP scenario_fg_' + CAST(@next_scenario_id AS NVARCHAR) + N';'&#xA; EXECUTE sp_executesql @SQL &#xA;END&#xA;&#xA;&#xA;-- Need to keep an empty partition at the end&#xA;-- Create partition for next scenario&#xA;IF NOT EXISTS(&#xA; SELECT [value] &#xA; FROM [sys].[partition_functions] func&#xA; INNER JOIN [sys].[partition_range_values] val&#xA; ON func.[function_id] = val.[function_id]&#xA; WHERE [name] = 'scenario_partition'&#xA; AND [value] = @next_scenario_id&#xA; )&#xA;BEGIN&#xA; -- Step 2. Set filegroup as next used&#xA; SET @SQL = N'ALTER PARTITION SCHEME scenario_scheme NEXT USED ' + N'scenario_fg_' + CAST(@next_scenario_id AS NVARCHAR)&#xA; EXECUTE sp_executesql @SQL&#xA;&#xA; -- Step 3. Alter partition function to include the scenario as a boundary point&#xA; ALTER PARTITION FUNCTION scenario_partition ()&#xA; SPLIT RANGE (@next_scenario_id);&#xA;END" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::scenario_id"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="131"
            SQLTask:ParameterSize="16" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="1"
            SQLTask:DtsVariableName="$Project::db_name"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="130"
            SQLTask:ParameterSize="50" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="2"
            SQLTask:DtsVariableName="$Project::db_file_path"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="130"
            SQLTask:ParameterSize="200" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\create_staging_heaps"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:DelayValidation="True"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{F10BC745-621A-4760-8533-A561318AF93A}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:FailPackageOnFailure="True"
      DTS:FailParentOnFailure="True"
      DTS:LocaleID="-1"
      DTS:MaxErrorCount="0"
      DTS:ObjectName="create_staging_heaps"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{63EC16A6-50B6-4C84-BB16-3FF88DD74D01}"
          SQLTask:SqlStatementSource="-- Creates staging heaps on the same filegroup as the scenario partition&#xA;DECLARE @SQL nvarchar(max)&#xA;DECLARE @scenario_id nvarchar(10)&#xA;SET @scenario_id = CAST(? AS nvarchar(10))&#xA;&#xA;&#xA;-- AT_SKIMS&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[at_skims_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [at_skims_id] int IDENTITY(1,1) NOT NULL,&#xA;  [orig_geography_zone_id] int NOT NULL,&#xA;     [dest_geography_zone_id] int NOT NULL,&#xA;     [mode_id] tinyint NOT NULL,&#xA;  [time_period_id] int NOT NULL,&#xA;     [skim_id] tinyint NOT NULL,&#xA;     [value] decimal(8,4) NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;-- BIKE_FLOW&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[bike_flow_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [bike_flow_id] int IDENTITY(1,1) NOT NULL,&#xA;  [bike_link_ab_id] int NOT NULL,&#xA;  [time_period_id] int NOT NULL,&#xA;  [flow] decimal(8,4) NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;-- BIKE_LINK&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[bike_link_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [bike_link_id] int IDENTITY(1,1) NOT NULL,&#xA;  [roadsegid] int NOT NULL,&#xA;  [nm] varchar(50) NOT NULL,&#xA;  [at_func_class_id] smallint NOT NULL,&#xA;  [bike2sep] tinyint NOT NULL,&#xA;  [bike3blvd] tinyint NOT NULL,&#xA;  [speed] smallint NOT NULL,&#xA;  [scenicldx] decimal(11,9) NOT NULL,&#xA;  [shape] geography NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;-- BIKE_LINK_AB&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[bike_link_ab_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [bike_link_ab_id] int IDENTITY(1,1) NOT NULL,&#xA;  [bike_link_id] int NOT NULL,&#xA;  [ab] tinyint NOT NULL,&#xA;  [from_node] int NOT NULL,&#xA;  [to_node] int NOT NULL,&#xA;  [gain] smallint NOT NULL,&#xA;  [bike_class_id] tinyint NOT NULL,&#xA;  [lanes] tinyint NOT NULL,&#xA;  [signal] tinyint NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;-- CBDVEHICLES&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[cbd_vehicles_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [cbd_vehicles_id] int IDENTITY(1,1) NOT NULL,&#xA;  [geography_zone_id] int NOT NULL,&#xA;  [time_period_id] int NOT NULL,&#xA;  [vehicles] decimal(10,6) NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;-- HWY_FLOW&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[hwy_flow_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [hwy_flow_id] int IDENTITY(1,1) NOT NULL,&#xA;  [hwy_link_ab_tod_id] int NOT NULL,&#xA;  [flow_pce] decimal(12,6) NOT NULL,&#xA;  [time] decimal(10,6) NOT NULL,&#xA;  [voc] decimal(8,6) NOT NULL,&#xA;  [v_dist_t] decimal(12,6) NOT NULL,&#xA;  [vht] decimal(11,6) NOT NULL,&#xA;  [speed] decimal(9,6) NOT NULL,&#xA;  [vdf] decimal(10,6) NOT NULL,&#xA;  [msa_flow] decimal(12,6) NOT NULL,&#xA;  [msa_time] decimal(10,6) NOT NULL,&#xA;  [flow] decimal(12,6) NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;  &#xA;-- HWY_FLOW_MODE&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[hwy_flow_mode_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [hwy_flow_mode_id] int IDENTITY(1,1) NOT NULL,&#xA;  [hwy_flow_id] int NOT NULL,&#xA;  [mode_id] tinyint NOT NULL,&#xA;  [flow] decimal(12,6) NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;-- HWY_LINK&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[hwy_link_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [hwy_link_id] int IDENTITY(1,1) NOT NULL,&#xA;  [hwycov_id] int NOT NULL,&#xA;  [length_mile] decimal(20,16) NOT NULL,&#xA;  [sphere] smallint NOT NULL,&#xA;  [nm] varchar(50) NOT NULL,&#xA;  [cojur] tinyint NOT NULL,&#xA;  [costat] smallint NOT NULL,&#xA;  [coloc] tinyint NOT NULL,&#xA;  [rloop] smallint NOT NULL,&#xA;  [adtlk] smallint NOT NULL,&#xA;  [adtvl] smallint NOT NULL,&#xA;  [aspd] tinyint NOT NULL,&#xA;  [iyr] smallint NOT NULL,&#xA;  [iproj] smallint NOT NULL,&#xA;  [ijur] tinyint NOT NULL,&#xA;  [ifc] tinyint NOT NULL,&#xA;  [ihov] tinyint NOT NULL,&#xA;  [itruck] tinyint NOT NULL,&#xA;  [ispd] tinyint NOT NULL,&#xA;  [iway] tinyint NOT NULL,&#xA;  [imed] tinyint NOT NULL,&#xA;  [shape] geography NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- HWY_LINK_AB&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[hwy_link_ab_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [hwy_link_ab_id] int IDENTITY(1,1) NOT NULL,&#xA;  [hwy_link_id] int NOT NULL,&#xA;  [ab] tinyint NOT NULL,&#xA;  [from_node] int NOT NULL,&#xA;  [to_node] int NOT NULL,&#xA;  [from_nm] varchar(50) NOT NULL,&#xA;  [to_nm] varchar(50) NOT NULL,&#xA;  [au] tinyint NOT NULL,&#xA;  [pct] tinyint NOT NULL,&#xA;  [cnt] tinyint NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- HWY_LINK_AB_TOD&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[hwy_link_ab_tod_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [hwy_link_ab_tod_id] int IDENTITY(1,1) NOT NULL,&#xA;  [hwy_link_ab_id] int NOT NULL,&#xA;  [hwy_link_tod_id] int NOT NULL,&#xA;  [cp] decimal(12,6) NOT NULL,&#xA;  [cx] decimal(12,6) NOT NULL,&#xA;  [tm] decimal(12,6) NOT NULL,&#xA;  [tx] decimal(12,6) NOT NULL,&#xA;  [ln] decimal(12,6) NOT NULL,&#xA;  [stm] decimal(12,6) NOT NULL,&#xA;  [htm] decimal(12,6) NOT NULL,&#xA;  [preload] decimal(12,6) NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- HWY_LINK_TOD&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[hwy_link_tod_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [hwy_link_tod_id] int IDENTITY(1,1) NOT NULL,&#xA;  [hwy_link_id] int NOT NULL,&#xA;  [time_period_id] int NOT NULL,&#xA;  [itoll2] decimal(12,6) NOT NULL,&#xA;  [itoll3] decimal(12,6) NOT NULL,&#xA;  [itoll4] decimal(12,6) NOT NULL,&#xA;  [itoll5] decimal(12,6) NOT NULL,&#xA;  [itoll] decimal(12,6) NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;-- HWY_SKIMS&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[hwy_skims_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [hwy_skims_id] int IDENTITY(1,1) NOT NULL,&#xA;  [orig_geography_zone_id] int NOT NULL,&#xA;  [dest_geography_zone_id] int NOT NULL,&#xA;  [time_period_id] int NOT NULL,&#xA;     [dist_drive_alone_toll] decimal(12,6) NOT NULL,&#xA;     [time_drive_alone_toll] decimal(12,6) NOT NULL,&#xA;     [cost_drive_alone_toll] decimal(4,2) NOT NULL,&#xA;     [dist_drive_alone_free] decimal(12,6) NOT NULL,&#xA;     [time_drive_alone_free] decimal(12,6) NOT NULL,&#xA;     [dist_hov2_toll] decimal(12,6) NOT NULL,&#xA;     [time_hov2_toll] decimal(12,6) NOT NULL,&#xA;     [cost_hov2_toll] decimal(4,2) NOT NULL,&#xA;     [dist_hov2_free] decimal(12,6) NOT NULL,&#xA;     [time_hov2_free] decimal(12,6) NOT NULL,&#xA;     [dist_hov3_toll] decimal(12,6) NOT NULL,&#xA;     [time_hov3_toll] decimal(12,6) NOT NULL,&#xA;     [cost_hov3_toll] decimal(4,2) NOT NULL,&#xA;     [dist_hov3_free] decimal(12,6) NOT NULL,&#xA;     [time_hov3_free] decimal(12,6) NOT NULL,&#xA;     [dist_truck_toll] decimal(12,6) NOT NULL,&#xA;     [time_truck_toll] decimal(12,6) NOT NULL,&#xA;     [cost_truck_toll] decimal(4,2) NOT NULL,&#xA;     [dist_truck_free] decimal(12,6) NOT NULL,&#xA;     [time_truck_free] decimal(12,6) NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;-- LU_HH&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[lu_hh_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [lu_hh_id] int IDENTITY(1,1) NOT NULL,&#xA;  [hh_id] int NOT NULL,&#xA;  [hh_serial_no] bigint NOT NULL,&#xA;  [geography_zone_id] int NOT NULL,&#xA;  [hh_income_cat_id] tinyint NOT NULL,&#xA;  [hh_income] int NOT NULL,&#xA;  [workers] tinyint NOT NULL,&#xA;  [persons] tinyint NOT NULL,&#xA;  [unit_type_id] tinyint NOT NULL,&#xA;  [autos] tinyint NOT NULL,&#xA;  [transponder] tinyint NULL,&#xA;  [poverty] decimal(6,3) NULL,&#xA;  [version] smallint NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- LU_MGRA_INPUT&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[lu_mgra_input_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [lu_mgra_input_id] int IDENTITY(1,1)  NOT NULL,&#xA;  [geography_zone_id] int NOT NULL,&#xA;  [hs] smallint NOT NULL,&#xA;  [hs_sf] smallint NOT NULL,&#xA;  [hs_mf] smallint NOT NULL,&#xA;  [hs_mh] smallint NOT NULL,&#xA;  [hh] smallint NOT NULL,&#xA;  [hh_sf] smallint NOT NULL,&#xA;  [hh_mf] smallint NOT NULL,&#xA;  [hh_mh] smallint NOT NULL,&#xA;  [gq_civ] smallint NOT NULL,&#xA;  [gq_mil] smallint NOT NULL,&#xA;  [i1] smallint NOT NULL,&#xA;  [i2] smallint NOT NULL,&#xA;  [i3] smallint NOT NULL,&#xA;  [i4] smallint NOT NULL,&#xA;  [i5] smallint NOT NULL,&#xA;  [i6] smallint NOT NULL,&#xA;  [i7] smallint NOT NULL,&#xA;  [i8] smallint NOT NULL,&#xA;  [i9] smallint NOT NULL,&#xA;  [i10] smallint NOT NULL,&#xA;  [hhs] decimal(9,7) NOT NULL,&#xA;  [pop] smallint NOT NULL,&#xA;  [hhp] smallint NOT NULL,&#xA;  [emp_ag] decimal(12,7) NOT NULL,&#xA;  [emp_const_non_bldg_prod] decimal(12,7) NOT NULL,&#xA;  [emp_const_non_bldg_office] decimal(12,7) NOT NULL,&#xA;  [emp_utilities_prod] decimal(12,7) NOT NULL,&#xA;  [emp_utilities_office] decimal(12,7) NOT NULL,&#xA;  [emp_const_bldg_prod] decimal(12,7) NOT NULL,&#xA;  [emp_const_bldg_office] decimal(12,7) NOT NULL,&#xA;  [emp_mfg_prod] decimal(12,7) NOT NULL,&#xA;  [emp_mfg_office] decimal(12,7) NOT NULL,&#xA;  [emp_whsle_whs] decimal(12,7) NOT NULL,&#xA;  [emp_trans] decimal(12,7) NOT NULL,&#xA;  [emp_retail] decimal(12,7) NOT NULL,&#xA;  [emp_prof_bus_svcs] decimal(12,7) NOT NULL,&#xA;  [emp_prof_bus_svcs_bldg_maint] decimal(12,7) NOT NULL,&#xA;  [emp_pvt_ed_k12] decimal(12,7) NOT NULL,&#xA;  [emp_pvt_ed_post_k12_oth] decimal(12,7) NOT NULL,&#xA;  [emp_health] decimal(12,7) NOT NULL,&#xA;  [emp_personal_svcs_office] decimal(12,7) NOT NULL,&#xA;  [emp_amusement] decimal(12,7) NOT NULL,&#xA;  [emp_hotel] decimal(12,7) NOT NULL,&#xA;  [emp_restaurant_bar] decimal(12,7) NOT NULL,&#xA;  [emp_personal_svcs_retail] decimal(12,7) NOT NULL,&#xA;  [emp_religious] decimal(12,7) NOT NULL,&#xA;  [emp_pvt_hh] decimal(12,7) NOT NULL,&#xA;  [emp_state_local_gov_ent] decimal(12,7) NOT NULL,&#xA;  [emp_fed_non_mil] decimal(12,7) NOT NULL,&#xA;  [emp_fed_mil] decimal(12,7) NOT NULL,&#xA;  [emp_state_local_gov_blue] decimal(12,7) NOT NULL,&#xA;  [emp_state_local_gov_white] decimal(12,7) NOT NULL,&#xA;  [emp_public_ed] decimal(12,7) NOT NULL,&#xA;  [emp_own_occ_dwell_mgmt] decimal(12,7) NOT NULL,&#xA;  [emp_fed_gov_accts] decimal(12,7) NOT NULL,&#xA;  [emp_st_lcl_gov_accts] decimal(12,7) NOT NULL,&#xA;  [emp_cap_accts] decimal(12,7) NOT NULL,&#xA;  [emp_total] decimal(12,7) NOT NULL,&#xA;  [enrollgradekto8] decimal(12,7) NOT NULL,&#xA;  [enrollgrade9to12] decimal(12,7) NOT NULL,&#xA;  [collegeenroll] decimal(12,7) NOT NULL,&#xA;  [othercollegeenroll] decimal(12,7) NOT NULL,&#xA;  [adultschenrl] decimal(12,7) NOT NULL,&#xA;  [ech_dist] int NOT NULL,&#xA;  [hch_dist] int NOT NULL,&#xA;  [pseudomsa] tinyint NOT NULL,&#xA;  [parkarea] tinyint NOT NULL,&#xA;  [hstallsoth] smallint NOT NULL,&#xA;  [hstallssam] smallint NOT NULL,&#xA;  [hparkcost] decimal(10,8) NOT NULL,&#xA;  [numfreehrs] tinyint NOT NULL,&#xA;  [dstallsoth] smallint NOT NULL,&#xA;  [dstallssam] smallint NOT NULL,&#xA;  [dparkcost] decimal(10,8) NOT NULL,&#xA;  [mstallsoth] smallint NOT NULL,&#xA;  [mstallssam] smallint NOT NULL,&#xA;  [mparkcost] decimal(10,8) NOT NULL,&#xA;  [totint] smallint NOT NULL,&#xA;  [duden] decimal(13,8) NOT NULL,&#xA;  [empden] decimal(13,8) NOT NULL,&#xA;  [popden] decimal(13,8) NOT NULL,&#xA;  [retempden] decimal(13,8) NOT NULL,&#xA;  [totintbin] tinyint NOT NULL,&#xA;  [empdenbin] tinyint NOT NULL,&#xA;  [dudenbin] tinyint NOT NULL,&#xA;  [zip09] int NOT NULL,&#xA;  [parkactive] decimal(15,10) NOT NULL,&#xA;  [openspaceparkpreserve] decimal(15,10) NOT NULL,&#xA;  [beachactive] decimal(15,10) NOT NULL,&#xA;  [budgetroom] decimal(9,5) NOT NULL,&#xA;  [economyroom] decimal(9,5) NOT NULL,&#xA;  [luxuryroom] decimal(9,5) NOT NULL,&#xA;  [midpriceroom] decimal(9,5) NOT NULL,&#xA;  [upscaleroom] decimal(9,5) NOT NULL,&#xA;  [hotelroomtotal] decimal(9,5) NOT NULL,&#xA;  [luz_id] smallint NOT NULL,&#xA;  [truckregiontype] tinyint NOT NULL,&#xA;  [district27] tinyint NOT NULL,&#xA;  [milestocoast] decimal(12,9) NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- LU_PERSON&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[lu_person_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [lu_person_id] int IDENTITY(1,1) NOT NULL,&#xA;  [lu_hh_id] int NOT NULL,&#xA;  [pnum] tinyint NOT NULL,&#xA;  [age] tinyint NOT NULL,&#xA;  [sex_id] tinyint NOT NULL,&#xA;  [military_id] tinyint NOT NULL,&#xA;  [pemploy_id] tinyint NOT NULL,&#xA;  [pstudent_id] tinyint NOT NULL,&#xA;  [ptype_id] tinyint NOT NULL,&#xA;  [educ_id] tinyint NOT NULL,&#xA;  [grade_id] tinyint NOT NULL,&#xA;  [occen5] smallint NOT NULL,&#xA;  [occsoc5] varchar(15) NOT NULL,&#xA;  [indcen] smallint NOT NULL,&#xA;  [weeks_worked_id] tinyint NOT NULL,&#xA;  [hours_worked] tinyint NOT NULL,&#xA;  [race_id] tinyint NOT NULL,&#xA;  [hisp_id] tinyint NOT NULL,&#xA;  [activity_pattern_id] tinyint NOT NULL,&#xA;  [ie_choice] tinyint NOT NULL,&#xA;  [version] smallint NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- LU_PERSON_FP&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[lu_person_fp_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [lu_person_fp_id] int IDENTITY(1,1) NOT NULL,&#xA;  [lu_person_id] int NOT NULL,&#xA;  [fp_choice_id] tinyint NOT NULL,&#xA;  [reimb_pct] decimal(8,6) NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- LU_PERSON_LC&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[lu_person_lc_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [lu_person_lc_id] int IDENTITY(1,1) NOT NULL,&#xA;  [lu_person_id] int NOT NULL,&#xA;  [loc_choice_segment_id] int NOT NULL,&#xA;  [geography_zone_id] int NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;-- TOUR_CB&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[tour_cb_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [tour_cb_id] int IDENTITY(1,1) NOT NULL,&#xA;  [model_type_id] tinyint NOT NULL,&#xA;  [tour_id] int NOT NULL,&#xA;  [purpose_id] int NOT NULL,&#xA;  [orig_geography_zone_id] int NOT NULL,&#xA;  [dest_geography_zone_id] int NOT NULL,&#xA;  [start_time_period_id] int NOT NULL,&#xA;  [end_time_period_id] int NOT NULL,&#xA;  [crossing_mode_id] tinyint NOT NULL,&#xA;  [sentri] tinyint NOT NULL,&#xA;  [poe_id] tinyint NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TOUR_IE&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[tour_ie_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [tour_ie_id] int IDENTITY(1,1) NOT NULL,&#xA;  [model_type_id] tinyint NOT NULL,&#xA;  [orig_geography_zone_id] int NOT NULL,&#xA;  [dest_geography_zone_id] int NOT NULL,&#xA;  [start_time_period_id] int NOT NULL,&#xA;  [end_time_period_id] int NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TOUR_IE_PERSON&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[tour_ie_person_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [tour_ie_person_id] int IDENTITY(1,1) NOT NULL,&#xA;  [tour_ie_id] int NOT NULL,&#xA;  [lu_person_id] int NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TOUR_IJ&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[tour_ij_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [tour_ij_id] int IDENTITY(1,1) NOT NULL,&#xA;  [model_type_id] tinyint NOT NULL,&#xA;  [tour_id] int NOT NULL,&#xA;  [tour_cat_id] tinyint NOT NULL,&#xA;  [purpose_id] int NOT NULL,&#xA;  [orig_geography_zone_id] int NOT NULL,&#xA;  [dest_geography_zone_id] int NOT NULL,&#xA;  [start_time_period_id] int NOT NULL,&#xA;  [end_time_period_id] int NOT NULL,&#xA;  [mode_id] tinyint NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TOUR_IJ_PERSON&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[tour_ij_person_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [tour_ij_person_id] int IDENTITY(1,1) NOT NULL,&#xA;  [tour_ij_id] int NOT NULL,&#xA;  [lu_person_id] int NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TOUR_VIS&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[tour_vis_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [tour_vis_id] int IDENTITY(1,1) NOT NULL,&#xA;  [model_type_id] tinyint NOT NULL,&#xA;  [tour_id] int NOT NULL,&#xA;  [tour_cat_id] tinyint NOT NULL,&#xA;  [purpose_id] int NOT NULL,&#xA;  [orig_geography_zone_id] int NOT NULL,&#xA;  [dest_geography_zone_id] int NOT NULL,&#xA;  [start_time_period_id] int NOT NULL,&#xA;  [end_time_period_id] int NOT NULL,&#xA;  [mode_id] tinyint NOT NULL,&#xA;  [auto_available] tinyint NOT NULL,&#xA;  [hh_income_cat_id] tinyint NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TRANSIT_AGGFLOW&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[transit_aggflow_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [transit_aggflow_id] int IDENTITY(1,1) NOT NULL,&#xA;  [transit_link_id] int NOT NULL,&#xA;  [ab] tinyint NOT NULL,&#xA;  [time_period_id] int NOT NULL,&#xA;  [transit_mode_id] tinyint NOT NULL,&#xA;  [transit_access_mode_id] tinyint NOT NULL,&#xA;  [transit_flow] smallint NOT NULL,  &#xA;  [non_transit_flow] smallint NOT NULL, &#xA;  [total_flow] smallint NOT NULL, &#xA;  [access_walk_flow] smallint NOT NULL, &#xA;  [xfer_walk_flow] smallint NOT NULL, &#xA;  [egress_walk_flow] smallint NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TRANSIT_FLOW&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[transit_flow_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [transit_flow_id] int IDENTITY(1,1) NOT NULL,&#xA;  [transit_route_id] int NOT NULL,&#xA;  [from_transit_stop_id] int NOT NULL,&#xA;  [to_transit_stop_id] int NOT NULL,&#xA;  [time_period_id] int NOT NULL,&#xA;  [transit_mode_id] tinyint NOT NULL,&#xA;  [transit_access_mode_id] tinyint NOT NULL,&#xA;  [from_mp] decimal(9,6) NOT NULL,&#xA;  [to_mp] decimal(9,6) NOT NULL,&#xA;  [baseivtt] decimal(9,6) NOT NULL,&#xA;  [cost] decimal(9,6) NOT NULL,&#xA;  [transit_flow] smallint NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TRANSIT_LINK&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[transit_link_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [transit_link_id] int IDENTITY(1,1) NOT NULL,&#xA;  [trcov_id] int NOT NULL,&#xA;  [shape] geography NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TRANSIT_ONOFF&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[transit_onoff_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [transit_onoff_id] int IDENTITY(1,1) NOT NULL,&#xA;  [transit_route_id] int NOT NULL,&#xA;  [transit_stop_id] int NOT NULL,&#xA;  [time_period_id] int NOT NULL,&#xA;  [transit_mode_id] tinyint NOT NULL,&#xA;  [transit_access_mode_id] tinyint NOT NULL,&#xA;  [boardings] decimal(11,6) NOT NULL,&#xA;  [alightings] decimal(11,6) NOT NULL,&#xA;  [walk_access_on] decimal(11,6) NOT NULL,&#xA;  [direct_transfer_on] decimal(11,6) NOT NULL,&#xA;  [walk_transfer_on] decimal(11,6) NOT NULL,&#xA;  [direct_transfer_off] decimal(11,6) NOT NULL,&#xA;  [walk_transfer_off] decimal(11,6) NOT NULL,&#xA;  [egress_off] decimal(11,6) NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TRANSIT_PNR&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[transit_pnr_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [transit_pnr_id] int IDENTITY(1,1) NOT NULL,&#xA;  [transit_tap_id] int NOT NULL,&#xA;  [lot_id] smallint NOT NULL,&#xA;  [geography_zone_id] int NULL,&#xA;  [time_period_id] int NOT NULL,&#xA;  [parking_type_id] tinyint NOT NULL,&#xA;  [capacity] smallint NOT NULL,&#xA;  [distance] smallint NOT NULL,&#xA;  [vehicles] smallint NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TRANSIT_ROUTE&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[transit_route_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [transit_route_id] int IDENTITY(1,1) NOT NULL,&#xA;  [route_id] smallint NOT NULL,&#xA;  [transit_mode_id] tinyint NOT NULL,&#xA;  [am_headway] decimal(5,2) NOT NULL,&#xA;  [pm_headway] decimal(5,2) NOT NULL,&#xA;  [op_headway] decimal(5,2) NOT NULL,&#xA;  [nt_headway] decimal(5,2) NOT NULL,&#xA;  [nt_hour] tinyint NOT NULL,&#xA;  [config] int NOT NULL,&#xA;  [fare] decimal(4,2) NOT NULL,&#xA;  [shape] geography NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TRANSIT_STOP&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[transit_stop_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [transit_stop_id] int IDENTITY(1,1) NOT NULL,&#xA;  [transit_route_id] int NOT NULL,&#xA;  [transit_link_id] int NOT NULL,&#xA;  [stop_id] smallint NOT NULL,&#xA;  [mp] decimal(9,6) NOT NULL,&#xA;  [near_node] int NOT NULL,&#xA;  [fare_zone] smallint NOT NULL,&#xA;  [stop_name] VARCHAR(50) NOT NULL,&#xA;  [shape] geography NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TRANSIT_TAP&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[transit_tap_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [transit_tap_id] int IDENTITY(1,1) NOT NULL,&#xA;  [tap] smallint NOT NULL,&#xA;  [shape] geography NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TRANSIT_TAP_SKIMS&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[transit_tap_skims_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [transit_tap_skims_id] int IDENTITY(1,1),&#xA;  [orig_transit_tap_id] int NOT NULL,&#xA;  [dest_transit_tap_id] int NOT NULL,&#xA;  [time_period_id] int NOT NULL,&#xA;  [init_wait_premium] decimal(6,3) NOT NULL,&#xA;  [ivt_premium] decimal(6,3) NOT NULL,&#xA;  [walk_time_premium] decimal(6,3) NOT NULL,&#xA;  [transfer_time_premium] decimal(6,3) NOT NULL,&#xA;  [fare_premium] decimal(4,2) NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TRANSIT_TAP_WALK&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[transit_tap_walk_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [transit_tap_walk_id] int IDENTITY(1,1) NOT NULL,&#xA;  [geography_zone_id] int NOT NULL,&#xA;  [transit_tap_id] int NOT NULL,&#xA;  [time_boarding_perceived] decimal(6,3) NOT NULL,&#xA;  [time_boarding_actual] decimal(6,3) NOT NULL,&#xA;  [time_alighting_perceived] decimal(6,3) NOT NULL,&#xA;  [time_alighting_actual] decimal(6,3) NOT NULL,&#xA;  [gain_boarding] decimal(8,4) NOT NULL,&#xA;  [gain_alighting] decimal(8,4) NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TRIP_AP&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[trip_ap_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [trip_ap_id] int IDENTITY(1,1) NOT NULL,&#xA;  [model_type_id] tinyint NOT NULL,&#xA;  [trip_id] int NOT NULL,&#xA;  [orig_geography_zone_id] int NULL,&#xA;  [dest_geography_zone_id] int NULL,&#xA;  [time_period_id] int NOT NULL,&#xA;  [mode_id] tinyint NOT NULL,&#xA;  [purpose_id] int NOT NULL,&#xA;  [inbound] bit NOT NULL,&#xA;  [party_size] tinyint NOT NULL,&#xA;  [board_transit_tap_id] int NULL,&#xA;  [alight_transit_tap_id] int NULL,&#xA;  [trip_time] decimal(11,6) NULL,&#xA;  [out_vehicle_time] decimal(11,6) NULL,&#xA;  [trip_distance] decimal(14,10) NULL,&#xA;  [trip_cost] decimal(4,2) NULL,&#xA;  [ap_income_cat_id] tinyint NOT NULL,&#xA;  [nights] tinyint NOT NULL,&#xA;  [ap_arrival_mode_id] tinyint NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TRIP_AGG&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[trip_agg_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [trip_agg_id] int IDENTITY(1,1) NOT NULL,&#xA;  [model_type_id] tinyint NOT NULL,&#xA;  [orig_geography_zone_id] int NOT NULL,&#xA;  [dest_geography_zone_id] int NOT NULL,&#xA;  [time_period_id] int NOT NULL,&#xA;  [purpose_id] int NOT NULL,&#xA;  [mode_id] tinyint NOT NULL,&#xA;  [trips] decimal(20,16) NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TRIP_CB&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[trip_cb_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [trip_cb_id] int IDENTITY(1,1) NOT NULL,&#xA;  [tour_cb_id] int NOT NULL,&#xA;  [trip_id] int NOT NULL,&#xA;  [orig_geography_zone_id] int NOT NULL,&#xA;  [dest_geography_zone_id] int NOT NULL,&#xA;  [time_period_id] int NOT NULL,&#xA;  [mode_id] tinyint NOT NULL,&#xA;  [purpose_id] int NOT NULL,&#xA;  [inbound] bit NOT NULL,&#xA;  [party_size] tinyint NOT NULL,&#xA;  [board_transit_tap_id] int NULL,&#xA;  [alight_transit_tap_id] int NULL,&#xA;  [trip_time] decimal(11,6) NOT NULL,&#xA;  [out_vehicle_time] decimal(11,6) NOT NULL,&#xA;  [trip_distance] decimal(14,10) NOT NULL,&#xA;  [trip_cost] decimal(4,2) NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TRIP_IE&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[trip_ie_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [trip_ie_id] int IDENTITY(1,1) NOT NULL,&#xA;  [tour_ie_id] int NULL,&#xA;  [orig_geography_zone_id] int NOT NULL,&#xA;  [dest_geography_zone_id] int NOT NULL,&#xA;  [time_period_id] int NOT NULL,&#xA;  [mode_id] tinyint NOT NULL,&#xA;  [purpose_id] int NOT NULL,&#xA;  [inbound] bit NOT NULL,&#xA;  [party_size] tinyint NOT NULL,&#xA;  [board_transit_tap_id] int NULL,&#xA;  [alight_transit_tap_id] int NULL,&#xA;  [trip_time] decimal(11,6) NOT NULL,&#xA;  [out_vehicle_time] decimal(11,6) NOT NULL,&#xA;  [trip_distance] decimal(14,10) NOT NULL,&#xA;  [trip_cost] decimal(4,2) NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TRIP_IJ&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[trip_ij_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [trip_ij_id] int IDENTITY(1,1) NOT NULL,&#xA;  [tour_ij_id] int NOT NULL,&#xA;  [trip_id] int NOT NULL,&#xA;  [orig_geography_zone_id] int NOT NULL,&#xA;  [dest_geography_zone_id] int NOT NULL,&#xA;  [time_period_id] int NOT NULL,&#xA;  [mode_id] tinyint NOT NULL,&#xA;  [purpose_id] int NOT NULL,&#xA;  [inbound] bit NOT NULL,&#xA;  [party_size] tinyint NOT NULL,&#xA;  [board_transit_tap_id] int NULL,&#xA;  [alight_transit_tap_id] int NULL,&#xA;  [trip_time] decimal(11,6) NOT NULL,&#xA;  [out_vehicle_time] decimal(11,6) NOT NULL,&#xA;  [trip_distance] decimal(14,10) NOT NULL,&#xA;  [trip_cost] decimal(4,2) NOT NULL,&#xA;  [parking_geography_zone_id] int NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL&#xA;&#xA;&#xA;&#xA;-- TRIP_VIS&#xA;SET @SQL =&#xA;N'CREATE TABLE &#xA; [abm_staging].[trip_vis_' + @scenario_id + N'] (&#xA;  [scenario_id] smallint NOT NULL,&#xA;  [trip_vis_id] int IDENTITY(1,1) NOT NULL,&#xA;  [tour_vis_id] int NOT NULL,&#xA;  [trip_id] int NOT NULL,&#xA;  [orig_geography_zone_id] int NOT NULL,&#xA;  [dest_geography_zone_id] int NOT NULL,&#xA;  [time_period_id] int NOT NULL,&#xA;  [mode_id] tinyint NOT NULL,&#xA;  [purpose_id] int NOT NULL,&#xA;  [inbound] bit NOT NULL,&#xA;  [party_size] tinyint NOT NULL,&#xA;  [board_transit_tap_id] int NULL,&#xA;  [alight_transit_tap_id] int NULL,&#xA;  [trip_time] decimal(11,6) NOT NULL,&#xA;  [out_vehicle_time] decimal(11,6) NOT NULL,&#xA;  [trip_distance] decimal(14,10) NOT NULL,&#xA;  [trip_cost] decimal(4,2) NOT NULL&#xA;) ON [scenario_fg_' + @scenario_id + N']&#xA;WITH (DATA_COMPRESSION = PAGE);'&#xA;EXECUTE sp_executesql @SQL" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::scenario_id"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="131"
            SQLTask:ParameterSize="16" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\set_scenario_id"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:DelayValidation="True"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{42012675-974C-4640-92F0-396B3E8932CC}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:FailPackageOnFailure="True"
      DTS:FailParentOnFailure="True"
      DTS:LocaleID="-1"
      DTS:MaxErrorCount="0"
      DTS:ObjectName="set_scenario_id"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{63EC16A6-50B6-4C84-BB16-3FF88DD74D01}"
          SQLTask:SqlStatementSource="SET NOCOUNT ON;&#xA;&#xA;-- Set scenario_id for the scenario to be loaded&#xA;DECLARE @scenario_id smallint = (SELECT ISNULL(MAX([scenario_id]), 0) + 1 FROM [ref].[scenario])&#xA;&#xA;&#xA;-- Grab the first scenario to be loaded and assign it that scenario_id&#xA;UPDATE&#xA; [data_load].[scenario_load_request]&#xA;SET&#xA; [scenario_id] = @scenario_id&#xA; ,[loading] = 1&#xA;WHERE&#xA; [scenario_load_request_id] IN&#xA;  (&#xA;   SELECT TOP 1&#xA;    [scenario_load_request_id]&#xA;   FROM&#xA;    [data_load].[scenario_load_request]&#xA;   WHERE&#xA;    [loading] = 0&#xA;    AND [scenario_id] IS NULL&#xA;    AND CHARINDEX('13_4_0', [abm_version]) &gt; 0&#xA;  )&#xA;&#xA;&#xA;-- Update the scenario table with the scenario to be loaded&#xA;INSERT INTO&#xA; [ref].[scenario]&#xA;(&#xA; [scenario_id]&#xA; ,[scenario_year]&#xA; ,[scenario_desc]&#xA; ,[path]&#xA; ,[iteration]&#xA; ,[sample_rate]&#xA; ,[user_name]&#xA; ,[date_loaded]&#xA; ,[complete]&#xA; ,[abm_version]&#xA;)&#xA;SELECT&#xA; [scenario_id]&#xA; ,[scenario_year]&#xA; ,[scenario_desc]&#xA; ,[path]&#xA; ,[iteration]&#xA; ,[sample_rate]&#xA; ,[user_name]&#xA; ,NULL&#xA; ,0&#xA; ,[abm_version]&#xA;FROM&#xA; [data_load].[scenario_load_request]&#xA;WHERE&#xA; [scenario_id] = @scenario_id&#xA;&#xA;&#xA;-- Return a result set to pass into ssis package&#xA;SELECT&#xA; [scenario_id]&#xA; ,CAST([scenario_year] AS nvarchar) AS [scenario_year]&#xA; ,[path]&#xA; ,CAST([iteration] AS nvarchar) AS [iteration]&#xA;FROM&#xA; [data_load].[scenario_load_request]&#xA;WHERE&#xA; [scenario_id] = @scenario_id"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="0"
            SQLTask:DtsVariableName="User::scenario_id" />
          <SQLTask:ResultBinding
            SQLTask:ResultName="1"
            SQLTask:DtsVariableName="User::scenario_year" />
          <SQLTask:ResultBinding
            SQLTask:ResultName="2"
            SQLTask:DtsVariableName="User::scenario_path" />
          <SQLTask:ResultBinding
            SQLTask:ResultName="3"
            SQLTask:DtsVariableName="User::scenario_iteration" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{64AAF317-F086-4BB3-BDBC-C2B0EC77A8CF}"
      DTS:From="Package\set_scenario_id"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\alter_partition" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{F59EC9A2-7F44-4C19-A6F5-3D9356CE028E}"
      DTS:From="Package\alter_partition"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\create_staging_heaps" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 10]"
      DTS:CreationName=""
      DTS:DTSID="{1699D88B-7C46-47DE-ACA1-3A2216AD174B}"
      DTS:From="Package\13_2_4_tripagg"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 10"
      DTS:To="Package\13_2_4_complete" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 11]"
      DTS:CreationName=""
      DTS:DTSID="{6E5C9899-849C-4FC6-B50B-8ED7A05FE5C9}"
      DTS:From="Package\create_staging_heaps"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 11"
      DTS:To="Package\13_2_4_tripagg" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{74ACC7E7-CC3E-476E-81CA-8B32700A8F62}"
      DTS:From="Package\create_staging_heaps"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\13_2_4_other" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{4A962DB8-C9EB-4BCC-9DCF-EEF8B5EDBE5C}"
      DTS:From="Package\13_4_0_lu"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\13_2_4_tripmicro" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 4]"
      DTS:CreationName=""
      DTS:DTSID="{E6BF58B0-07BD-412A-8313-61B4E0DF9520}"
      DTS:From="Package\13_2_4_network"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 4"
      DTS:To="Package\13_2_4_tripmicro" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 5]"
      DTS:CreationName=""
      DTS:DTSID="{42FE1D16-71A0-4CDB-B7C5-D2ED16C8FCA7}"
      DTS:From="Package\create_staging_heaps"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 5"
      DTS:To="Package\13_2_4_skims" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 6]"
      DTS:CreationName=""
      DTS:DTSID="{3FB43538-9E2A-4AAC-98D5-59FA29DFB70D}"
      DTS:From="Package\create_staging_heaps"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 6"
      DTS:To="Package\13_2_4_network" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 7]"
      DTS:CreationName=""
      DTS:DTSID="{FCC4BE34-2C9F-4AAA-960A-6E3C00BEE0B3}"
      DTS:From="Package\13_2_4_tripmicro"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 7"
      DTS:To="Package\13_2_4_complete" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 8]"
      DTS:CreationName=""
      DTS:DTSID="{57DD0238-D1C6-4E7A-AB7D-5E319D726E25}"
      DTS:From="Package\13_2_4_other"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 8"
      DTS:To="Package\13_2_4_complete" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 9]"
      DTS:CreationName=""
      DTS:DTSID="{6E2A38B0-431C-430F-9D8A-B0916FCA8F01}"
      DTS:From="Package\create_staging_heaps"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 9"
      DTS:To="Package\13_4_0_lu" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="32" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="163,42"
          Id="Package\13_2_4_complete"
          TopLeft="638.571428571429,632" />
        <NodeLayout
          Size="128,42"
          Id="Package\13_4_0_lu"
          TopLeft="241.428571428571,317.571428571429" />
        <NodeLayout
          Size="158,42"
          Id="Package\13_2_4_network"
          TopLeft="440.714285714286,318.571428571429" />
        <NodeLayout
          Size="145,42"
          Id="Package\13_2_4_other"
          TopLeft="652.142857142857,321.571428571429" />
        <NodeLayout
          Size="146,42"
          Id="Package\13_2_4_skims"
          TopLeft="841.785714285714,321.928571428571" />
        <NodeLayout
          Size="153,42"
          Id="Package\13_2_4_tripagg"
          TopLeft="1024.28571428571,324.142857142857" />
        <NodeLayout
          Size="161,42"
          Id="Package\13_2_4_tripmicro"
          TopLeft="329.785714285714,458.357142857143" />
        <NodeLayout
          Size="145,42"
          Id="Package\alter_partition"
          TopLeft="629.095238095238,123.428571428571" />
        <NodeLayout
          Size="182,42"
          Id="Package\create_staging_heaps"
          TopLeft="617.595238095238,203.928571428571" />
        <NodeLayout
          Size="152,42"
          Id="Package\set_scenario_id"
          TopLeft="626.345238095238,44.821428571429" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="701.970238095238,86.821428571429">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,36.607142857142"
              Start="0,0"
              End="0,29.107142857142">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,29.107142857142" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="705.095238095238,165.428571428571">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,38.5"
              Start="0,0"
              End="0,31">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,31" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 10]"
          TopLeft="1100.78571428571,366.142857142857">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-341.964285714285,265.857142857143"
              Start="0,0"
              End="-341.964285714285,258.357142857143">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,170.385168151768" />
                  <mssgle:CubicBezierSegment
                    Point1="0,170.385168151768"
                    Point2="0,174.385168151768"
                    Point3="-4,174.385168151768" />
                  <mssgle:LineSegment
                    End="-337.964285714285,174.385168151768" />
                  <mssgle:CubicBezierSegment
                    Point1="-337.964285714285,174.385168151768"
                    Point2="-341.964285714285,174.385168151768"
                    Point3="-341.964285714285,178.385168151768" />
                  <mssgle:LineSegment
                    End="-341.964285714285,258.357142857143" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 11]"
          TopLeft="766.595238095238,245.928571428571">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="334.190476190476,78.214285714286"
              Start="0,0"
              End="334.190476190476,70.714285714286">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.8150921658987" />
                  <mssgle:CubicBezierSegment
                    Point1="0,16.8150921658987"
                    Point2="0,20.8150921658987"
                    Point3="4,20.8150921658987" />
                  <mssgle:LineSegment
                    End="330.190476190476,20.8150921658987" />
                  <mssgle:CubicBezierSegment
                    Point1="330.190476190476,20.8150921658987"
                    Point2="334.190476190476,20.8150921658987"
                    Point3="334.190476190476,24.8150921658987" />
                  <mssgle:LineSegment
                    End="334.190476190476,70.714285714286" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="725.319047619048,245.928571428571">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,75.642857142858"
              Start="0,0"
              End="0,68.142857142858">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,68.142857142858" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="305.428571428571,359.571428571429">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="79.357142857143,98.785714285714"
              Start="0,0"
              End="79.357142857143,91.285714285714">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,54.6881918819186" />
                  <mssgle:CubicBezierSegment
                    Point1="0,54.6881918819186"
                    Point2="0,58.6881918819186"
                    Point3="4,58.6881918819186" />
                  <mssgle:LineSegment
                    End="75.357142857143,58.6881918819186" />
                  <mssgle:CubicBezierSegment
                    Point1="75.357142857143,58.6881918819186"
                    Point2="79.357142857143,58.6881918819186"
                    Point3="79.357142857143,62.6881918819186" />
                  <mssgle:LineSegment
                    End="79.357142857143,91.285714285714" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 4]"
          TopLeft="519.714285714286,360.571428571429">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-83.928571428572,97.785714285714"
              Start="0,0"
              End="-83.928571428572,90.285714285714">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,54.0940959409592" />
                  <mssgle:CubicBezierSegment
                    Point1="0,54.0940959409592"
                    Point2="0,58.0940959409592"
                    Point3="-4,58.0940959409592" />
                  <mssgle:LineSegment
                    End="-79.928571428572,58.0940959409592" />
                  <mssgle:CubicBezierSegment
                    Point1="-79.928571428572,58.0940959409592"
                    Point2="-83.928571428572,58.0940959409592"
                    Point3="-83.928571428572,62.0940959409592" />
                  <mssgle:LineSegment
                    End="-83.928571428572,90.285714285714" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 5]"
          TopLeft="737.595238095238,245.928571428571">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="177.190476190476,76"
              Start="0,0"
              End="177.190476190476,68.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.797385620915" />
                  <mssgle:CubicBezierSegment
                    Point1="0,26.797385620915"
                    Point2="0,30.797385620915"
                    Point3="4,30.797385620915" />
                  <mssgle:LineSegment
                    End="173.190476190476,30.797385620915" />
                  <mssgle:CubicBezierSegment
                    Point1="173.190476190476,30.797385620915"
                    Point2="177.190476190476,30.797385620915"
                    Point3="177.190476190476,34.797385620915" />
                  <mssgle:LineSegment
                    End="177.190476190476,68.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 6]"
          TopLeft="691.195238095238,245.928571428571">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-171.480952380952,72.642857142858"
              Start="0,0"
              End="-171.480952380952,65.142857142858">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,28.481860788058" />
                  <mssgle:CubicBezierSegment
                    Point1="0,28.481860788058"
                    Point2="0,32.481860788058"
                    Point3="-4,32.481860788058" />
                  <mssgle:LineSegment
                    End="-167.480952380952,32.481860788058" />
                  <mssgle:CubicBezierSegment
                    Point1="-167.480952380952,32.481860788058"
                    Point2="-171.480952380952,32.481860788058"
                    Point3="-171.480952380952,36.481860788058" />
                  <mssgle:LineSegment
                    End="-171.480952380952,65.142857142858" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 7]"
          TopLeft="410.285714285714,500.357142857143">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="271.035714285715,131.642857142857"
              Start="0,0"
              End="271.035714285715,124.142857142857">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,82.3492382868639" />
                  <mssgle:CubicBezierSegment
                    Point1="0,82.3492382868639"
                    Point2="0,86.3492382868639"
                    Point3="4,86.3492382868639" />
                  <mssgle:LineSegment
                    End="267.035714285715,86.3492382868639" />
                  <mssgle:CubicBezierSegment
                    Point1="267.035714285715,86.3492382868639"
                    Point2="271.035714285715,86.3492382868639"
                    Point3="271.035714285715,90.3492382868639" />
                  <mssgle:LineSegment
                    End="271.035714285715,124.142857142857" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 8]"
          TopLeft="722.357142857143,363.571428571429">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,268.428571428571"
              Start="0,0"
              End="0,260.928571428571">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,260.928571428571" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 9]"
          TopLeft="650.595238095238,245.928571428571">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-345.166666666667,71.642857142858"
              Start="0,0"
              End="-345.166666666667,64.142857142858">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,15.0662442396316" />
                  <mssgle:CubicBezierSegment
                    Point1="0,15.0662442396316"
                    Point2="0,19.0662442396316"
                    Point3="-4,19.0662442396316" />
                  <mssgle:LineSegment
                    End="-341.166666666667,19.0662442396316" />
                  <mssgle:CubicBezierSegment
                    Point1="-341.166666666667,19.0662442396316"
                    Point2="-345.166666666667,19.0662442396316"
                    Point3="-345.166666666667,23.0662442396316" />
                  <mssgle:LineSegment
                    End="-345.166666666667,64.142857142858" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>