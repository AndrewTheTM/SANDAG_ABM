SET NOCOUNT ON;

-- Create emfac schema
IF NOT EXISTS (SELECT schema_name FROM information_schema.schemata WHERE schema_name='emfac')
EXEC ('CREATE SCHEMA [emfac]')
GO




-- Add metadata for [emfac]
IF EXISTS(SELECT * FROM [db_meta].[data_dictionary] WHERE [ObjectType] = 'SCHEMA' AND [FullObjectName] = '[emfac]' AND [PropertyName] = 'MS_Description')
EXECUTE [db_meta].[drop_xp] 'emfac', 'MS_Description'

EXECUTE [db_meta].[add_xp] 'emfac', 'MS_Description', 'schema to hold all objects associated with emfac program'
GO




-- grant read/execute permissions to abm_user role
GRANT EXECUTE ON SCHEMA :: [emfac] TO [abm_user]
GRANT SELECT ON SCHEMA :: [emfac] TO [abm_user]
GRANT VIEW DEFINITION ON SCHEMA :: [emfac] TO [abm_user]




-- Drop table constraints if they exist so tables can be dropped and re-created
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID('[emfac].[fk_emfac_vehicle_map_emfac_vehicle_class]') AND parent_object_id = OBJECT_ID('[emfac].[emfac_vehicle_map]'))
ALTER TABLE [emfac].[emfac_vehicle_map] DROP CONSTRAINT [fk_emfac_vehicle_map_emfac_vehicle_class]
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID('[emfac].[fk_emfac_vehicle_map_sandag_vehicle_class]') AND parent_object_id = OBJECT_ID('[emfac].[emfac_vehicle_map]'))
ALTER TABLE [emfac].[emfac_vehicle_map] DROP CONSTRAINT [fk_emfac_vehicle_map_sandag_vehicle_class]
GO




-- Create emfac vehicle class reference table
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID('[emfac].[emfac_vehicle_class]') AND type in ('U'))
DROP TABLE [emfac].[emfac_vehicle_class]
GO

CREATE TABLE [emfac].[emfac_vehicle_class](
	[emfac_vehicle_class_id] smallint IDENTITY(1,1) NOT NULL,
	[emfac_vehicle_class] varchar(50) NOT NULL,
	[major_version] varchar(5) NOT NULL,
	[minor_version] varchar(5) NOT NULL,
	CONSTRAINT [pk_emfac_vehicle_class] PRIMARY KEY ([emfac_vehicle_class_id])
	) 
ON 
	[reference_fg]
WITH 
	(DATA_COMPRESSION = PAGE);

INSERT INTO [emfac].[emfac_vehicle_class] VALUES
	('LDA - Dsl','2014','1.0'),
	('LDA - Elec','2014','1.0'),
	('LDA - Gas','2014','1.0'),
	('LDT1 - Dsl','2014','1.0'),
	('LDT1 - Elec','2014','1.0'),
	('LDT1 - Gas','2014','1.0'),
	('LDT2 - Dsl','2014','1.0'),
	('LDT2 - Gas','2014','1.0'),
	('LHD1 - Dsl','2014','1.0'),
	('LHD1 - Gas','2014','1.0'),
	('LHD2 - Dsl','2014','1.0'),
	('LHD2 - Gas','2014','1.0'),
	('MCY - Gas','2014','1.0'),
	('MDV - Dsl','2014','1.0'),
	('MDV - Gas','2014','1.0'),
	('MH - Dsl','2014','1.0'),
	('MH - Gas','2014','1.0'),
	('T6 Ag - Dsl','2014','1.0'),
	('T6 CAIRP Heavy - Dsl','2014','1.0'),
	('T6 CAIRP Small - Dsl','2014','1.0'),
	('T6 Instate Construction Heavy - Dsl','2014','1.0'),
	('T6 Instate Construction Small - Dsl','2014','1.0'),
	('T6 Instate Heavy - Dsl','2014','1.0'),
	('T6 Instate Small - Dsl','2014','1.0'),
	('T6 OOS Heavy - Dsl','2014','1.0'),
	('T6 OOS Small - Dsl','2014','1.0'),
	('T6 Public - Dsl','2014','1.0'),
	('T6 Utility - Dsl','2014','1.0'),
	('T6TS - Gas','2014','1.0'),
	('T7 Ag - Dsl','2014','1.0'),
	('T7 CAIRP - Dsl','2014','1.0'),
	('T7 CAIRP Construction - Dsl','2014','1.0'),
	('T7 NNOOS - Dsl','2014','1.0'),
	('T7 NOOS - Dsl','2014','1.0'),
	('T7 Other Port - Dsl','2014','1.0'),
	('T7 POAK - Dsl','2014','1.0'),
	('T7 POLA - Dsl','2014','1.0'),
	('T7 Public - Dsl','2014','1.0'),
	('T7 Single - Dsl','2014','1.0'),
	('T7 Single Construction - Dsl','2014','1.0'),
	('T7 SWCV - Dsl','2014','1.0'),
	('T7 Tractor - Dsl','2014','1.0'),
	('T7 Tractor Construction - Dsl','2014','1.0'),
	('T7 Utility - Dsl','2014','1.0'),
	('T7IS - Gas','2014','1.0'),
	('PTO - Dsl','2014','1.0'),
	('SBUS - Dsl','2014','1.0'),
	('SBUS - Gas','2014','1.0'),
	('UBUS - Dsl','2014','1.0'),
	('UBUS - Gas','2014','1.0'),
	('Motor Coach - Dsl','2014','1.0'),
	('OBUS - Gas','2014','1.0'),
	('All Other Buses - Dsl','2014','1.0'),
	('LDA - Dsl','2017','1.0'),
	('LDA - Elec','2017','1.0'),
	('LDA - Gas','2017','1.0'),
	('LDT1 - Dsl','2017','1.0'),
	('LDT1 - Elec','2017','1.0'),
	('LDT1 - Gas','2017','1.0'),
	('LDT2 - Dsl','2017','1.0'),
	('LDT2 - Elec','2017','1.0'),
	('LDT2 - Gas','2017','1.0'),
	('LHD1 - Dsl','2017','1.0'),
	('LHD1 - Gas','2017','1.0'),
	('LHD2 - Dsl','2017','1.0'),
	('LHD2 - Gas','2017','1.0'),
	('MCY - Gas','2017','1.0'),
	('MDV - Dsl','2017','1.0'),
	('MDV - Elec','2017','1.0'),
	('MDV - Gas','2017','1.0'),
	('MH - Dsl','2017','1.0'),
	('MH - Gas','2017','1.0'),
	('T6 Ag - Dsl','2017','1.0'),
	('T6 CAIRP Heavy - Dsl','2017','1.0'),
	('T6 CAIRP Small - Dsl','2017','1.0'),
	('T6 Instate Construction Heavy - Dsl','2017','1.0'),
	('T6 Instate Construction Small - Dsl','2017','1.0'),
	('T6 Instate Heavy - Dsl','2017','1.0'),
	('T6 Instate Small - Dsl','2017','1.0'),
	('T6 OOS Heavy - Dsl','2017','1.0'),
	('T6 OOS Small - Dsl','2017','1.0'),
	('T6 Public - Dsl','2017','1.0'),
	('T6 Utility - Dsl','2017','1.0'),
	('T6TS - Gas','2017','1.0'),
	('T7 Ag - Dsl','2017','1.0'),
	('T7 CAIRP - Dsl','2017','1.0'),
	('T7 CAIRP Construction - Dsl','2017','1.0'),
	('T7 NNOOS - Dsl','2017','1.0'),
	('T7 NOOS - Dsl','2017','1.0'),
	('T7 Other Port - Dsl','2017','1.0'),
	('T7 POAK - Dsl','2017','1.0'),
	('T7 POLA - Dsl','2017','1.0'),
	('T7 Public - Dsl','2017','1.0'),
	('T7 Single - Dsl','2017','1.0'),
	('T7 Single Construction - Dsl','2017','1.0'),
	('T7 SWCV - Dsl','2017','1.0'),
	('T7 SWCV - NG','2017','1.0'),
	('T7 Tractor - Dsl','2017','1.0'),
	('T7 Tractor Construction - Dsl','2017','1.0'),
	('T7 Utility - Dsl','2017','1.0'),
	('T7IS - Gas','2017','1.0'),
	('PTO - Dsl','2017','1.0'),
	('SBUS - Dsl','2017','1.0'),
	('SBUS - Gas','2017','1.0'),
	('UBUS - Dsl','2017','1.0'),
	('UBUS - Gas','2017','1.0'),
	('UBUS - NG','2017','1.0'),
	('Motor Coach - Dsl','2017','1.0'),
	('OBUS - Gas','2017','1.0'),
	('All Other Buses - Dsl','2017','1.0');
GO

-- Add metadata for [emfac].[emfac_vehicle_class]
EXECUTE [db_meta].[add_xp] 'emfac.emfac_vehicle_class', 'SUBSYSTEM', 'emfac'
EXECUTE [db_meta].[add_xp] 'emfac.emfac_vehicle_class', 'MS_Description', 'emfac vehicle classes used in emfac program by emfac versions'
GO




-- Create sandag vehicle class reference table
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID('[emfac].[sandag_vehicle_class]') AND type in ('U'))
DROP TABLE [emfac].[sandag_vehicle_class]
GO

CREATE TABLE [emfac].[sandag_vehicle_class](
	[sandag_vehicle_class_id] tinyint IDENTITY(1, 1) NOT NULL,
	[sandag_vehicle_class] varchar(50) NOT NULL,
	CONSTRAINT [pk_sandag_vehicle_class] PRIMARY KEY ([sandag_vehicle_class_id])) 
ON 
	[reference_fg]
WITH 
	(DATA_COMPRESSION = PAGE);

INSERT INTO [emfac].[sandag_vehicle_class] VALUES
	('Drive Alone Non-Toll'),
	('Drive Alone Toll Eligible'),
	('Heavy Heavy Duty Truck (Non-Toll)'),
	('Heavy Heavy Duty Truck (Toll)'),
	('Highway Network Preload - Bus'),
	('Light Heavy Duty Truck (Non-Toll)'),
	('Light Heavy Duty Truck (Toll)'),
	('Medium Heavy Duty Truck (Non-Toll)'),
	('Medium Heavy Duty Truck (Toll)'),
	('Shared Ride 2 Non-Toll'),
	('Shared Ride 2 Toll Eligible'),
	('Shared Ride 3 Non-Toll'),
	('Shared Ride 3 Toll Eligible')
GO

-- Add metadata for [emfac].[sandag_vehicle_class]
EXECUTE [db_meta].[add_xp] 'emfac.sandag_vehicle_class', 'SUBSYSTEM', 'emfac'
EXECUTE [db_meta].[add_xp] 'emfac.sandag_vehicle_class', 'MS_Description', 'assignment sandag vehicle classes used in emfac program'
GO




-- Create emfac default vmt reference table
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID('[emfac].[emfac_default_vmt]') AND type in ('U'))
DROP TABLE [emfac].[emfac_default_vmt]
GO

CREATE TABLE [emfac].[emfac_default_vmt](
	[emfac_default_vmt_id] int IDENTITY(1, 1) NOT NULL,
	[emfac_vehicle_class_id] smallint NOT NULL,
	[year] smallint NOT NULL,
	[vmt] float NOT NULL,
	CONSTRAINT [pk_emfac_default_vmt] PRIMARY KEY ([emfac_default_vmt_id]),
	CONSTRAINT [ixuq_emfac_default_vmt] UNIQUE ([emfac_vehicle_class_id],[year]) WITH (DATA_COMPRESSION = PAGE)) 
ON 
	[reference_fg]
WITH 
	(DATA_COMPRESSION = PAGE);
GO

-- insert emfac default vmt output
-- this is the output from the Default_SanDiegoSD_<<YEAR>>_Annual_vmt_<<datetime>>.csv file
CREATE TABLE #tt_emfac_default_vmt (
	[major_version] varchar(5) NOT NULL,
	[minor_version] varchar(5) NOT NULL,
	[calendar_year] smallint NOT NULL,
	[vehicle_class] varchar(50) NOT NULL,
	[fuel] varchar(10) NOT NULL,
	[vmt] float NOT NULL,
	CONSTRAINT [pk_tt_emfac_default_vmt] PRIMARY KEY ([major_version], [minor_version], [calendar_year], [vehicle_class], [fuel]))
INSERT INTO #tt_emfac_default_vmt VALUES
	('2014', '1.0', 2016, 'LDA', 'Gas', 42635257.4215625),
	('2014', '1.0', 2016, 'LDA', 'Dsl', 426828.919615786),
	('2014', '1.0', 2016, 'LDA', 'Elec', 361065.7688),
	('2014', '1.0', 2016, 'LDT1', 'Gas', 3819079.06131335),
	('2014', '1.0', 2016, 'LDT2', 'Gas', 15191198.6715159),
	('2014', '1.0', 2016, 'MDV', 'Gas', 9503697.60677983),
	('2014', '1.0', 2016, 'LHD1', 'Gas', 871997.976708303),
	('2014', '1.0', 2016, 'LHD2', 'Gas', 158011.570350224),
	('2014', '1.0', 2016, 'T6TS', 'Gas', 130292.240587274),
	('2014', '1.0', 2016, 'T7IS', 'Gas', 15823.2389216182),
	('2014', '1.0', 2016, 'LDT1', 'Dsl', 4626.51039492335),
	('2014', '1.0', 2016, 'LDT2', 'Dsl', 23278.763103949),
	('2014', '1.0', 2016, 'MDV', 'Dsl', 118354.328689985),
	('2014', '1.0', 2016, 'LHD1', 'Dsl', 822600.359829786),
	('2014', '1.0', 2016, 'LHD2', 'Dsl', 289554.295195844),
	('2014', '1.0', 2016, 'LDT1', 'Elec', 1226.726986),
	('2014', '1.0', 2016, 'UBUS', 'Gas', 51061.3987570125),
	('2014', '1.0', 2016, 'SBUS', 'Gas', 13048.9122722549),
	('2014', '1.0', 2016, 'OBUS', 'Gas', 78345.6206138285),
	('2014', '1.0', 2016, 'UBUS', 'Dsl', 131235.774521707),
	('2014', '1.0', 2016, 'MCY', 'Gas', 519051.304688517),
	('2014', '1.0', 2016, 'MH', 'Gas', 105400.84269778),
	('2014', '1.0', 2016, 'MH', 'Dsl', 25059.8493878083),
	('2014', '1.0', 2016, 'T6 Ag', 'Dsl', 3928.58633777122),
	('2014', '1.0', 2016, 'T6 Public', 'Dsl', 34896.2868149329),
	('2014', '1.0', 2016, 'T6 CAIRP Small', 'Dsl', 5588.7593863279),
	('2014', '1.0', 2016, 'T6 CAIRP Heavy', 'Dsl', 1820.58915998585),
	('2014', '1.0', 2016, 'T6 Instate Construction Small', 'Dsl', 101250.782925016),
	('2014', '1.0', 2016, 'T6 Instate Construction Heavy', 'Dsl', 37690.2688608889),
	('2014', '1.0', 2016, 'T6 Instate Small', 'Dsl', 575058.262258837),
	('2014', '1.0', 2016, 'T6 Instate Heavy', 'Dsl', 223541.362684953),
	('2014', '1.0', 2016, 'T6 OOS Small', 'Dsl', 3202.14909387798),
	('2014', '1.0', 2016, 'T6 OOS Heavy', 'Dsl', 1043.12916802869),
	('2014', '1.0', 2016, 'T6 Utility', 'Dsl', 4845.49741376434),
	('2014', '1.0', 2016, 'T7 Ag', 'Dsl', 2922.30224584869),
	('2014', '1.0', 2016, 'T7 Public', 'Dsl', 30181.8458359344),
	('2014', '1.0', 2016, 'PTO', 'Dsl', 27520.8470944743),
	('2014', '1.0', 2016, 'T7 CAIRP', 'Dsl', 278500.099616451),
	('2014', '1.0', 2016, 'T7 CAIRP Construction', 'Dsl', 26737.1895323611),
	('2014', '1.0', 2016, 'T7 Utility', 'Dsl', 2489.15210649718),
	('2014', '1.0', 2016, 'T7 NNOOS', 'Dsl', 345340.470043116),
	('2014', '1.0', 2016, 'T7 NOOS', 'Dsl', 110007.457219493),
	('2014', '1.0', 2016, 'T7 Other Port', 'Dsl', 72845.3468954483),
	('2014', '1.0', 2016, 'T7 POLA', 'Dsl', 29634.6936254156),
	('2014', '1.0', 2016, 'T7 Single', 'Dsl', 138600.48692929),
	('2014', '1.0', 2016, 'T7 Single Construction', 'Dsl', 69165.5914162094),
	('2014', '1.0', 2016, 'T7 Tractor', 'Dsl', 413512.272205298),
	('2014', '1.0', 2016, 'T7 Tractor Construction', 'Dsl', 51568.0604271223),
	('2014', '1.0', 2016, 'T7 SWCV', 'Dsl', 65616.3452535721),
	('2014', '1.0', 2016, 'SBUS', 'Dsl', 43271.0655343951),
	('2014', '1.0', 2016, 'Motor Coach', 'Dsl', 26910.9556900688),
	('2014', '1.0', 2016, 'All Other Buses', 'Dsl', 39743.2555554817),
	('2014', '1.0', 2017, 'LDA', 'Gas', 44179602.3522944),
	('2014', '1.0', 2017, 'LDA', 'Dsl', 461703.192858792),
	('2014', '1.0', 2017, 'LDA', 'Elec', 459468.859211156),
	('2014', '1.0', 2017, 'LDT1', 'Gas', 3754424.42924429),
	('2014', '1.0', 2017, 'LDT2', 'Gas', 15294622.901609),
	('2014', '1.0', 2017, 'MDV', 'Gas', 9417997.52090453),
	('2014', '1.0', 2017, 'LHD1', 'Gas', 812630.960504969),
	('2014', '1.0', 2017, 'LHD2', 'Gas', 156371.933522921),
	('2014', '1.0', 2017, 'T6TS', 'Gas', 134534.541208634),
	('2014', '1.0', 2017, 'T7IS', 'Gas', 16383.1930439717),
	('2014', '1.0', 2017, 'LDT1', 'Dsl', 4371.10261439934),
	('2014', '1.0', 2017, 'LDT2', 'Dsl', 25189.4715400808),
	('2014', '1.0', 2017, 'MDV', 'Dsl', 133039.139046432),
	('2014', '1.0', 2017, 'LHD1', 'Dsl', 817208.471588187),
	('2014', '1.0', 2017, 'LHD2', 'Dsl', 297507.852355986),
	('2014', '1.0', 2017, 'LDT1', 'Elec', 1248.27149892768),
	('2014', '1.0', 2017, 'UBUS', 'Gas', 53301.1176229663),
	('2014', '1.0', 2017, 'SBUS', 'Gas', 13848.819047245),
	('2014', '1.0', 2017, 'OBUS', 'Gas', 80946.6887330535),
	('2014', '1.0', 2017, 'UBUS', 'Dsl', 126235.497924388),
	('2014', '1.0', 2017, 'MCY', 'Gas', 518937.441235234),
	('2014', '1.0', 2017, 'MH', 'Gas', 99840.389862293),
	('2014', '1.0', 2017, 'MH', 'Dsl', 24361.884089354),
	('2014', '1.0', 2017, 'T6 Ag', 'Dsl', 3928.58633777123),
	('2014', '1.0', 2017, 'T6 Public', 'Dsl', 35391.4490999579),
	('2014', '1.0', 2017, 'T6 CAIRP Small', 'Dsl', 5779.99177668877),
	('2014', '1.0', 2017, 'T6 CAIRP Heavy', 'Dsl', 1882.88484904001),
	('2014', '1.0', 2017, 'T6 Instate Construction Small', 'Dsl', 99468.3003179174),
	('2014', '1.0', 2017, 'T6 Instate Construction Heavy', 'Dsl', 37026.7456094073),
	('2014', '1.0', 2017, 'T6 Instate Small', 'Dsl', 600087.145413497),
	('2014', '1.0', 2017, 'T6 Instate Heavy', 'Dsl', 232253.908145976),
	('2014', '1.0', 2017, 'T6 OOS Small', 'Dsl', 3311.71806673665),
	('2014', '1.0', 2017, 'T6 OOS Heavy', 'Dsl', 1078.82225668541),
	('2014', '1.0', 2017, 'T6 Utility', 'Dsl', 4896.38676716811),
	('2014', '1.0', 2017, 'T7 Ag', 'Dsl', 2922.30224584869),
	('2014', '1.0', 2017, 'T7 Public', 'Dsl', 30303.0319393219),
	('2014', '1.0', 2017, 'PTO', 'Dsl', 28405.1281995013),
	('2014', '1.0', 2017, 'T7 CAIRP', 'Dsl', 288029.627743155),
	('2014', '1.0', 2017, 'T7 CAIRP Construction', 'Dsl', 26266.4911937671),
	('2014', '1.0', 2017, 'T7 Utility', 'Dsl', 2515.2941782819),
	('2014', '1.0', 2017, 'T7 NNOOS', 'Dsl', 357157.096777173),
	('2014', '1.0', 2017, 'T7 NOOS', 'Dsl', 113771.618019306),
	('2014', '1.0', 2017, 'T7 Other Port', 'Dsl', 75897.1762458404),
	('2014', '1.0', 2017, 'T7 POLA', 'Dsl', 31265.1548263392),
	('2014', '1.0', 2017, 'T7 Single', 'Dsl', 143053.903327354),
	('2014', '1.0', 2017, 'T7 Single Construction', 'Dsl', 67947.9567456659),
	('2014', '1.0', 2017, 'T7 Tractor', 'Dsl', 427919.110900353),
	('2014', '1.0', 2017, 'T7 Tractor Construction', 'Dsl', 50660.2237848982),
	('2014', '1.0', 2017, 'T7 SWCV', 'Dsl', 67133.6791794598),
	('2014', '1.0', 2017, 'SBUS', 'Dsl', 44888.6499855504),
	('2014', '1.0', 2017, 'Motor Coach', 'Dsl', 27831.7765785288),
	('2014', '1.0', 2017, 'All Other Buses', 'Dsl', 39551.0883919118),
	('2014', '1.0', 2020, 'LDA', 'Gas', 46477370.3052946),
	('2014', '1.0', 2020, 'LDA', 'Dsl', 538420.329353311),
	('2014', '1.0', 2020, 'LDA', 'Elec', 1411897.27979924),
	('2014', '1.0', 2020, 'LDT1', 'Gas', 3527546.68023022),
	('2014', '1.0', 2020, 'LDT2', 'Gas', 15153592.8948958),
	('2014', '1.0', 2020, 'MDV', 'Gas', 8951665.34842478),
	('2014', '1.0', 2020, 'LHD1', 'Gas', 646438.91593793),
	('2014', '1.0', 2020, 'LHD2', 'Gas', 147807.929508414),
	('2014', '1.0', 2020, 'T6TS', 'Gas', 144534.91417192),
	('2014', '1.0', 2020, 'T7IS', 'Gas', 18029.7835723667),
	('2014', '1.0', 2020, 'LDT1', 'Dsl', 3620.17281016068),
	('2014', '1.0', 2020, 'LDT2', 'Dsl', 29442.8794211064),
	('2014', '1.0', 2020, 'MDV', 'Dsl', 168365.090178335),
	('2014', '1.0', 2020, 'LHD1', 'Dsl', 777102.187110278),
	('2014', '1.0', 2020, 'LHD2', 'Dsl', 309669.221307391),
	('2014', '1.0', 2020, 'LDT1', 'Elec', 1282.6929551445),
	('2014', '1.0', 2020, 'UBUS', 'Gas', 57900.5065073061),
	('2014', '1.0', 2020, 'SBUS', 'Gas', 16025.5311725526),
	('2014', '1.0', 2020, 'OBUS', 'Gas', 85997.5983690948),
	('2014', '1.0', 2020, 'UBUS', 'Dsl', 108695.77098302),
	('2014', '1.0', 2020, 'MCY', 'Gas', 508817.781208714),
	('2014', '1.0', 2020, 'MH', 'Gas', 83043.6876042318),
	('2014', '1.0', 2020, 'MH', 'Dsl', 21581.9626001239),
	('2014', '1.0', 2020, 'T6 Ag', 'Dsl', 3928.58633777123),
	('2014', '1.0', 2020, 'T6 Public', 'Dsl', 36668.3626313309),
	('2014', '1.0', 2020, 'T6 CAIRP Small', 'Dsl', 6437.72508520719),
	('2014', '1.0', 2020, 'T6 CAIRP Heavy', 'Dsl', 2097.14745168125),
	('2014', '1.0', 2020, 'T6 Instate Construction Small', 'Dsl', 91434.2247662234),
	('2014', '1.0', 2020, 'T6 Instate Construction Heavy', 'Dsl', 34036.0875735453),
	('2014', '1.0', 2020, 'T6 Instate Small', 'Dsl', 684747.322608806),
	('2014', '1.0', 2020, 'T6 Instate Heavy', 'Dsl', 264836.176316617),
	('2014', '1.0', 2020, 'T6 OOS Small', 'Dsl', 3688.57453385135),
	('2014', '1.0', 2020, 'T6 OOS Heavy', 'Dsl', 1201.58667566864),
	('2014', '1.0', 2020, 'T6 Utility', 'Dsl', 5054.01348903667),
	('2014', '1.0', 2020, 'T7 Ag', 'Dsl', 2922.3022458487),
	('2014', '1.0', 2020, 'T7 Public', 'Dsl', 30810.2573126309),
	('2014', '1.0', 2020, 'PTO', 'Dsl', 31430.4853088272),
	('2014', '1.0', 2020, 'T7 CAIRP', 'Dsl', 320805.916590292),
	('2014', '1.0', 2020, 'T7 CAIRP Construction', 'Dsl', 24144.9411717585),
	('2014', '1.0', 2020, 'T7 Utility', 'Dsl', 2596.2676786835),
	('2014', '1.0', 2020, 'T7 NNOOS', 'Dsl', 397799.73572893),
	('2014', '1.0', 2020, 'T7 NOOS', 'Dsl', 126718.242448278),
	('2014', '1.0', 2020, 'T7 Other Port', 'Dsl', 86658.7925898185),
	('2014', '1.0', 2020, 'T7 POLA', 'Dsl', 36156.5384291101),
	('2014', '1.0', 2020, 'T7 Single', 'Dsl', 158290.206448697),
	('2014', '1.0', 2020, 'T7 Single Construction', 'Dsl', 62459.785978365),
	('2014', '1.0', 2020, 'T7 Tractor', 'Dsl', 478144.832837156),
	('2014', '1.0', 2020, 'T7 Tractor Construction', 'Dsl', 46568.3868473741),
	('2014', '1.0', 2020, 'T7 SWCV', 'Dsl', 71432.9547422583),
	('2014', '1.0', 2020, 'SBUS', 'Dsl', 45288.8208880947),
	('2014', '1.0', 2020, 'Motor Coach', 'Dsl', 30998.8894738743),
	('2014', '1.0', 2020, 'All Other Buses', 'Dsl', 39534.1053746632),
	('2014', '1.0', 2025, 'LDA', 'Gas', 47587916.8373453),
	('2014', '1.0', 2025, 'LDA', 'Dsl', 610522.55882162),
	('2014', '1.0', 2025, 'LDA', 'Elec', 4362999.30273061),
	('2014', '1.0', 2025, 'LDT1', 'Gas', 3351787.67502307),
	('2014', '1.0', 2025, 'LDT2', 'Gas', 15377108.9925014),
	('2014', '1.0', 2025, 'MDV', 'Gas', 8534402.66267022),
	('2014', '1.0', 2025, 'LHD1', 'Gas', 468069.795750459),
	('2014', '1.0', 2025, 'LHD2', 'Gas', 139572.070649092),
	('2014', '1.0', 2025, 'T6TS', 'Gas', 161145.594265312),
	('2014', '1.0', 2025, 'T7IS', 'Gas', 21202.3780694177),
	('2014', '1.0', 2025, 'LDT1', 'Dsl', 2803.10713446673),
	('2014', '1.0', 2025, 'LDT2', 'Dsl', 33384.9391530872),
	('2014', '1.0', 2025, 'MDV', 'Dsl', 206955.856394072),
	('2014', '1.0', 2025, 'LHD1', 'Dsl', 724642.354874594),
	('2014', '1.0', 2025, 'LHD2', 'Dsl', 322602.573968487),
	('2014', '1.0', 2025, 'LDT1', 'Elec', 1338.28194944701),
	('2014', '1.0', 2025, 'UBUS', 'Gas', 63912.5467743571),
	('2014', '1.0', 2025, 'SBUS', 'Gas', 19991.2601173306),
	('2014', '1.0', 2025, 'OBUS', 'Gas', 92464.3354352665),
	('2014', '1.0', 2025, 'UBUS', 'Dsl', 93377.9791787174),
	('2014', '1.0', 2025, 'MCY', 'Gas', 501031.335181827),
	('2014', '1.0', 2025, 'MH', 'Gas', 64191.892075194),
	('2014', '1.0', 2025, 'MH', 'Dsl', 17748.2635310609),
	('2014', '1.0', 2025, 'T6 Ag', 'Dsl', 3928.58633777122),
	('2014', '1.0', 2025, 'T6 Public', 'Dsl', 38271.3933116404),
	('2014', '1.0', 2025, 'T6 CAIRP Small', 'Dsl', 7216.98208435687),
	('2014', '1.0', 2025, 'T6 CAIRP Heavy', 'Dsl', 2350.99750093649),
	('2014', '1.0', 2025, 'T6 Instate Construction Small', 'Dsl', 97296.4570597357),
	('2014', '1.0', 2025, 'T6 Instate Construction Heavy', 'Dsl', 36218.2841441247),
	('2014', '1.0', 2025, 'T6 Instate Small', 'Dsl', 794019.535961944),
	('2014', '1.0', 2025, 'T6 Instate Heavy', 'Dsl', 311813.02450752),
	('2014', '1.0', 2025, 'T6 OOS Small', 'Dsl', 4135.05950864372),
	('2014', '1.0', 2025, 'T6 OOS Heavy', 'Dsl', 1347.03321380232),
	('2014', '1.0', 2025, 'T6 Utility', 'Dsl', 5321.84787228649),
	('2014', '1.0', 2025, 'T7 Ag', 'Dsl', 2922.30224584869),
	('2014', '1.0', 2025, 'T7 Public', 'Dsl', 30803.3622896822),
	('2014', '1.0', 2025, 'PTO', 'Dsl', 35256.5356528937),
	('2014', '1.0', 2025, 'T7 CAIRP', 'Dsl', 359637.996643858),
	('2014', '1.0', 2025, 'T7 CAIRP Construction', 'Dsl', 25692.9747907227),
	('2014', '1.0', 2025, 'T7 Utility', 'Dsl', 2733.85531155785),
	('2014', '1.0', 2025, 'T7 NNOOS', 'Dsl', 445951.563311466),
	('2014', '1.0', 2025, 'T7 NOOS', 'Dsl', 142056.90261795),
	('2014', '1.0', 2025, 'T7 Other Port', 'Dsl', 98649.9992663932),
	('2014', '1.0', 2025, 'T7 POLA', 'Dsl', 47501.8506473591),
	('2014', '1.0', 2025, 'T7 Single', 'Dsl', 177558.960745511),
	('2014', '1.0', 2025, 'T7 Single Construction', 'Dsl', 66464.3452705166),
	('2014', '1.0', 2025, 'T7 Tractor', 'Dsl', 540975.703034865),
	('2014', '1.0', 2025, 'T7 Tractor Construction', 'Dsl', 49554.0817765043),
	('2014', '1.0', 2025, 'T7 SWCV', 'Dsl', 78081.7878023427),
	('2014', '1.0', 2025, 'SBUS', 'Dsl', 45957.6346394587),
	('2014', '1.0', 2025, 'Motor Coach', 'Dsl', 34751.1624070398),
	('2014', '1.0', 2025, 'All Other Buses', 'Dsl', 39125.3078141994),
	('2014', '1.0', 2030, 'LDA', 'Gas', 47786587.0719261),
	('2014', '1.0', 2030, 'LDA', 'Dsl', 640574.545947961),
	('2014', '1.0', 2030, 'LDA', 'Elec', 6819437.3444266),
	('2014', '1.0', 2030, 'LDT1', 'Gas', 3329391.11004832),
	('2014', '1.0', 2030, 'LDT2', 'Gas', 15864608.9522573),
	('2014', '1.0', 2030, 'MDV', 'Gas', 8526088.21630027),
	('2014', '1.0', 2030, 'LHD1', 'Gas', 380410.211470587),
	('2014', '1.0', 2030, 'LHD2', 'Gas', 138600.40344593),
	('2014', '1.0', 2030, 'T6TS', 'Gas', 174715.945666432),
	('2014', '1.0', 2030, 'T7IS', 'Gas', 23466.7385979223),
	('2014', '1.0', 2030, 'LDT1', 'Dsl', 1872.24075107995),
	('2014', '1.0', 2030, 'LDT2', 'Dsl', 34812.8654623428),
	('2014', '1.0', 2030, 'MDV', 'Dsl', 228716.075766619),
	('2014', '1.0', 2030, 'LHD1', 'Dsl', 703166.654169448),
	('2014', '1.0', 2030, 'LHD2', 'Dsl', 334565.621686019),
	('2014', '1.0', 2030, 'LDT1', 'Elec', 1405.43891539444),
	('2014', '1.0', 2030, 'UBUS', 'Gas', 68166.1853585003),
	('2014', '1.0', 2030, 'SBUS', 'Gas', 23773.0118674348),
	('2014', '1.0', 2030, 'OBUS', 'Gas', 97329.0458669687),
	('2014', '1.0', 2030, 'UBUS', 'Dsl', 82103.0139539401),
	('2014', '1.0', 2030, 'MCY', 'Gas', 503373.316758924),
	('2014', '1.0', 2030, 'MH', 'Gas', 54713.567329612),
	('2014', '1.0', 2030, 'MH', 'Dsl', 15379.252782547),
	('2014', '1.0', 2030, 'T6 Ag', 'Dsl', 3928.58633777123),
	('2014', '1.0', 2030, 'T6 Public', 'Dsl', 39599.3415930405),
	('2014', '1.0', 2030, 'T6 CAIRP Small', 'Dsl', 7712.66439962127),
	('2014', '1.0', 2030, 'T6 CAIRP Heavy', 'Dsl', 2512.47051982771),
	('2014', '1.0', 2030, 'T6 Instate Construction Small', 'Dsl', 101657.314129198),
	('2014', '1.0', 2030, 'T6 Instate Construction Heavy', 'Dsl', 37841.5987562564),
	('2014', '1.0', 2030, 'T6 Instate Small', 'Dsl', 862011.864825051),
	('2014', '1.0', 2030, 'T6 Instate Heavy', 'Dsl', 341613.46064481),
	('2014', '1.0', 2030, 'T6 OOS Small', 'Dsl', 4419.06684675854),
	('2014', '1.0', 2030, 'T6 OOS Heavy', 'Dsl', 1439.55118521351),
	('2014', '1.0', 2030, 'T6 Utility', 'Dsl', 5582.40631854939),
	('2014', '1.0', 2030, 'T7 Ag', 'Dsl', 2922.30224584868),
	('2014', '1.0', 2030, 'T7 Public', 'Dsl', 30705.4242749657),
	('2014', '1.0', 2030, 'PTO', 'Dsl', 37957.5596549897),
	('2014', '1.0', 2030, 'T7 CAIRP', 'Dsl', 384338.930185023),
	('2014', '1.0', 2030, 'T7 CAIRP Construction', 'Dsl', 26844.5418070106),
	('2014', '1.0', 2030, 'T7 Utility', 'Dsl', 2867.70526544259),
	('2014', '1.0', 2030, 'T7 NNOOS', 'Dsl', 476580.7516362),
	('2014', '1.0', 2030, 'T7 NOOS', 'Dsl', 151813.764082465),
	('2014', '1.0', 2030, 'T7 Other Port', 'Dsl', 108045.491366829),
	('2014', '1.0', 2030, 'T7 POLA', 'Dsl', 60669.7868575451),
	('2014', '1.0', 2030, 'T7 Single', 'Dsl', 191161.857510028),
	('2014', '1.0', 2030, 'T7 Single Construction', 'Dsl', 69443.2976260189),
	('2014', '1.0', 2030, 'T7 Tractor', 'Dsl', 581132.251682551),
	('2014', '1.0', 2030, 'T7 Tractor Construction', 'Dsl', 51775.1109317911),
	('2014', '1.0', 2030, 'T7 SWCV', 'Dsl', 83529.868336995),
	('2014', '1.0', 2030, 'SBUS', 'Dsl', 46570.8016311325),
	('2014', '1.0', 2030, 'Motor Coach', 'Dsl', 37137.9684762122),
	('2014', '1.0', 2030, 'All Other Buses', 'Dsl', 38624.9004697453),
	('2014', '1.0', 2035, 'LDA', 'Gas', 48408570.2583729),
	('2014', '1.0', 2035, 'LDA', 'Dsl', 665027.105770658),
	('2014', '1.0', 2035, 'LDA', 'Elec', 8233397.43700278),
	('2014', '1.0', 2035, 'LDT1', 'Gas', 3378752.88003488),
	('2014', '1.0', 2035, 'LDT2', 'Gas', 16378273.4043412),
	('2014', '1.0', 2035, 'MDV', 'Gas', 8741809.62620017),
	('2014', '1.0', 2035, 'LHD1', 'Gas', 345136.839472689),
	('2014', '1.0', 2035, 'LHD2', 'Gas', 141927.950704305),
	('2014', '1.0', 2035, 'T6TS', 'Gas', 184607.517010469),
	('2014', '1.0', 2035, 'T7IS', 'Gas', 24830.5641142837),
	('2014', '1.0', 2035, 'LDT1', 'Dsl', 1874.33928230513),
	('2014', '1.0', 2035, 'LDT2', 'Dsl', 35919.4346481846),
	('2014', '1.0', 2035, 'MDV', 'Dsl', 243300.467184301),
	('2014', '1.0', 2035, 'LHD1', 'Dsl', 707069.416075168),
	('2014', '1.0', 2035, 'LHD2', 'Dsl', 348187.271585498),
	('2014', '1.0', 2035, 'LDT1', 'Elec', 1481.13940281916),
	('2014', '1.0', 2035, 'UBUS', 'Gas', 71917.5691049383),
	('2014', '1.0', 2035, 'SBUS', 'Gas', 27270.9091637599),
	('2014', '1.0', 2035, 'OBUS', 'Gas', 101446.802645298),
	('2014', '1.0', 2035, 'UBUS', 'Dsl', 79488.3329840073),
	('2014', '1.0', 2035, 'MCY', 'Gas', 514749.381883448),
	('2014', '1.0', 2035, 'MH', 'Gas', 51253.0535449531),
	('2014', '1.0', 2035, 'MH', 'Dsl', 14508.0379388716),
	('2014', '1.0', 2035, 'T6 Ag', 'Dsl', 3928.58633777123),
	('2014', '1.0', 2035, 'T6 Public', 'Dsl', 40937.207028471),
	('2014', '1.0', 2035, 'T6 CAIRP Small', 'Dsl', 8208.34671488568),
	('2014', '1.0', 2035, 'T6 CAIRP Heavy', 'Dsl', 2673.94353871894),
	('2014', '1.0', 2035, 'T6 Instate Construction Small', 'Dsl', 120792.704872446),
	('2014', '1.0', 2035, 'T6 Instate Construction Heavy', 'Dsl', 44964.6846330865),
	('2014', '1.0', 2035, 'T6 Instate Small', 'Dsl', 924383.366836715),
	('2014', '1.0', 2035, 'T6 Instate Heavy', 'Dsl', 366986.317086572),
	('2014', '1.0', 2035, 'T6 OOS Small', 'Dsl', 4703.07418487337),
	('2014', '1.0', 2035, 'T6 OOS Heavy', 'Dsl', 1532.06915662469),
	('2014', '1.0', 2035, 'T6 Utility', 'Dsl', 5828.11673835576),
	('2014', '1.0', 2035, 'T7 Ag', 'Dsl', 2922.30224584869),
	('2014', '1.0', 2035, 'T7 Public', 'Dsl', 30844.5413056471),
	('2014', '1.0', 2035, 'PTO', 'Dsl', 40648.1026892651),
	('2014', '1.0', 2035, 'T7 CAIRP', 'Dsl', 409039.863726188),
	('2014', '1.0', 2035, 'T7 CAIRP Construction', 'Dsl', 31897.6046505531),
	('2014', '1.0', 2035, 'T7 Utility', 'Dsl', 2993.92772659013),
	('2014', '1.0', 2035, 'T7 NNOOS', 'Dsl', 507209.939960935),
	('2014', '1.0', 2035, 'T7 NOOS', 'Dsl', 161570.625546979),
	('2014', '1.0', 2035, 'T7 Other Port', 'Dsl', 117849.084714346),
	('2014', '1.0', 2035, 'T7 POLA', 'Dsl', 71484.903161145),
	('2014', '1.0', 2035, 'T7 Single', 'Dsl', 204711.97002563),
	('2014', '1.0', 2035, 'T7 Single Construction', 'Dsl', 82514.9063534013),
	('2014', '1.0', 2035, 'T7 Tractor', 'Dsl', 620348.512251583),
	('2014', '1.0', 2035, 'T7 Tractor Construction', 'Dsl', 61520.9613601791),
	('2014', '1.0', 2035, 'T7 SWCV', 'Dsl', 88703.3812772072),
	('2014', '1.0', 2035, 'SBUS', 'Dsl', 46984.4031905381),
	('2014', '1.0', 2035, 'Motor Coach', 'Dsl', 39524.7745453844),
	('2014', '1.0', 2035, 'All Other Buses', 'Dsl', 39397.3231010727),
	('2014', '1.0', 2040, 'LDA', 'Gas', 49363216.4968083),
	('2014', '1.0', 2040, 'LDA', 'Dsl', 685436.635435044),
	('2014', '1.0', 2040, 'LDA', 'Elec', 8948393.82097683),
	('2014', '1.0', 2040, 'LDT1', 'Gas', 3455160.07988165),
	('2014', '1.0', 2040, 'LDT2', 'Gas', 16835632.1713115),
	('2014', '1.0', 2040, 'MDV', 'Gas', 8992380.00954148),
	('2014', '1.0', 2040, 'LHD1', 'Gas', 335176.531721659),
	('2014', '1.0', 2040, 'LHD2', 'Gas', 145971.759642308),
	('2014', '1.0', 2040, 'T6TS', 'Gas', 191875.959296988),
	('2014', '1.0', 2040, 'T7IS', 'Gas', 25767.4818176463),
	('2014', '1.0', 2040, 'LDT1', 'Dsl', 1920.4156606511),
	('2014', '1.0', 2040, 'LDT2', 'Dsl', 36983.4622454689),
	('2014', '1.0', 2040, 'MDV', 'Dsl', 253699.538129156),
	('2014', '1.0', 2040, 'LHD1', 'Dsl', 719459.316175938),
	('2014', '1.0', 2040, 'LHD2', 'Dsl', 359749.676234085),
	('2014', '1.0', 2040, 'LDT1', 'Elec', 1532.34197781194),
	('2014', '1.0', 2040, 'UBUS', 'Gas', 75151.0828805302),
	('2014', '1.0', 2040, 'SBUS', 'Gas', 30322.2412088052),
	('2014', '1.0', 2040, 'OBUS', 'Gas', 104974.194385037),
	('2014', '1.0', 2040, 'UBUS', 'Dsl', 77984.3392108103),
	('2014', '1.0', 2040, 'MCY', 'Gas', 528802.790484717),
	('2014', '1.0', 2040, 'MH', 'Gas', 50912.4914673983),
	('2014', '1.0', 2040, 'MH', 'Dsl', 14372.0111695892),
	('2014', '1.0', 2040, 'T6 Ag', 'Dsl', 3928.58633777123),
	('2014', '1.0', 2040, 'T6 Public', 'Dsl', 42323.0529359535),
	('2014', '1.0', 2040, 'T6 CAIRP Small', 'Dsl', 8704.02903015006),
	('2014', '1.0', 2040, 'T6 CAIRP Heavy', 'Dsl', 2835.41655761017),
	('2014', '1.0', 2040, 'T6 Instate Construction Small', 'Dsl', 142197.366534645),
	('2014', '1.0', 2040, 'T6 Instate Construction Heavy', 'Dsl', 52932.4990994903),
	('2014', '1.0', 2040, 'T6 Instate Small', 'Dsl', 983465.900700678),
	('2014', '1.0', 2040, 'T6 Instate Heavy', 'Dsl', 390366.323326952),
	('2014', '1.0', 2040, 'T6 OOS Small', 'Dsl', 4987.0815229882),
	('2014', '1.0', 2040, 'T6 OOS Heavy', 'Dsl', 1624.58712803589),
	('2014', '1.0', 2040, 'T6 Utility', 'Dsl', 6057.7846500253),
	('2014', '1.0', 2040, 'T7 Ag', 'Dsl', 2922.30224584868),
	('2014', '1.0', 2040, 'T7 Public', 'Dsl', 31176.9112301875),
	('2014', '1.0', 2040, 'PTO', 'Dsl', 43230.2144898272),
	('2014', '1.0', 2040, 'T7 CAIRP', 'Dsl', 433740.797267353),
	('2014', '1.0', 2040, 'T7 CAIRP Construction', 'Dsl', 37549.9115187587),
	('2014', '1.0', 2040, 'T7 Utility', 'Dsl', 3111.90908481003),
	('2014', '1.0', 2040, 'T7 NNOOS', 'Dsl', 537839.12828567),
	('2014', '1.0', 2040, 'T7 NOOS', 'Dsl', 171327.487011494),
	('2014', '1.0', 2040, 'T7 Other Port', 'Dsl', 128075.311761056),
	('2014', '1.0', 2040, 'T7 POLA', 'Dsl', 84061.4007179998),
	('2014', '1.0', 2040, 'T7 Single', 'Dsl', 217716.001174643),
	('2014', '1.0', 2040, 'T7 Single Construction', 'Dsl', 97136.6805279902),
	('2014', '1.0', 2040, 'T7 Tractor', 'Dsl', 658769.455887983),
	('2014', '1.0', 2040, 'T7 Tractor Construction', 'Dsl', 72422.5747021303),
	('2014', '1.0', 2040, 'T7 SWCV', 'Dsl', 93275.2531107462),
	('2014', '1.0', 2040, 'SBUS', 'Dsl', 47159.0039916262),
	('2014', '1.0', 2040, 'Motor Coach', 'Dsl', 41911.5806145567),
	('2014', '1.0', 2040, 'All Other Buses', 'Dsl', 41163.7975371907),
	('2014', '1.0', 2045, 'LDA', 'Gas', 50487482.338569),
	('2014', '1.0', 2045, 'LDA', 'Dsl', 703663.176851595),
	('2014', '1.0', 2045, 'LDA', 'Elec', 9322353.80898545),
	('2014', '1.0', 2045, 'LDT1', 'Gas', 3530473.76467834),
	('2014', '1.0', 2045, 'LDT2', 'Gas', 17257260.6013902),
	('2014', '1.0', 2045, 'MDV', 'Gas', 9213694.80001052),
	('2014', '1.0', 2045, 'LHD1', 'Gas', 333035.374307102),
	('2014', '1.0', 2045, 'LHD2', 'Gas', 149983.723489533),
	('2014', '1.0', 2045, 'T6TS', 'Gas', 197790.478209345),
	('2014', '1.0', 2045, 'T7IS', 'Gas', 26535.8438706765),
	('2014', '1.0', 2045, 'LDT1', 'Dsl', 1964.3354470808),
	('2014', '1.0', 2045, 'LDT2', 'Dsl', 37979.6851169149),
	('2014', '1.0', 2045, 'MDV', 'Dsl', 262215.428534092),
	('2014', '1.0', 2045, 'LHD1', 'Dsl', 736419.344042699),
	('2014', '1.0', 2045, 'LHD2', 'Dsl', 370233.98751231),
	('2014', '1.0', 2045, 'LDT1', 'Elec', 1575.93651138719),
	('2014', '1.0', 2045, 'UBUS', 'Gas', 78036.4748262484),
	('2014', '1.0', 2045, 'SBUS', 'Gas', 32189.0682859471),
	('2014', '1.0', 2045, 'OBUS', 'Gas', 108017.98128386),
	('2014', '1.0', 2045, 'UBUS', 'Dsl', 78461.3906735761),
	('2014', '1.0', 2045, 'MCY', 'Gas', 542158.154267195),
	('2014', '1.0', 2045, 'MH', 'Gas', 51539.3504226918),
	('2014', '1.0', 2045, 'MH', 'Dsl', 14514.7100853378),
	('2014', '1.0', 2045, 'T6 Ag', 'Dsl', 3928.58633777123),
	('2014', '1.0', 2045, 'T6 Public', 'Dsl', 43704.8445234297),
	('2014', '1.0', 2045, 'T6 CAIRP Small', 'Dsl', 9199.71134541445),
	('2014', '1.0', 2045, 'T6 CAIRP Heavy', 'Dsl', 2996.8895765014),
	('2014', '1.0', 2045, 'T6 Instate Construction Small', 'Dsl', 174092.721865968),
	('2014', '1.0', 2045, 'T6 Instate Construction Heavy', 'Dsl', 64805.4395659497),
	('2014', '1.0', 2045, 'T6 Instate Small', 'Dsl', 1040480.07857733),
	('2014', '1.0', 2045, 'T6 Instate Heavy', 'Dsl', 412722.200285996),
	('2014', '1.0', 2045, 'T6 OOS Small', 'Dsl', 5271.08886110303),
	('2014', '1.0', 2045, 'T6 OOS Heavy', 'Dsl', 1717.10509944707),
	('2014', '1.0', 2045, 'T6 Utility', 'Dsl', 6273.60747202819),
	('2014', '1.0', 2045, 'T7 Ag', 'Dsl', 2922.30224584869),
	('2014', '1.0', 2045, 'T7 Public', 'Dsl', 31791.3377908367),
	('2014', '1.0', 2045, 'PTO', 'Dsl', 45744.0105959225),
	('2014', '1.0', 2045, 'T7 CAIRP', 'Dsl', 458441.730808518),
	('2014', '1.0', 2045, 'T7 CAIRP Construction', 'Dsl', 45972.4850145818),
	('2014', '1.0', 2045, 'T7 Utility', 'Dsl', 3222.778163079),
	('2014', '1.0', 2045, 'T7 NNOOS', 'Dsl', 568468.316610405),
	('2014', '1.0', 2045, 'T7 NOOS', 'Dsl', 181084.348476009),
	('2014', '1.0', 2045, 'T7 Other Port', 'Dsl', 138739.176507708),
	('2014', '1.0', 2045, 'T7 POLA', 'Dsl', 95036.642591733),
	('2014', '1.0', 2045, 'T7 Single', 'Dsl', 230375.980831146),
	('2014', '1.0', 2045, 'T7 Single Construction', 'Dsl', 118924.769974713),
	('2014', '1.0', 2045, 'T7 Tractor', 'Dsl', 696435.870411295),
	('2014', '1.0', 2045, 'T7 Tractor Construction', 'Dsl', 88667.2057415592),
	('2014', '1.0', 2045, 'T7 SWCV', 'Dsl', 97043.4572934889),
	('2014', '1.0', 2045, 'SBUS', 'Dsl', 47180.4220494399),
	('2014', '1.0', 2045, 'Motor Coach', 'Dsl', 44298.386683729),
	('2014', '1.0', 2045, 'All Other Buses', 'Dsl', 43300.8898577386),
	('2014', '1.0', 2050, 'LDA', 'Gas', 51627403.9723141),
	('2014', '1.0', 2050, 'LDA', 'Dsl', 720523.995162547),
	('2014', '1.0', 2050, 'LDA', 'Elec', 9581514.20167511),
	('2014', '1.0', 2050, 'LDT1', 'Gas', 3617313.54822532),
	('2014', '1.0', 2050, 'LDT2', 'Gas', 17656932.0057607),
	('2014', '1.0', 2050, 'MDV', 'Gas', 9402704.95097675),
	('2014', '1.0', 2050, 'LHD1', 'Gas', 335072.476082297),
	('2014', '1.0', 2050, 'LHD2', 'Gas', 153807.410946326),
	('2014', '1.0', 2050, 'T6TS', 'Gas', 203126.575572812),
	('2014', '1.0', 2050, 'T7IS', 'Gas', 27238.0921779934),
	('2014', '1.0', 2050, 'LDT1', 'Dsl', 2013.40421716508),
	('2014', '1.0', 2050, 'LDT2', 'Dsl', 38906.0665973664),
	('2014', '1.0', 2050, 'MDV', 'Dsl', 269939.536497837),
	('2014', '1.0', 2050, 'LHD1', 'Dsl', 751698.806014234),
	('2014', '1.0', 2050, 'LHD2', 'Dsl', 379839.656967372),
	('2014', '1.0', 2050, 'LDT1', 'Elec', 1621.4871986614),
	('2014', '1.0', 2050, 'UBUS', 'Gas', 80825.0019135375),
	('2014', '1.0', 2050, 'SBUS', 'Gas', 33260.9988634981),
	('2014', '1.0', 2050, 'OBUS', 'Gas', 110722.700033188),
	('2014', '1.0', 2050, 'UBUS', 'Dsl', 79601.3048978306),
	('2014', '1.0', 2050, 'MCY', 'Gas', 554061.218165707),
	('2014', '1.0', 2050, 'MH', 'Gas', 52491.8447368603),
	('2014', '1.0', 2050, 'MH', 'Dsl', 14739.9875688207),
	('2014', '1.0', 2050, 'T6 Ag', 'Dsl', 3928.58633777123),
	('2014', '1.0', 2050, 'T6 Public', 'Dsl', 45073.8884352664),
	('2014', '1.0', 2050, 'T6 CAIRP Small', 'Dsl', 9695.39366067887),
	('2014', '1.0', 2050, 'T6 CAIRP Heavy', 'Dsl', 3158.36259539263),
	('2014', '1.0', 2050, 'T6 Instate Construction Small', 'Dsl', 198267.704694781),
	('2014', '1.0', 2050, 'T6 Instate Construction Heavy', 'Dsl', 73804.4969184257),
	('2014', '1.0', 2050, 'T6 Instate Small', 'Dsl', 1096429.9218617),
	('2014', '1.0', 2050, 'T6 Instate Heavy', 'Dsl', 434839.722237133),
	('2014', '1.0', 2050, 'T6 OOS Small', 'Dsl', 5555.09619921785),
	('2014', '1.0', 2050, 'T6 OOS Heavy', 'Dsl', 1809.62307085826),
	('2014', '1.0', 2050, 'T6 Utility', 'Dsl', 6478.18685655741),
	('2014', '1.0', 2050, 'T7 Ag', 'Dsl', 2922.30224584868),
	('2014', '1.0', 2050, 'T7 Public', 'Dsl', 32496.3659363719),
	('2014', '1.0', 2050, 'PTO', 'Dsl', 48220.5483946327),
	('2014', '1.0', 2050, 'T7 CAIRP', 'Dsl', 483142.664349684),
	('2014', '1.0', 2050, 'T7 CAIRP Construction', 'Dsl', 52356.3477281595),
	('2014', '1.0', 2050, 'T7 Utility', 'Dsl', 3327.87144091261),
	('2014', '1.0', 2050, 'T7 NNOOS', 'Dsl', 599097.504935139),
	('2014', '1.0', 2050, 'T7 NOOS', 'Dsl', 190841.209940524),
	('2014', '1.0', 2050, 'T7 Other Port', 'Dsl', 149856.168998068),
	('2014', '1.0', 2050, 'T7 POLA', 'Dsl', 106599.011548242),
	('2014', '1.0', 2050, 'T7 Single', 'Dsl', 242848.320204339),
	('2014', '1.0', 2050, 'T7 Single Construction', 'Dsl', 135438.98286796),
	('2014', '1.0', 2050, 'T7 Tractor', 'Dsl', 733911.356293423),
	('2014', '1.0', 2050, 'T7 Tractor Construction', 'Dsl', 100979.772018346),
	('2014', '1.0', 2050, 'T7 SWCV', 'Dsl', 100623.057246242),
	('2014', '1.0', 2050, 'SBUS', 'Dsl', 47180.4220494401),
	('2014', '1.0', 2050, 'Motor Coach', 'Dsl', 46685.1927529014),
	('2014', '1.0', 2050, 'All Other Buses', 'Dsl', 45528.0837601139),
	('2017', '1.0', 2016, 'LDA', 'Gas', 49556075.7855182),
	('2017', '1.0', 2016, 'LDA', 'Dsl', 512070.554520489),
	('2017', '1.0', 2016, 'LDA', 'Elec', 377986.506546188),
	('2017', '1.0', 2016, 'LDT1', 'Gas', 5816482.38270923),
	('2017', '1.0', 2016, 'LDT2', 'Gas', 19051888.3864095),
	('2017', '1.0', 2016, 'MDV', 'Gas', 12415805.3561357),
	('2017', '1.0', 2016, 'LHD1', 'Gas', 1425643.17575046),
	('2017', '1.0', 2016, 'LHD2', 'Gas', 193662.649516449),
	('2017', '1.0', 2016, 'T6TS', 'Gas', 176511.812248815),
	('2017', '1.0', 2016, 'T7IS', 'Gas', 1919.21550833428),
	('2017', '1.0', 2016, 'LDT1', 'Dsl', 3675.19184194763),
	('2017', '1.0', 2016, 'LDT2', 'Dsl', 75200.4200504308),
	('2017', '1.0', 2016, 'MDV', 'Dsl', 221113.191548664),
	('2017', '1.0', 2016, 'LHD1', 'Dsl', 1085785.61582288),
	('2017', '1.0', 2016, 'LHD2', 'Dsl', 356727.71633393),
	('2017', '1.0', 2016, 'T6 Ag', 'Dsl', 559.607114001101),
	('2017', '1.0', 2016, 'T6 Public', 'Dsl', 33367.0602219691),
	('2017', '1.0', 2016, 'T6 CAIRP Small', 'Dsl', 2065.65229307281),
	('2017', '1.0', 2016, 'T6 CAIRP Heavy', 'Dsl', 14876.9561020308),
	('2017', '1.0', 2016, 'T6 Instate Construction Small', 'Dsl', 124988.349492329),
	('2017', '1.0', 2016, 'T6 Instate Construction Heavy', 'Dsl', 47788.0099891241),
	('2017', '1.0', 2016, 'T6 Instate Small', 'Dsl', 452331.172016019),
	('2017', '1.0', 2016, 'T6 Instate Heavy', 'Dsl', 293818.225509874),
	('2017', '1.0', 2016, 'T6 OOS Small', 'Dsl', 1185.56255245499),
	('2017', '1.0', 2016, 'T6 OOS Heavy', 'Dsl', 8528.12185748256),
	('2017', '1.0', 2016, 'T6 Utility', 'Dsl', 5069.7577184693),
	('2017', '1.0', 2016, 'T7 Ag', 'Dsl', 262.858344622062),
	('2017', '1.0', 2016, 'T7 Public', 'Dsl', 29921.4574745731),
	('2017', '1.0', 2016, 'PTO', 'Dsl', 25506.3955732488),
	('2017', '1.0', 2016, 'T7 CAIRP', 'Dsl', 294736.61085236),
	('2017', '1.0', 2016, 'T7 CAIRP Construction', 'Dsl', 34326.542698199),
	('2017', '1.0', 2016, 'T7 Utility', 'Dsl', 2444.83130228542),
	('2017', '1.0', 2016, 'T7 NNOOS', 'Dsl', 359306.371900981),
	('2017', '1.0', 2016, 'T7 NOOS', 'Dsl', 115801.018654978),
	('2017', '1.0', 2016, 'T7 Other Port', 'Dsl', 71196.5119798331),
	('2017', '1.0', 2016, 'T7 POLA', 'Dsl', 22441.2991909231),
	('2017', '1.0', 2016, 'T7 Single', 'Dsl', 128455.306412905),
	('2017', '1.0', 2016, 'T7 Single Construction', 'Dsl', 85157.8387432246),
	('2017', '1.0', 2016, 'T7 Tractor', 'Dsl', 419463.136490063),
	('2017', '1.0', 2016, 'T7 Tractor Construction', 'Dsl', 70247.7195973639),
	('2017', '1.0', 2016, 'T7 SWCV', 'Dsl', 36561.7114786158),
	('2017', '1.0', 2016, 'LDT1', 'Elec', 5773.54682429123),
	('2017', '1.0', 2016, 'LDT2', 'Elec', 14482.594590844),
	('2017', '1.0', 2016, 'MDV', 'Elec', 386.10703857041),
	('2017', '1.0', 2016, 'T7 SWCV', 'NG', 16115.4159600178),
	('2017', '1.0', 2016, 'UBUS', 'Gas', 31690.7148870049),
	('2017', '1.0', 2016, 'SBUS', 'Gas', 5717.64807449752),
	('2017', '1.0', 2016, 'OBUS', 'Gas', 77473.3059112272),
	('2017', '1.0', 2016, 'UBUS', 'Dsl', 2628.07967339449),
	('2017', '1.0', 2016, 'SBUS', 'Dsl', 72155.0854074023),
	('2017', '1.0', 2016, 'Motor Coach', 'Dsl', 21564.2009016665),
	('2017', '1.0', 2016, 'All Other Buses', 'Dsl', 30599.8352837585),
	('2017', '1.0', 2016, 'UBUS', 'NG', 88329.3729268768),
	('2017', '1.0', 2016, 'MCY', 'Gas', 711796.610854376),
	('2017', '1.0', 2016, 'MH', 'Gas', 123356.240025702),
	('2017', '1.0', 2016, 'MH', 'Dsl', 37537.3146933627),
	('2017', '1.0', 2017, 'LDA', 'Gas', 50899724.366),
	('2017', '1.0', 2017, 'LDA', 'Dsl', 541136.179142472),
	('2017', '1.0', 2017, 'LDA', 'Elec', 486518.39726044),
	('2017', '1.0', 2017, 'LDT1', 'Gas', 5884822.50141784),
	('2017', '1.0', 2017, 'LDT2', 'Gas', 18916837.9780969),
	('2017', '1.0', 2017, 'MDV', 'Gas', 12349369.400803),
	('2017', '1.0', 2017, 'LHD1', 'Gas', 1420800.38253579),
	('2017', '1.0', 2017, 'LHD2', 'Gas', 194118.193753107),
	('2017', '1.0', 2017, 'T6TS', 'Gas', 180312.812320684),
	('2017', '1.0', 2017, 'T7IS', 'Gas', 1923.14083951081),
	('2017', '1.0', 2017, 'LDT1', 'Dsl', 3353.58174098353),
	('2017', '1.0', 2017, 'LDT2', 'Dsl', 85720.3348349701),
	('2017', '1.0', 2017, 'MDV', 'Dsl', 242858.423588224),
	('2017', '1.0', 2017, 'LHD1', 'Dsl', 1126694.41367438),
	('2017', '1.0', 2017, 'LHD2', 'Dsl', 373551.206559113),
	('2017', '1.0', 2017, 'T6 Ag', 'Dsl', 523.09293332517),
	('2017', '1.0', 2017, 'T6 Public', 'Dsl', 35021.1797809767),
	('2017', '1.0', 2017, 'T6 CAIRP Small', 'Dsl', 2133.75689162611),
	('2017', '1.0', 2017, 'T6 CAIRP Heavy', 'Dsl', 15293.912316525),
	('2017', '1.0', 2017, 'T6 Instate Construction Small', 'Dsl', 122787.975800156),
	('2017', '1.0', 2017, 'T6 Instate Construction Heavy', 'Dsl', 46946.7197376048),
	('2017', '1.0', 2017, 'T6 Instate Small', 'Dsl', 468567.091192507),
	('2017', '1.0', 2017, 'T6 Instate Heavy', 'Dsl', 312511.172305169),
	('2017', '1.0', 2017, 'T6 OOS Small', 'Dsl', 1225.78057336279),
	('2017', '1.0', 2017, 'T6 OOS Heavy', 'Dsl', 8775.14434625851),
	('2017', '1.0', 2017, 'T6 Utility', 'Dsl', 5114.92010770081),
	('2017', '1.0', 2017, 'T7 Ag', 'Dsl', 264.965848660888),
	('2017', '1.0', 2017, 'T7 Public', 'Dsl', 29567.0345223977),
	('2017', '1.0', 2017, 'PTO', 'Dsl', 25867.0991881205),
	('2017', '1.0', 2017, 'T7 CAIRP', 'Dsl', 303527.38435549),
	('2017', '1.0', 2017, 'T7 CAIRP Construction', 'Dsl', 33722.2366024455),
	('2017', '1.0', 2017, 'T7 Utility', 'Dsl', 2466.28254040991),
	('2017', '1.0', 2017, 'T7 NNOOS', 'Dsl', 370024.429654376),
	('2017', '1.0', 2017, 'T7 NOOS', 'Dsl', 119253.678452999),
	('2017', '1.0', 2017, 'T7 Other Port', 'Dsl', 74100.8281060041),
	('2017', '1.0', 2017, 'T7 POLA', 'Dsl', 23692.8960674653),
	('2017', '1.0', 2017, 'T7 Single', 'Dsl', 130271.881916077),
	('2017', '1.0', 2017, 'T7 Single Construction', 'Dsl', 83658.6664698566),
	('2017', '1.0', 2017, 'T7 Tractor', 'Dsl', 433900.351068857),
	('2017', '1.0', 2017, 'T7 Tractor Construction', 'Dsl', 69011.0344601894),
	('2017', '1.0', 2017, 'T7 SWCV', 'Dsl', 33452.5474042461),
	('2017', '1.0', 2017, 'LDT1', 'Elec', 6684.38439483301),
	('2017', '1.0', 2017, 'LDT2', 'Elec', 31842.7662355372),
	('2017', '1.0', 2017, 'MDV', 'Elec', 2790.82483786815),
	('2017', '1.0', 2017, 'T7 SWCV', 'NG', 21758.3517885213),
	('2017', '1.0', 2017, 'UBUS', 'Gas', 33542.6433088721),
	('2017', '1.0', 2017, 'SBUS', 'Gas', 6918.83188893948),
	('2017', '1.0', 2017, 'OBUS', 'Gas', 74839.4518220545),
	('2017', '1.0', 2017, 'UBUS', 'Dsl', 2628.07967339449),
	('2017', '1.0', 2017, 'SBUS', 'Dsl', 74496.3942807359),
	('2017', '1.0', 2017, 'Motor Coach', 'Dsl', 22206.4374011746),
	('2017', '1.0', 2017, 'All Other Buses', 'Dsl', 29749.578248778),
	('2017', '1.0', 2017, 'UBUS', 'NG', 93644.7055803585),
	('2017', '1.0', 2017, 'MCY', 'Gas', 706180.413376895),
	('2017', '1.0', 2017, 'MH', 'Gas', 117863.762488051),
	('2017', '1.0', 2017, 'MH', 'Dsl', 37254.4120677887),
	('2017', '1.0', 2020, 'LDA', 'Gas', 53431842.7047542),
	('2017', '1.0', 2020, 'LDA', 'Dsl', 614670.224562255),
	('2017', '1.0', 2020, 'LDA', 'Elec', 849126.679330846),
	('2017', '1.0', 2020, 'LDT1', 'Gas', 5889125.74236069),
	('2017', '1.0', 2020, 'LDT2', 'Gas', 18096266.6766263),
	('2017', '1.0', 2020, 'MDV', 'Gas', 11798102.2736309),
	('2017', '1.0', 2020, 'LHD1', 'Gas', 1308635.80955139),
	('2017', '1.0', 2020, 'LHD2', 'Gas', 195409.439532664),
	('2017', '1.0', 2020, 'T6TS', 'Gas', 195204.533761061),
	('2017', '1.0', 2020, 'T7IS', 'Gas', 1996.63450477858),
	('2017', '1.0', 2020, 'LDT1', 'Dsl', 2463.95224328166),
	('2017', '1.0', 2020, 'LDT2', 'Dsl', 112909.653057369),
	('2017', '1.0', 2020, 'MDV', 'Dsl', 290576.1883728),
	('2017', '1.0', 2020, 'LHD1', 'Dsl', 1175504.1699384),
	('2017', '1.0', 2020, 'LHD2', 'Dsl', 410789.023733899),
	('2017', '1.0', 2020, 'T6 Ag', 'Dsl', 424.234051935724),
	('2017', '1.0', 2020, 'T6 Public', 'Dsl', 36936.8571085524),
	('2017', '1.0', 2020, 'T6 CAIRP Small', 'Dsl', 2327.48268901525),
	('2017', '1.0', 2020, 'T6 CAIRP Heavy', 'Dsl', 16380.1229068154),
	('2017', '1.0', 2020, 'T6 Instate Construction Small', 'Dsl', 112870.365151687),
	('2017', '1.0', 2020, 'T6 Instate Construction Heavy', 'Dsl', 43154.8233035587),
	('2017', '1.0', 2020, 'T6 Instate Small', 'Dsl', 523210.013076852),
	('2017', '1.0', 2020, 'T6 Instate Heavy', 'Dsl', 370814.214271919),
	('2017', '1.0', 2020, 'T6 OOS Small', 'Dsl', 1341.42863025334),
	('2017', '1.0', 2020, 'T6 OOS Heavy', 'Dsl', 9428.7527303042),
	('2017', '1.0', 2020, 'T6 Utility', 'Dsl', 5249.75385797133),
	('2017', '1.0', 2020, 'T7 Ag', 'Dsl', 255.784238972595),
	('2017', '1.0', 2020, 'T7 Public', 'Dsl', 29982.851438062),
	('2017', '1.0', 2020, 'PTO', 'Dsl', 26998.8217639999),
	('2017', '1.0', 2020, 'T7 CAIRP', 'Dsl', 327143.264244189),
	('2017', '1.0', 2020, 'T7 CAIRP Construction', 'Dsl', 30998.4844545731),
	('2017', '1.0', 2020, 'T7 Utility', 'Dsl', 2530.33484103627),
	('2017', '1.0', 2020, 'T7 NNOOS', 'Dsl', 398811.868652989),
	('2017', '1.0', 2020, 'T7 NOOS', 'Dsl', 128530.422319502),
	('2017', '1.0', 2020, 'T7 Other Port', 'Dsl', 82672.7000207911),
	('2017', '1.0', 2020, 'T7 POLA', 'Dsl', 27497.3965881508),
	('2017', '1.0', 2020, 'T7 Single', 'Dsl', 135971.463020804),
	('2017', '1.0', 2020, 'T7 Single Construction', 'Dsl', 76901.5383715117),
	('2017', '1.0', 2020, 'T7 Tractor', 'Dsl', 473298.431008303),
	('2017', '1.0', 2020, 'T7 Tractor Construction', 'Dsl', 63436.9986821411),
	('2017', '1.0', 2020, 'T7 SWCV', 'Dsl', 27968.6967694131),
	('2017', '1.0', 2020, 'LDT1', 'Elec', 17133.5152237821),
	('2017', '1.0', 2020, 'LDT2', 'Elec', 78796.1243362887),
	('2017', '1.0', 2020, 'MDV', 'Elec', 26122.3279828246),
	('2017', '1.0', 2020, 'T7 SWCV', 'NG', 30816.1401483369),
	('2017', '1.0', 2020, 'UBUS', 'Gas', 39098.4285744738),
	('2017', '1.0', 2020, 'SBUS', 'Gas', 11222.0067172827),
	('2017', '1.0', 2020, 'OBUS', 'Gas', 67147.0726676893),
	('2017', '1.0', 2020, 'UBUS', 'Dsl', 2628.07967339449),
	('2017', '1.0', 2020, 'SBUS', 'Dsl', 75332.859656543),
	('2017', '1.0', 2020, 'Motor Coach', 'Dsl', 23946.7201441174),
	('2017', '1.0', 2020, 'All Other Buses', 'Dsl', 29485.2719768511),
	('2017', '1.0', 2020, 'UBUS', 'NG', 109590.703540804),
	('2017', '1.0', 2020, 'MCY', 'Gas', 659798.774723662),
	('2017', '1.0', 2020, 'MH', 'Gas', 100810.531208985),
	('2017', '1.0', 2020, 'MH', 'Dsl', 35416.528826041),
	('2017', '1.0', 2025, 'LDA', 'Gas', 56754206.9015478),
	('2017', '1.0', 2025, 'LDA', 'Dsl', 690321.668204181),
	('2017', '1.0', 2025, 'LDA', 'Elec', 2068368.30199744),
	('2017', '1.0', 2025, 'LDT1', 'Gas', 5960108.8626605),
	('2017', '1.0', 2025, 'LDT2', 'Gas', 17314400.1249172),
	('2017', '1.0', 2025, 'MDV', 'Gas', 11174917.0873842),
	('2017', '1.0', 2025, 'LHD1', 'Gas', 1211073.79901396),
	('2017', '1.0', 2025, 'LHD2', 'Gas', 197013.847649085),
	('2017', '1.0', 2025, 'T6TS', 'Gas', 223952.112193934),
	('2017', '1.0', 2025, 'T7IS', 'Gas', 2160.8119390204),
	('2017', '1.0', 2025, 'LDT1', 'Dsl', 1609.12394534806),
	('2017', '1.0', 2025, 'LDT2', 'Dsl', 145971.130114037),
	('2017', '1.0', 2025, 'MDV', 'Dsl', 345420.9236397),
	('2017', '1.0', 2025, 'LHD1', 'Dsl', 1237477.07784608),
	('2017', '1.0', 2025, 'LHD2', 'Dsl', 458167.032696793),
	('2017', '1.0', 2025, 'T6 Ag', 'Dsl', 272.16043734417),
	('2017', '1.0', 2025, 'T6 Public', 'Dsl', 39128.8986523938),
	('2017', '1.0', 2025, 'T6 CAIRP Small', 'Dsl', 2571.41313417984),
	('2017', '1.0', 2025, 'T6 CAIRP Heavy', 'Dsl', 17767.1549949934),
	('2017', '1.0', 2025, 'T6 Instate Construction Small', 'Dsl', 120106.958465235),
	('2017', '1.0', 2025, 'T6 Instate Construction Heavy', 'Dsl', 45921.6603324473),
	('2017', '1.0', 2025, 'T6 Instate Small', 'Dsl', 605558.915580199),
	('2017', '1.0', 2025, 'T6 Instate Heavy', 'Dsl', 442272.342835426),
	('2017', '1.0', 2025, 'T6 OOS Small', 'Dsl', 1486.79735617234),
	('2017', '1.0', 2025, 'T6 OOS Heavy', 'Dsl', 10259.7405449726),
	('2017', '1.0', 2025, 'T6 Utility', 'Dsl', 5479.40256641492),
	('2017', '1.0', 2025, 'T7 Ag', 'Dsl', 174.620962500733),
	('2017', '1.0', 2025, 'T7 Public', 'Dsl', 30240.3558580549),
	('2017', '1.0', 2025, 'PTO', 'Dsl', 28708.8394204249),
	('2017', '1.0', 2025, 'T7 CAIRP', 'Dsl', 357088.077754161),
	('2017', '1.0', 2025, 'T7 CAIRP Construction', 'Dsl', 32985.9275272752),
	('2017', '1.0', 2025, 'T7 Utility', 'Dsl', 2640.66666569444),
	('2017', '1.0', 2025, 'T7 NNOOS', 'Dsl', 435295.375597353),
	('2017', '1.0', 2025, 'T7 NOOS', 'Dsl', 140297.531363531),
	('2017', '1.0', 2025, 'T7 Other Port', 'Dsl', 99233.6503107908),
	('2017', '1.0', 2025, 'T7 POLA', 'Dsl', 36619.6301338928),
	('2017', '1.0', 2025, 'T7 Single', 'Dsl', 144583.453742768),
	('2017', '1.0', 2025, 'T7 Single Construction', 'Dsl', 81832.0190839017),
	('2017', '1.0', 2025, 'T7 Tractor', 'Dsl', 527711.424793603),
	('2017', '1.0', 2025, 'T7 Tractor Construction', 'Dsl', 67504.2111863071),
	('2017', '1.0', 2025, 'T7 SWCV', 'Dsl', 18264.0773037026),
	('2017', '1.0', 2025, 'LDT1', 'Elec', 96350.2474716881),
	('2017', '1.0', 2025, 'LDT2', 'Elec', 251820.347668728),
	('2017', '1.0', 2025, 'MDV', 'Elec', 162831.984149394),
	('2017', '1.0', 2025, 'T7 SWCV', 'NG', 46869.1542130905),
	('2017', '1.0', 2025, 'UBUS', 'Gas', 46393.92130127),
	('2017', '1.0', 2025, 'SBUS', 'Gas', 17301.8373990139),
	('2017', '1.0', 2025, 'OBUS', 'Gas', 60038.836343938),
	('2017', '1.0', 2025, 'UBUS', 'Dsl', 0),
	('2017', '1.0', 2025, 'SBUS', 'Dsl', 73642.2893497003),
	('2017', '1.0', 2025, 'Motor Coach', 'Dsl', 26159.2257068172),
	('2017', '1.0', 2025, 'All Other Buses', 'Dsl', 30342.6791751076),
	('2017', '1.0', 2025, 'UBUS', 'NG', 133158.021608133),
	('2017', '1.0', 2025, 'MCY', 'Gas', 619719.788451345),
	('2017', '1.0', 2025, 'MH', 'Gas', 82862.9329735183),
	('2017', '1.0', 2025, 'MH', 'Dsl', 33693.7874228924),
	('2017', '1.0', 2030, 'LDA', 'Gas', 58643392.1213564),
	('2017', '1.0', 2030, 'LDA', 'Dsl', 723194.982733142),
	('2017', '1.0', 2030, 'LDA', 'Elec', 3120492.41662785),
	('2017', '1.0', 2030, 'LDT1', 'Gas', 6042844.30832609),
	('2017', '1.0', 2030, 'LDT2', 'Gas', 17103403.9153146),
	('2017', '1.0', 2030, 'MDV', 'Gas', 10944818.8431182),
	('2017', '1.0', 2030, 'LHD1', 'Gas', 1179447.6133155),
	('2017', '1.0', 2030, 'LHD2', 'Gas', 199832.804855525),
	('2017', '1.0', 2030, 'T6TS', 'Gas', 248004.21090808),
	('2017', '1.0', 2030, 'T7IS', 'Gas', 2341.16314787932),
	('2017', '1.0', 2030, 'LDT1', 'Dsl', 852.713045268351),
	('2017', '1.0', 2030, 'LDT2', 'Dsl', 163906.531339999),
	('2017', '1.0', 2030, 'MDV', 'Dsl', 374468.360911417),
	('2017', '1.0', 2030, 'LHD1', 'Dsl', 1287014.65954094),
	('2017', '1.0', 2030, 'LHD2', 'Dsl', 492672.229321154),
	('2017', '1.0', 2030, 'T6 Ag', 'Dsl', 156.420566685599),
	('2017', '1.0', 2030, 'T6 Public', 'Dsl', 40680.5056984451),
	('2017', '1.0', 2030, 'T6 CAIRP Small', 'Dsl', 2765.01328235627),
	('2017', '1.0', 2030, 'T6 CAIRP Heavy', 'Dsl', 18984.2930019115),
	('2017', '1.0', 2030, 'T6 Instate Construction Small', 'Dsl', 125490.194228726),
	('2017', '1.0', 2030, 'T6 Instate Construction Heavy', 'Dsl', 47979.8851628765),
	('2017', '1.0', 2030, 'T6 Instate Small', 'Dsl', 671076.177310353),
	('2017', '1.0', 2030, 'T6 Instate Heavy', 'Dsl', 492941.521251334),
	('2017', '1.0', 2030, 'T6 OOS Small', 'Dsl', 1600.44665096334),
	('2017', '1.0', 2030, 'T6 OOS Heavy', 'Dsl', 10973.7877353531),
	('2017', '1.0', 2030, 'T6 Utility', 'Dsl', 5702.55499318767),
	('2017', '1.0', 2030, 'T7 Ag', 'Dsl', 87.2208335601758),
	('2017', '1.0', 2030, 'T7 Public', 'Dsl', 29864.5216092669),
	('2017', '1.0', 2030, 'PTO', 'Dsl', 30276.4879875933),
	('2017', '1.0', 2030, 'T7 CAIRP', 'Dsl', 382327.926359806),
	('2017', '1.0', 2030, 'T7 CAIRP Construction', 'Dsl', 34464.3669237046),
	('2017', '1.0', 2030, 'T7 Utility', 'Dsl', 2749.48370842396),
	('2017', '1.0', 2030, 'T7 NNOOS', 'Dsl', 466045.938923866),
	('2017', '1.0', 2030, 'T7 NOOS', 'Dsl', 150216.023627893),
	('2017', '1.0', 2030, 'T7 Other Port', 'Dsl', 109479.209953526),
	('2017', '1.0', 2030, 'T7 POLA', 'Dsl', 47983.7480244276),
	('2017', '1.0', 2030, 'T7 Single', 'Dsl', 152478.445274012),
	('2017', '1.0', 2030, 'T7 Single Construction', 'Dsl', 85499.7552966537),
	('2017', '1.0', 2030, 'T7 Tractor', 'Dsl', 574170.152300117),
	('2017', '1.0', 2030, 'T7 Tractor Construction', 'Dsl', 70529.7706513304),
	('2017', '1.0', 2030, 'T7 SWCV', 'Dsl', 10750.3611641086),
	('2017', '1.0', 2030, 'LDT1', 'Elec', 167796.951045855),
	('2017', '1.0', 2030, 'LDT2', 'Elec', 411255.710867086),
	('2017', '1.0', 2030, 'MDV', 'Elec', 286401.030225361),
	('2017', '1.0', 2030, 'T7 SWCV', 'NG', 60751.1249491543),
	('2017', '1.0', 2030, 'UBUS', 'Gas', 53689.4140280663),
	('2017', '1.0', 2030, 'SBUS', 'Gas', 23832.0248782068),
	('2017', '1.0', 2030, 'OBUS', 'Gas', 57080.1686378322),
	('2017', '1.0', 2030, 'UBUS', 'Dsl', 0),
	('2017', '1.0', 2030, 'SBUS', 'Dsl', 66263.7689705135),
	('2017', '1.0', 2030, 'Motor Coach', 'Dsl', 28019.6447021765),
	('2017', '1.0', 2030, 'All Other Buses', 'Dsl', 30731.2676688904),
	('2017', '1.0', 2030, 'UBUS', 'NG', 154097.260002067),
	('2017', '1.0', 2030, 'MCY', 'Gas', 602831.193805678),
	('2017', '1.0', 2030, 'MH', 'Gas', 72727.8681752379),
	('2017', '1.0', 2030, 'MH', 'Dsl', 32498.7476495335),
	('2017', '1.0', 2035, 'LDA', 'Gas', 60161270.9992843),
	('2017', '1.0', 2035, 'LDA', 'Dsl', 746246.243227145),
	('2017', '1.0', 2035, 'LDA', 'Elec', 3780117.91100395),
	('2017', '1.0', 2035, 'LDT1', 'Gas', 6159579.6283566),
	('2017', '1.0', 2035, 'LDT2', 'Gas', 17230527.9954298),
	('2017', '1.0', 2035, 'MDV', 'Gas', 11020863.8098805),
	('2017', '1.0', 2035, 'LHD1', 'Gas', 1185631.46906399),
	('2017', '1.0', 2035, 'LHD2', 'Gas', 204627.935786422),
	('2017', '1.0', 2035, 'T6TS', 'Gas', 264563.405115612),
	('2017', '1.0', 2035, 'T7IS', 'Gas', 2479.24414393628),
	('2017', '1.0', 2035, 'LDT1', 'Dsl', 848.63463804637),
	('2017', '1.0', 2035, 'LDT2', 'Dsl', 173166.724563207),
	('2017', '1.0', 2035, 'MDV', 'Dsl', 392271.792422165),
	('2017', '1.0', 2035, 'LHD1', 'Dsl', 1342853.6902361),
	('2017', '1.0', 2035, 'LHD2', 'Dsl', 522173.877513016),
	('2017', '1.0', 2035, 'T6 Ag', 'Dsl', 69.3094972367595),
	('2017', '1.0', 2035, 'T6 Public', 'Dsl', 41983.1954252846),
	('2017', '1.0', 2035, 'T6 CAIRP Small', 'Dsl', 2928.19211582268),
	('2017', '1.0', 2035, 'T6 CAIRP Heavy', 'Dsl', 20073.7662850727),
	('2017', '1.0', 2035, 'T6 Instate Construction Small', 'Dsl', 149111.743895372),
	('2017', '1.0', 2035, 'T6 Instate Construction Heavy', 'Dsl', 57011.3417427362),
	('2017', '1.0', 2035, 'T6 Instate Small', 'Dsl', 719943.455335274),
	('2017', '1.0', 2035, 'T6 Instate Heavy', 'Dsl', 535458.213323117),
	('2017', '1.0', 2035, 'T6 OOS Small', 'Dsl', 1695.56335275692),
	('2017', '1.0', 2035, 'T6 OOS Heavy', 'Dsl', 11606.5142794177),
	('2017', '1.0', 2035, 'T6 Utility', 'Dsl', 5918.19966658331),
	('2017', '1.0', 2035, 'T7 Ag', 'Dsl', 46.209264865929),
	('2017', '1.0', 2035, 'T7 Public', 'Dsl', 29809.4465361707),
	('2017', '1.0', 2035, 'PTO', 'Dsl', 31817.7666622905),
	('2017', '1.0', 2035, 'T7 CAIRP', 'Dsl', 404467.522720991),
	('2017', '1.0', 2035, 'T7 CAIRP Construction', 'Dsl', 40951.7420176952),
	('2017', '1.0', 2035, 'T7 Utility', 'Dsl', 2855.00952666663),
	('2017', '1.0', 2035, 'T7 NNOOS', 'Dsl', 493028.202841818),
	('2017', '1.0', 2035, 'T7 NOOS', 'Dsl', 158915.179612541),
	('2017', '1.0', 2035, 'T7 Other Port', 'Dsl', 118283.69135942),
	('2017', '1.0', 2035, 'T7 POLA', 'Dsl', 57603.9390893006),
	('2017', '1.0', 2035, 'T7 Single', 'Dsl', 160240.632755867),
	('2017', '1.0', 2035, 'T7 Single Construction', 'Dsl', 101593.739680052),
	('2017', '1.0', 2035, 'T7 Tractor', 'Dsl', 613024.37368946),
	('2017', '1.0', 2035, 'T7 Tractor Construction', 'Dsl', 83805.8908400815),
	('2017', '1.0', 2035, 'T7 SWCV', 'Dsl', 6450.1427322381),
	('2017', '1.0', 2035, 'LDT1', 'Elec', 216578.737560418),
	('2017', '1.0', 2035, 'LDT2', 'Elec', 515173.83879364),
	('2017', '1.0', 2035, 'MDV', 'Elec', 366845.339167316),
	('2017', '1.0', 2035, 'T7 SWCV', 'NG', 71069.7725130796),
	('2017', '1.0', 2035, 'UBUS', 'Gas', 60984.9067548628),
	('2017', '1.0', 2035, 'SBUS', 'Gas', 30389.2621681957),
	('2017', '1.0', 2035, 'OBUS', 'Gas', 56721.6927859057),
	('2017', '1.0', 2035, 'UBUS', 'Dsl', 0),
	('2017', '1.0', 2035, 'SBUS', 'Dsl', 59746.6864323547),
	('2017', '1.0', 2035, 'Motor Coach', 'Dsl', 29648.6289349906),
	('2017', '1.0', 2035, 'All Other Buses', 'Dsl', 30489.0980676738),
	('2017', '1.0', 2035, 'UBUS', 'NG', 175036.498396002),
	('2017', '1.0', 2035, 'MCY', 'Gas', 602328.120365036),
	('2017', '1.0', 2035, 'MH', 'Gas', 68440.9911386433),
	('2017', '1.0', 2035, 'MH', 'Dsl', 31748.9324803444),
	('2017', '1.0', 2040, 'LDA', 'Gas', 61543177.3378523),
	('2017', '1.0', 2040, 'LDA', 'Dsl', 766461.550234153),
	('2017', '1.0', 2040, 'LDA', 'Elec', 4145268.16133039),
	('2017', '1.0', 2040, 'LDT1', 'Gas', 6287838.96672777),
	('2017', '1.0', 2040, 'LDT2', 'Gas', 17521582.3560852),
	('2017', '1.0', 2040, 'MDV', 'Gas', 11214088.7574463),
	('2017', '1.0', 2040, 'LHD1', 'Gas', 1207250.21990281),
	('2017', '1.0', 2040, 'LHD2', 'Gas', 210440.490735904),
	('2017', '1.0', 2040, 'T6TS', 'Gas', 275501.496070627),
	('2017', '1.0', 2040, 'T7IS', 'Gas', 2569.18042374718),
	('2017', '1.0', 2040, 'LDT1', 'Dsl', 874.758179080279),
	('2017', '1.0', 2040, 'LDT2', 'Dsl', 179477.843684848),
	('2017', '1.0', 2040, 'MDV', 'Dsl', 404906.895340399),
	('2017', '1.0', 2040, 'LHD1', 'Dsl', 1391315.63021982),
	('2017', '1.0', 2040, 'LHD2', 'Dsl', 545475.909206923),
	('2017', '1.0', 2040, 'T6 Ag', 'Dsl', 30.019746061821),
	('2017', '1.0', 2040, 'T6 Public', 'Dsl', 43149.3797397051),
	('2017', '1.0', 2040, 'T6 CAIRP Small', 'Dsl', 3089.23991493893),
	('2017', '1.0', 2040, 'T6 CAIRP Heavy', 'Dsl', 21169.1564682858),
	('2017', '1.0', 2040, 'T6 Instate Construction Small', 'Dsl', 175534.584838551),
	('2017', '1.0', 2040, 'T6 Instate Construction Heavy', 'Dsl', 67113.8432323744),
	('2017', '1.0', 2040, 'T6 Instate Small', 'Dsl', 764418.513136265),
	('2017', '1.0', 2040, 'T6 Instate Heavy', 'Dsl', 576040.840673966),
	('2017', '1.0', 2040, 'T6 OOS Small', 'Dsl', 1789.040348777),
	('2017', '1.0', 2040, 'T6 OOS Heavy', 'Dsl', 12240.917859118),
	('2017', '1.0', 2040, 'T6 Utility', 'Dsl', 6110.536635433),
	('2017', '1.0', 2040, 'T7 Ag', 'Dsl', 22.8221882765871),
	('2017', '1.0', 2040, 'T7 Public', 'Dsl', 29926.3033516476),
	('2017', '1.0', 2040, 'PTO', 'Dsl', 33563.3411895505),
	('2017', '1.0', 2040, 'T7 CAIRP', 'Dsl', 426604.524922029),
	('2017', '1.0', 2040, 'T7 CAIRP Construction', 'Dsl', 48208.4565957158),
	('2017', '1.0', 2040, 'T7 Utility', 'Dsl', 2948.80402074702),
	('2017', '1.0', 2040, 'T7 NNOOS', 'Dsl', 520010.52973588),
	('2017', '1.0', 2040, 'T7 NOOS', 'Dsl', 167612.986430888),
	('2017', '1.0', 2040, 'T7 Other Port', 'Dsl', 127086.890369923),
	('2017', '1.0', 2040, 'T7 POLA', 'Dsl', 68107.7113557936),
	('2017', '1.0', 2040, 'T7 Single', 'Dsl', 169031.694986585),
	('2017', '1.0', 2040, 'T7 Single Construction', 'Dsl', 119596.313818493),
	('2017', '1.0', 2040, 'T7 Tractor', 'Dsl', 649641.621360541),
	('2017', '1.0', 2040, 'T7 Tractor Construction', 'Dsl', 98656.4295429391),
	('2017', '1.0', 2040, 'T7 SWCV', 'Dsl', 4006.10753294759),
	('2017', '1.0', 2040, 'LDT1', 'Elec', 247505.18821317),
	('2017', '1.0', 2040, 'LDT2', 'Elec', 573635.004506412),
	('2017', '1.0', 2040, 'MDV', 'Elec', 414764.636595657),
	('2017', '1.0', 2040, 'T7 SWCV', 'NG', 78081.2098427947),
	('2017', '1.0', 2040, 'UBUS', 'Gas', 63789.7310726501),
	('2017', '1.0', 2040, 'SBUS', 'Gas', 37290.4363446339),
	('2017', '1.0', 2040, 'OBUS', 'Gas', 57563.9802496635),
	('2017', '1.0', 2040, 'UBUS', 'Dsl', 0),
	('2017', '1.0', 2040, 'SBUS', 'Dsl', 60155.7510031809),
	('2017', '1.0', 2040, 'Motor Coach', 'Dsl', 31276.134226009),
	('2017', '1.0', 2040, 'All Other Buses', 'Dsl', 30768.0780571775),
	('2017', '1.0', 2040, 'UBUS', 'NG', 183086.795647006),
	('2017', '1.0', 2040, 'MCY', 'Gas', 610227.246926743),
	('2017', '1.0', 2040, 'MH', 'Gas', 67621.6934916037),
	('2017', '1.0', 2040, 'MH', 'Dsl', 31234.948656354),
	('2017', '1.0', 2045, 'LDA', 'Gas', 62881551.0256916),
	('2017', '1.0', 2045, 'LDA', 'Dsl', 784560.737056601),
	('2017', '1.0', 2045, 'LDA', 'Elec', 4339163.9196289),
	('2017', '1.0', 2045, 'LDT1', 'Gas', 6419865.60673603),
	('2017', '1.0', 2045, 'LDT2', 'Gas', 17855438.3426912),
	('2017', '1.0', 2045, 'MDV', 'Gas', 11434156.1638779),
	('2017', '1.0', 2045, 'LHD1', 'Gas', 1229700.67118615),
	('2017', '1.0', 2045, 'LHD2', 'Gas', 216195.266558271),
	('2017', '1.0', 2045, 'T6TS', 'Gas', 283358.501354427),
	('2017', '1.0', 2045, 'T7IS', 'Gas', 2636.39245650845),
	('2017', '1.0', 2045, 'LDT1', 'Dsl', 897.144523835352),
	('2017', '1.0', 2045, 'LDT2', 'Dsl', 184658.25771467),
	('2017', '1.0', 2045, 'MDV', 'Dsl', 415507.349464255),
	('2017', '1.0', 2045, 'LHD1', 'Dsl', 1433414.17265227),
	('2017', '1.0', 2045, 'LHD2', 'Dsl', 565308.981154924),
	('2017', '1.0', 2045, 'T6 Ag', 'Dsl', 7.60180407380658),
	('2017', '1.0', 2045, 'T6 Public', 'Dsl', 44212.6225061575),
	('2017', '1.0', 2045, 'T6 CAIRP Small', 'Dsl', 3249.76978455022),
	('2017', '1.0', 2045, 'T6 CAIRP Heavy', 'Dsl', 22266.7342619405),
	('2017', '1.0', 2045, 'T6 Instate Construction Small', 'Dsl', 214907.592179004),
	('2017', '1.0', 2045, 'T6 Instate Construction Heavy', 'Dsl', 82167.7076583777),
	('2017', '1.0', 2045, 'T6 Instate Small', 'Dsl', 806353.021767028),
	('2017', '1.0', 2045, 'T6 Instate Heavy', 'Dsl', 612576.236703815),
	('2017', '1.0', 2045, 'T6 OOS Small', 'Dsl', 1882.23627389276),
	('2017', '1.0', 2045, 'T6 OOS Heavy', 'Dsl', 12875.865878857),
	('2017', '1.0', 2045, 'T6 Utility', 'Dsl', 6284.01168869477),
	('2017', '1.0', 2045, 'T7 Ag', 'Dsl', 7.70649998971793),
	('2017', '1.0', 2045, 'T7 Public', 'Dsl', 30331.482641998),
	('2017', '1.0', 2045, 'PTO', 'Dsl', 35324.1439886115),
	('2017', '1.0', 2045, 'T7 CAIRP', 'Dsl', 448740.654316914),
	('2017', '1.0', 2045, 'T7 CAIRP Construction', 'Dsl', 59021.778182233),
	('2017', '1.0', 2045, 'T7 Utility', 'Dsl', 3032.99577051759),
	('2017', '1.0', 2045, 'T7 NNOOS', 'Dsl', 546992.891003678),
	('2017', '1.0', 2045, 'T7 NOOS', 'Dsl', 176310.34015927),
	('2017', '1.0', 2045, 'T7 Other Port', 'Dsl', 135892.275487054),
	('2017', '1.0', 2045, 'T7 POLA', 'Dsl', 77496.262369472),
	('2017', '1.0', 2045, 'T7 Single', 'Dsl', 177899.449837972),
	('2017', '1.0', 2045, 'T7 Single Construction', 'Dsl', 146422.17577725),
	('2017', '1.0', 2045, 'T7 Tractor', 'Dsl', 684598.81745021),
	('2017', '1.0', 2045, 'T7 Tractor Construction', 'Dsl', 120785.403888078),
	('2017', '1.0', 2045, 'T7 SWCV', 'Dsl', 2110.3867227581),
	('2017', '1.0', 2045, 'LDT1', 'Elec', 265968.251266481),
	('2017', '1.0', 2045, 'LDT2', 'Elec', 603789.597641493),
	('2017', '1.0', 2045, 'MDV', 'Elec', 441360.427261975),
	('2017', '1.0', 2045, 'T7 SWCV', 'NG', 83354.8128352638),
	('2017', '1.0', 2045, 'UBUS', 'Gas', 66594.5553904373),
	('2017', '1.0', 2045, 'SBUS', 'Gas', 44037.2715237603),
	('2017', '1.0', 2045, 'OBUS', 'Gas', 58575.2873909166),
	('2017', '1.0', 2045, 'UBUS', 'Dsl', 0),
	('2017', '1.0', 2045, 'SBUS', 'Dsl', 61032.5902338304),
	('2017', '1.0', 2045, 'Motor Coach', 'Dsl', 32900.7262440619),
	('2017', '1.0', 2045, 'All Other Buses', 'Dsl', 31229.8464843433),
	('2017', '1.0', 2045, 'UBUS', 'NG', 191137.092898011),
	('2017', '1.0', 2045, 'MCY', 'Gas', 620483.89319506),
	('2017', '1.0', 2045, 'MH', 'Gas', 68149.8447761729),
	('2017', '1.0', 2045, 'MH', 'Dsl', 30969.5251638768),
	('2017', '1.0', 2050, 'LDA', 'Gas', 64175557.1685459),
	('2017', '1.0', 2050, 'LDA', 'Dsl', 801264.601584109),
	('2017', '1.0', 2050, 'LDA', 'Elec', 4461620.95995062),
	('2017', '1.0', 2050, 'LDT1', 'Gas', 6561852.96937462),
	('2017', '1.0', 2050, 'LDT2', 'Gas', 18197180.7226008),
	('2017', '1.0', 2050, 'MDV', 'Gas', 11639272.1276311),
	('2017', '1.0', 2050, 'LHD1', 'Gas', 1250460.13547759),
	('2017', '1.0', 2050, 'LHD2', 'Gas', 221454.281167033),
	('2017', '1.0', 2050, 'T6TS', 'Gas', 289964.86682496),
	('2017', '1.0', 2050, 'T7IS', 'Gas', 2695.33124543815),
	('2017', '1.0', 2050, 'LDT1', 'Dsl', 919.619814282664),
	('2017', '1.0', 2050, 'LDT2', 'Dsl', 189190.731194145),
	('2017', '1.0', 2050, 'MDV', 'Dsl', 425164.74265219),
	('2017', '1.0', 2050, 'LHD1', 'Dsl', 1469714.02064261),
	('2017', '1.0', 2050, 'LHD2', 'Dsl', 580022.570236855),
	('2017', '1.0', 2050, 'T6 Ag', 'Dsl', 0.649476899484862),
	('2017', '1.0', 2050, 'T6 Public', 'Dsl', 45202.7057666132),
	('2017', '1.0', 2050, 'T6 CAIRP Small', 'Dsl', 3410.14787279998),
	('2017', '1.0', 2050, 'T6 CAIRP Heavy', 'Dsl', 23364.8862579448),
	('2017', '1.0', 2050, 'T6 Instate Construction Small', 'Dsl', 244750.23749481),
	('2017', '1.0', 2050, 'T6 Instate Construction Heavy', 'Dsl', 93577.7361790047),
	('2017', '1.0', 2050, 'T6 Instate Small', 'Dsl', 846932.439856954),
	('2017', '1.0', 2050, 'T6 Instate Heavy', 'Dsl', 646768.938204074),
	('2017', '1.0', 2050, 'T6 OOS Small', 'Dsl', 1975.26980496966),
	('2017', '1.0', 2050, 'T6 OOS Heavy', 'Dsl', 13510.9562469385),
	('2017', '1.0', 2050, 'T6 Utility', 'Dsl', 6439.9366094987),
	('2017', '1.0', 2050, 'T7 Ag', 'Dsl', 1.30550327060958),
	('2017', '1.0', 2050, 'T7 Public', 'Dsl', 30743.1956339982),
	('2017', '1.0', 2050, 'PTO', 'Dsl', 37085.7293434642),
	('2017', '1.0', 2050, 'T7 CAIRP', 'Dsl', 470876.59834834),
	('2017', '1.0', 2050, 'T7 CAIRP Construction', 'Dsl', 67217.7007847881),
	('2017', '1.0', 2050, 'T7 Utility', 'Dsl', 3108.62347273769),
	('2017', '1.0', 2050, 'T7 NNOOS', 'Dsl', 573975.26573398),
	('2017', '1.0', 2050, 'T7 NOOS', 'Dsl', 185007.591947269),
	('2017', '1.0', 2050, 'T7 Other Port', 'Dsl', 144698.299985726),
	('2017', '1.0', 2050, 'T7 POLA', 'Dsl', 87181.3885465312),
	('2017', '1.0', 2050, 'T7 Single', 'Dsl', 186771.145796746),
	('2017', '1.0', 2050, 'T7 Single Construction', 'Dsl', 166754.752275754),
	('2017', '1.0', 2050, 'T7 Tractor', 'Dsl', 718885.458886924),
	('2017', '1.0', 2050, 'T7 Tractor Construction', 'Dsl', 137557.989402674),
	('2017', '1.0', 2050, 'T7 SWCV', 'Dsl', 802.423852352264),
	('2017', '1.0', 2050, 'LDT1', 'Elec', 277356.93303118),
	('2017', '1.0', 2050, 'LDT2', 'Elec', 622618.636386332),
	('2017', '1.0', 2050, 'MDV', 'Elec', 457171.43318052),
	('2017', '1.0', 2050, 'T7 SWCV', 'NG', 87669.1464620094),
	('2017', '1.0', 2050, 'UBUS', 'Gas', 69399.3797082244),
	('2017', '1.0', 2050, 'SBUS', 'Gas', 48034.4063133765),
	('2017', '1.0', 2050, 'OBUS', 'Gas', 59385.7631943616),
	('2017', '1.0', 2050, 'UBUS', 'Dsl', 0),
	('2017', '1.0', 2050, 'SBUS', 'Dsl', 61752.3711758229),
	('2017', '1.0', 2050, 'Motor Coach', 'Dsl', 34523.9488557975),
	('2017', '1.0', 2050, 'All Other Buses', 'Dsl', 31954.7739743902),
	('2017', '1.0', 2050, 'UBUS', 'NG', 199187.390149015),
	('2017', '1.0', 2050, 'MCY', 'Gas', 630197.997825984),
	('2017', '1.0', 2050, 'MH', 'Gas', 69273.2749387299),
	('2017', '1.0', 2050, 'MH', 'Dsl', 31082.999310364)
GO

-- get the emfac vehicle class surrogate key
-- and insert into emfac_default_vmt table
INSERT INTO [emfac].[emfac_default_vmt] 
([emfac_vehicle_class_id], [year], [vmt])
SELECT
	[emfac_vehicle_class_id]
	,[calendar_year] AS [year]
	,[vmt]
FROM
	#tt_emfac_default_vmt
LEFT OUTER JOIN -- if no matches a NULL value will return insert error
	[emfac].[emfac_vehicle_class]
ON
	#tt_emfac_default_vmt.[major_version] = [emfac_vehicle_class].[major_version]
	AND #tt_emfac_default_vmt.[minor_version] = [emfac_vehicle_class].[minor_version]
	AND CONCAT(#tt_emfac_default_vmt.[vehicle_class], ' - ', #tt_emfac_default_vmt.[fuel]) = [emfac_vehicle_class].[emfac_vehicle_class]

-- drop temporary emfac_default_vmt table
DROP TABLE #tt_emfac_default_vmt
GO

-- Add metadata for [emfac].[emfac_default_vmt]
EXECUTE [db_meta].[add_xp] 'emfac.emfac_default_vmt', 'SUBSYSTEM', 'emfac'
EXECUTE [db_meta].[add_xp] 'emfac.emfac_default_vmt', 'MS_Description', 'default emfac run vmt'
GO




-- Create emfac vehicle map reference table
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[emfac].[emfac_vehicle_map]') AND type in (N'U'))
DROP TABLE [emfac].[emfac_vehicle_map]
GO

CREATE TABLE [emfac].[emfac_vehicle_map](
	[emfac_vehicle_map_id] int IDENTITY(1,1) NOT NULL,
	[sandag_vehicle_class_id] tinyint NOT NULL,
	[emfac_vehicle_class_id] smallint NOT NULL,
	CONSTRAINT [pk_emfac_vehicle_map] PRIMARY KEY ([emfac_vehicle_map_id]),	
	CONSTRAINT [ixuq_emfac_vehicle_map] UNIQUE ([sandag_vehicle_class_id],[emfac_vehicle_class_id]) WITH (DATA_COMPRESSION = PAGE),
	CONSTRAINT [fk_emfac_vehicle_map_emfac_vehicle_class] FOREIGN KEY ([emfac_vehicle_class_id]) REFERENCES [emfac].[emfac_vehicle_class] ([emfac_vehicle_class_id]),
	CONSTRAINT [fk_emfac_vehicle_map_sandag_vehicle_class] FOREIGN KEY ([sandag_vehicle_class_id]) REFERENCES [emfac].[sandag_vehicle_class] ([sandag_vehicle_class_id])
	) 
ON 
	[reference_fg]
WITH 
	(DATA_COMPRESSION = PAGE)
GO

-- create temporary table to hold sandag to emfac vehicle class map
-- and insert values
CREATE TABLE #tt_emfac_vehicle_map (
	[sandag_vehicle_class] varchar(50) NOT NULL,
	[emfac_vehicle_class] varchar(50) NOT NULL,
	[major_version] varchar(5) NOT NULL,
	[minor_version] varchar(5) NOT NULL,
	CONSTRAINT pk_tt_emfac_vehicle_map PRIMARY KEY ([sandag_vehicle_class], [emfac_vehicle_class], [major_version], [minor_version]))
INSERT INTO #tt_emfac_vehicle_map VALUES
	('Drive Alone Non-Toll', 'LDA - Dsl', '2014', '1.0'),
	('Drive Alone Non-Toll', 'LDA - Elec', '2014', '1.0'),
	('Drive Alone Non-Toll', 'LDA - Gas', '2014', '1.0'),
	('Drive Alone Non-Toll', 'LDT1 - Dsl', '2014', '1.0'),
	('Drive Alone Non-Toll', 'LDT1 - Elec', '2014', '1.0'),
	('Drive Alone Non-Toll', 'LDT1 - Gas', '2014', '1.0'),
	('Drive Alone Non-Toll', 'LDT2 - Dsl', '2014', '1.0'),
	('Drive Alone Non-Toll', 'LDT2 - Gas', '2014', '1.0'),
	('Drive Alone Non-Toll', 'MCY - Gas', '2014', '1.0'),
	('Drive Alone Non-Toll', 'MDV - Dsl', '2014', '1.0'),
	('Drive Alone Non-Toll', 'MDV - Gas', '2014', '1.0'),
	('Drive Alone Non-Toll', 'MH - Dsl', '2014', '1.0'),
	('Drive Alone Non-Toll', 'MH - Gas', '2014', '1.0'),
	('Drive Alone Toll Eligible', 'LDA - Dsl', '2014', '1.0'),
	('Drive Alone Toll Eligible', 'LDA - Elec', '2014', '1.0'),
	('Drive Alone Toll Eligible', 'LDA - Gas', '2014', '1.0'),
	('Drive Alone Toll Eligible', 'LDT1 - Dsl', '2014', '1.0'),
	('Drive Alone Toll Eligible', 'LDT1 - Elec', '2014', '1.0'),
	('Drive Alone Toll Eligible', 'LDT1 - Gas', '2014', '1.0'),
	('Drive Alone Toll Eligible', 'LDT2 - Dsl', '2014', '1.0'),
	('Drive Alone Toll Eligible', 'LDT2 - Gas', '2014', '1.0'),
	('Drive Alone Toll Eligible', 'MCY - Gas', '2014', '1.0'),
	('Drive Alone Toll Eligible', 'MDV - Dsl', '2014', '1.0'),
	('Drive Alone Toll Eligible', 'MDV - Gas', '2014', '1.0'),
	('Drive Alone Toll Eligible', 'MH - Dsl', '2014', '1.0'),
	('Drive Alone Toll Eligible', 'MH - Gas', '2014', '1.0'),
	('Shared Ride 2 Non-Toll', 'LDA - Dsl', '2014', '1.0'),
	('Shared Ride 2 Non-Toll', 'LDA - Elec', '2014', '1.0'),
	('Shared Ride 2 Non-Toll', 'LDA - Gas', '2014', '1.0'),
	('Shared Ride 2 Non-Toll', 'LDT1 - Dsl', '2014', '1.0'),
	('Shared Ride 2 Non-Toll', 'LDT1 - Elec', '2014', '1.0'),
	('Shared Ride 2 Non-Toll', 'LDT1 - Gas', '2014', '1.0'),
	('Shared Ride 2 Non-Toll', 'LDT2 - Dsl', '2014', '1.0'),
	('Shared Ride 2 Non-Toll', 'LDT2 - Gas', '2014', '1.0'),
	('Shared Ride 2 Non-Toll', 'MCY - Gas', '2014', '1.0'),
	('Shared Ride 2 Non-Toll', 'MDV - Dsl', '2014', '1.0'),
	('Shared Ride 2 Non-Toll', 'MDV - Gas', '2014', '1.0'),
	('Shared Ride 2 Non-Toll', 'MH - Dsl', '2014', '1.0'),
	('Shared Ride 2 Non-Toll', 'MH - Gas', '2014', '1.0'),
	('Shared Ride 2 Toll Eligible', 'LDA - Dsl', '2014', '1.0'),
	('Shared Ride 2 Toll Eligible', 'LDA - Elec', '2014', '1.0'),
	('Shared Ride 2 Toll Eligible', 'LDA - Gas', '2014', '1.0'),
	('Shared Ride 2 Toll Eligible', 'LDT1 - Dsl', '2014', '1.0'),
	('Shared Ride 2 Toll Eligible', 'LDT1 - Elec', '2014', '1.0'),
	('Shared Ride 2 Toll Eligible', 'LDT1 - Gas', '2014', '1.0'),
	('Shared Ride 2 Toll Eligible', 'LDT2 - Dsl', '2014', '1.0'),
	('Shared Ride 2 Toll Eligible', 'LDT2 - Gas', '2014', '1.0'),
	('Shared Ride 2 Toll Eligible', 'MCY - Gas', '2014', '1.0'),
	('Shared Ride 2 Toll Eligible', 'MDV - Dsl', '2014', '1.0'),
	('Shared Ride 2 Toll Eligible', 'MDV - Gas', '2014', '1.0'),
	('Shared Ride 2 Toll Eligible', 'MH - Dsl', '2014', '1.0'),
	('Shared Ride 2 Toll Eligible', 'MH - Gas', '2014', '1.0'),
	('Shared Ride 3 Non-Toll', 'LDA - Dsl', '2014', '1.0'),
	('Shared Ride 3 Non-Toll', 'LDA - Elec', '2014', '1.0'),
	('Shared Ride 3 Non-Toll', 'LDA - Gas', '2014', '1.0'),
	('Shared Ride 3 Non-Toll', 'LDT1 - Dsl', '2014', '1.0'),
	('Shared Ride 3 Non-Toll', 'LDT1 - Elec', '2014', '1.0'),
	('Shared Ride 3 Non-Toll', 'LDT1 - Gas', '2014', '1.0'),
	('Shared Ride 3 Non-Toll', 'LDT2 - Dsl', '2014', '1.0'),
	('Shared Ride 3 Non-Toll', 'LDT2 - Gas', '2014', '1.0'),
	('Shared Ride 3 Non-Toll', 'MCY - Gas', '2014', '1.0'),
	('Shared Ride 3 Non-Toll', 'MDV - Dsl', '2014', '1.0'),
	('Shared Ride 3 Non-Toll', 'MDV - Gas', '2014', '1.0'),
	('Shared Ride 3 Non-Toll', 'MH - Dsl', '2014', '1.0'),
	('Shared Ride 3 Non-Toll', 'MH - Gas', '2014', '1.0'),
	('Shared Ride 3 Toll Eligible', 'LDA - Dsl', '2014', '1.0'),
	('Shared Ride 3 Toll Eligible', 'LDA - Elec', '2014', '1.0'),
	('Shared Ride 3 Toll Eligible', 'LDA - Gas', '2014', '1.0'),
	('Shared Ride 3 Toll Eligible', 'LDT1 - Dsl', '2014', '1.0'),
	('Shared Ride 3 Toll Eligible', 'LDT1 - Elec', '2014', '1.0'),
	('Shared Ride 3 Toll Eligible', 'LDT1 - Gas', '2014', '1.0'),
	('Shared Ride 3 Toll Eligible', 'LDT2 - Dsl', '2014', '1.0'),
	('Shared Ride 3 Toll Eligible', 'LDT2 - Gas', '2014', '1.0'),
	('Shared Ride 3 Toll Eligible', 'MCY - Gas', '2014', '1.0'),
	('Shared Ride 3 Toll Eligible', 'MDV - Dsl', '2014', '1.0'),
	('Shared Ride 3 Toll Eligible', 'MDV - Gas', '2014', '1.0'),
	('Shared Ride 3 Toll Eligible', 'MH - Dsl', '2014', '1.0'),
	('Shared Ride 3 Toll Eligible', 'MH - Gas', '2014', '1.0'),
	('Light Heavy Duty Truck (Non-Toll)', 'LHD1 - Dsl', '2014', '1.0'),
	('Light Heavy Duty Truck (Non-Toll)', 'LHD1 - Gas', '2014', '1.0'),
	('Light Heavy Duty Truck (Non-Toll)', 'LHD2 - Dsl', '2014', '1.0'),
	('Light Heavy Duty Truck (Non-Toll)', 'LHD2 - Gas', '2014', '1.0'),
	('Light Heavy Duty Truck (Toll)', 'LHD1 - Dsl', '2014', '1.0'),
	('Light Heavy Duty Truck (Toll)', 'LHD1 - Gas', '2014', '1.0'),
	('Light Heavy Duty Truck (Toll)', 'LHD2 - Dsl', '2014', '1.0'),
	('Light Heavy Duty Truck (Toll)', 'LHD2 - Gas', '2014', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 Ag - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 CAIRP Heavy - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 CAIRP Small - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 Instate Construction Heavy - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 Instate Construction Small - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 Instate Heavy - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 Instate Small - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 OOS Heavy - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 OOS Small - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 Public - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 Utility - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6TS - Gas', '2014', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 Ag - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 CAIRP Heavy - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 CAIRP Small - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 Instate Construction Heavy - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 Instate Construction Small - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 Instate Heavy - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 Instate Small - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 OOS Heavy - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 OOS Small - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 Public - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 Utility - Dsl', '2014', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6TS - Gas', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 Ag - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 CAIRP - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 CAIRP Construction - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 NNOOS - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 NOOS - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 Other Port - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 POLA - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 Public - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 Single - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 Single Construction - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 SWCV - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 Tractor - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 Tractor Construction - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 Utility - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7IS - Gas', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'PTO - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 Ag - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 CAIRP - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 CAIRP Construction - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 NNOOS - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 NOOS - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 Other Port - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 POLA - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 Public - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 Single - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 Single Construction - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 SWCV - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 Tractor - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 Tractor Construction - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 Utility - Dsl', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7IS - Gas', '2014', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'PTO - Dsl', '2014', '1.0'),
	('Highway Network Preload - Bus', 'UBUS - Dsl', '2014', '1.0'),
	('Highway Network Preload - Bus', 'UBUS - Gas', '2014', '1.0'),
	('Drive Alone Non-Toll', 'LDA - Dsl', '2017', '1.0'),
	('Drive Alone Non-Toll', 'LDA - Elec', '2017', '1.0'),
	('Drive Alone Non-Toll', 'LDA - Gas', '2017', '1.0'),
	('Drive Alone Non-Toll', 'LDT1 - Dsl', '2017', '1.0'),
	('Drive Alone Non-Toll', 'LDT1 - Elec', '2017', '1.0'),
	('Drive Alone Non-Toll', 'LDT1 - Gas', '2017', '1.0'),
	('Drive Alone Non-Toll', 'LDT2 - Dsl', '2017', '1.0'),
	('Drive Alone Non-Toll', 'LDT2 - Elec', '2017', '1.0'),
	('Drive Alone Non-Toll', 'LDT2 - Gas', '2017', '1.0'),
	('Drive Alone Non-Toll', 'MCY - Gas', '2017', '1.0'),
	('Drive Alone Non-Toll', 'MDV - Dsl', '2017', '1.0'),
	('Drive Alone Non-Toll', 'MDV - Elec', '2017', '1.0'),
	('Drive Alone Non-Toll', 'MDV - Gas', '2017', '1.0'),
	('Drive Alone Non-Toll', 'MH - Dsl', '2017', '1.0'),
	('Drive Alone Non-Toll', 'MH - Gas', '2017', '1.0'),
	('Drive Alone Toll Eligible', 'LDA - Dsl', '2017', '1.0'),
	('Drive Alone Toll Eligible', 'LDA - Elec', '2017', '1.0'),
	('Drive Alone Toll Eligible', 'LDA - Gas', '2017', '1.0'),
	('Drive Alone Toll Eligible', 'LDT1 - Dsl', '2017', '1.0'),
	('Drive Alone Toll Eligible', 'LDT1 - Elec', '2017', '1.0'),
	('Drive Alone Toll Eligible', 'LDT1 - Gas', '2017', '1.0'),
	('Drive Alone Toll Eligible', 'LDT2 - Dsl', '2017', '1.0'),
	('Drive Alone Toll Eligible', 'LDT2 - Elec', '2017', '1.0'),
	('Drive Alone Toll Eligible', 'LDT2 - Gas', '2017', '1.0'),
	('Drive Alone Toll Eligible', 'MCY - Gas', '2017', '1.0'),
	('Drive Alone Toll Eligible', 'MDV - Dsl', '2017', '1.0'),
	('Drive Alone Toll Eligible', 'MDV - Elec', '2017', '1.0'),
	('Drive Alone Toll Eligible', 'MDV - Gas', '2017', '1.0'),
	('Drive Alone Toll Eligible', 'MH - Dsl', '2017', '1.0'),
	('Drive Alone Toll Eligible', 'MH - Gas', '2017', '1.0'),
	('Shared Ride 2 Non-Toll', 'LDA - Dsl', '2017', '1.0'),
	('Shared Ride 2 Non-Toll', 'LDA - Elec', '2017', '1.0'),
	('Shared Ride 2 Non-Toll', 'LDA - Gas', '2017', '1.0'),
	('Shared Ride 2 Non-Toll', 'LDT1 - Dsl', '2017', '1.0'),
	('Shared Ride 2 Non-Toll', 'LDT1 - Elec', '2017', '1.0'),
	('Shared Ride 2 Non-Toll', 'LDT1 - Gas', '2017', '1.0'),
	('Shared Ride 2 Non-Toll', 'LDT2 - Dsl', '2017', '1.0'),
	('Shared Ride 2 Non-Toll', 'LDT2 - Elec', '2017', '1.0'),
	('Shared Ride 2 Non-Toll', 'LDT2 - Gas', '2017', '1.0'),
	('Shared Ride 2 Non-Toll', 'MCY - Gas', '2017', '1.0'),
	('Shared Ride 2 Non-Toll', 'MDV - Dsl', '2017', '1.0'),
	('Shared Ride 2 Non-Toll', 'MDV - Elec', '2017', '1.0'),
	('Shared Ride 2 Non-Toll', 'MDV - Gas', '2017', '1.0'),
	('Shared Ride 2 Non-Toll', 'MH - Dsl', '2017', '1.0'),
	('Shared Ride 2 Non-Toll', 'MH - Gas', '2017', '1.0'),
	('Shared Ride 2 Toll Eligible', 'LDA - Dsl', '2017', '1.0'),
	('Shared Ride 2 Toll Eligible', 'LDA - Elec', '2017', '1.0'),
	('Shared Ride 2 Toll Eligible', 'LDA - Gas', '2017', '1.0'),
	('Shared Ride 2 Toll Eligible', 'LDT1 - Dsl', '2017', '1.0'),
	('Shared Ride 2 Toll Eligible', 'LDT1 - Elec', '2017', '1.0'),
	('Shared Ride 2 Toll Eligible', 'LDT1 - Gas', '2017', '1.0'),
	('Shared Ride 2 Toll Eligible', 'LDT2 - Dsl', '2017', '1.0'),
	('Shared Ride 2 Toll Eligible', 'LDT2 - Elec', '2017', '1.0'),
	('Shared Ride 2 Toll Eligible', 'LDT2 - Gas', '2017', '1.0'),
	('Shared Ride 2 Toll Eligible', 'MCY - Gas', '2017', '1.0'),
	('Shared Ride 2 Toll Eligible', 'MDV - Dsl', '2017', '1.0'),
	('Shared Ride 2 Toll Eligible', 'MDV - Elec', '2017', '1.0'),
	('Shared Ride 2 Toll Eligible', 'MDV - Gas', '2017', '1.0'),
	('Shared Ride 2 Toll Eligible', 'MH - Dsl', '2017', '1.0'),
	('Shared Ride 2 Toll Eligible', 'MH - Gas', '2017', '1.0'),
	('Shared Ride 3 Non-Toll', 'LDA - Dsl', '2017', '1.0'),
	('Shared Ride 3 Non-Toll', 'LDA - Elec', '2017', '1.0'),
	('Shared Ride 3 Non-Toll', 'LDA - Gas', '2017', '1.0'),
	('Shared Ride 3 Non-Toll', 'LDT1 - Dsl', '2017', '1.0'),
	('Shared Ride 3 Non-Toll', 'LDT1 - Elec', '2017', '1.0'),
	('Shared Ride 3 Non-Toll', 'LDT1 - Gas', '2017', '1.0'),
	('Shared Ride 3 Non-Toll', 'LDT2 - Dsl', '2017', '1.0'),
	('Shared Ride 3 Non-Toll', 'LDT2 - Elec', '2017', '1.0'),
	('Shared Ride 3 Non-Toll', 'LDT2 - Gas', '2017', '1.0'),
	('Shared Ride 3 Non-Toll', 'MCY - Gas', '2017', '1.0'),
	('Shared Ride 3 Non-Toll', 'MDV - Dsl', '2017', '1.0'),
	('Shared Ride 3 Non-Toll', 'MDV - Elec', '2017', '1.0'),
	('Shared Ride 3 Non-Toll', 'MDV - Gas', '2017', '1.0'),
	('Shared Ride 3 Non-Toll', 'MH - Dsl', '2017', '1.0'),
	('Shared Ride 3 Non-Toll', 'MH - Gas', '2017', '1.0'),
	('Shared Ride 3 Toll Eligible', 'LDA - Dsl', '2017', '1.0'),
	('Shared Ride 3 Toll Eligible', 'LDA - Elec', '2017', '1.0'),
	('Shared Ride 3 Toll Eligible', 'LDA - Gas', '2017', '1.0'),
	('Shared Ride 3 Toll Eligible', 'LDT1 - Dsl', '2017', '1.0'),
	('Shared Ride 3 Toll Eligible', 'LDT1 - Elec', '2017', '1.0'),
	('Shared Ride 3 Toll Eligible', 'LDT1 - Gas', '2017', '1.0'),
	('Shared Ride 3 Toll Eligible', 'LDT2 - Dsl', '2017', '1.0'),
	('Shared Ride 3 Toll Eligible', 'LDT2 - Elec', '2017', '1.0'),
	('Shared Ride 3 Toll Eligible', 'LDT2 - Gas', '2017', '1.0'),
	('Shared Ride 3 Toll Eligible', 'MCY - Gas', '2017', '1.0'),
	('Shared Ride 3 Toll Eligible', 'MDV - Dsl', '2017', '1.0'),
	('Shared Ride 3 Toll Eligible', 'MDV - Elec', '2017', '1.0'),
	('Shared Ride 3 Toll Eligible', 'MDV - Gas', '2017', '1.0'),
	('Shared Ride 3 Toll Eligible', 'MH - Dsl', '2017', '1.0'),
	('Shared Ride 3 Toll Eligible', 'MH - Gas', '2017', '1.0'),
	('Light Heavy Duty Truck (Non-Toll)', 'LHD1 - Dsl', '2017', '1.0'),
	('Light Heavy Duty Truck (Non-Toll)', 'LHD1 - Gas', '2017', '1.0'),
	('Light Heavy Duty Truck (Non-Toll)', 'LHD2 - Dsl', '2017', '1.0'),
	('Light Heavy Duty Truck (Non-Toll)', 'LHD2 - Gas', '2017', '1.0'),
	('Light Heavy Duty Truck (Toll)', 'LHD1 - Dsl', '2017', '1.0'),
	('Light Heavy Duty Truck (Toll)', 'LHD1 - Gas', '2017', '1.0'),
	('Light Heavy Duty Truck (Toll)', 'LHD2 - Dsl', '2017', '1.0'),
	('Light Heavy Duty Truck (Toll)', 'LHD2 - Gas', '2017', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 Ag - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 CAIRP Heavy - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 CAIRP Small - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 Instate Construction Heavy - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 Instate Construction Small - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 Instate Heavy - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 Instate Small - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 OOS Heavy - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 OOS Small - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 Public - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6 Utility - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Non-Toll)', 'T6TS - Gas', '2017', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 Ag - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 CAIRP Heavy - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 CAIRP Small - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 Instate Construction Heavy - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 Instate Construction Small - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 Instate Heavy - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 Instate Small - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 OOS Heavy - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 OOS Small - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 Public - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6 Utility - Dsl', '2017', '1.0'),
	('Medium Heavy Duty Truck (Toll)', 'T6TS - Gas', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 Ag - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 CAIRP - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 CAIRP Construction - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 NNOOS - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 NOOS - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 Other Port - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 POLA - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 Public - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 Single - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 Single Construction - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 SWCV - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 SWCV - NG', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 Tractor - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 Tractor Construction - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7 Utility - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'T7IS - Gas', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Non-Toll)', 'PTO - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 Ag - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 CAIRP - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 CAIRP Construction - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 NNOOS - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 NOOS - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 Other Port - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 POLA - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 Public - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 Single - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 Single Construction - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 SWCV - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 SWCV - NG', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 Tractor - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 Tractor Construction - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7 Utility - Dsl', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'T7IS - Gas', '2017', '1.0'),
	('Heavy Heavy Duty Truck (Toll)', 'PTO - Dsl', '2017', '1.0'),
	('Highway Network Preload - Bus', 'UBUS - Dsl', '2017', '1.0'),
	('Highway Network Preload - Bus', 'UBUS - Gas', '2017', '1.0'),
	('Highway Network Preload - Bus', 'UBUS - NG', '2017', '1.0')
GO

-- get the sandag and emfac vehicle class surrogate keys
-- and insert into emfac_vehicle_map table
INSERT INTO [emfac].[emfac_vehicle_map]
SELECT
	[sandag_vehicle_class].[sandag_vehicle_class_id]
	,[emfac_vehicle_class].[emfac_vehicle_class_id]
FROM
	#tt_emfac_vehicle_map
LEFT OUTER JOIN -- if no matches a NULL value will return insert error
	[emfac].[sandag_vehicle_class]
ON
	#tt_emfac_vehicle_map.[sandag_vehicle_class] = [sandag_vehicle_class].[sandag_vehicle_class]
LEFT OUTER JOIN -- if no matches a NULL value will return insert error
	[emfac].[emfac_vehicle_class]
ON
	#tt_emfac_vehicle_map.[emfac_vehicle_class] = [emfac_vehicle_class].[emfac_vehicle_class]
	AND #tt_emfac_vehicle_map.[major_version] = [emfac_vehicle_class].[major_version]
	AND #tt_emfac_vehicle_map.[minor_version] = [emfac_vehicle_class].[minor_version]
GO

-- drop temporary emfac_vehicle_map table
DROP TABLE #tt_emfac_vehicle_map
GO

-- Add metadata for [emfac].[emfac_vehicle_map]
EXECUTE [db_meta].[add_xp] 'emfac.emfac_vehicle_map', 'SUBSYSTEM', 'emfac'
EXECUTE [db_meta].[add_xp] 'emfac.emfac_vehicle_map', 'MS_Description', 'mapping of emfac vehicle classes to sandag vehicle classes'
GO




-- Create fn_emfac_2014_vmt_map table valued function
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[emfac].[fn_emfac_2014_vmt_map]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [emfac].[fn_emfac_2014_vmt_map]
GO

CREATE FUNCTION [emfac].[fn_emfac_2014_vmt_map]
(
	@year integer
)
RETURNS @tbl_emfac_2014_vmt_map TABLE 
(
	[sandag_vehicle_class] varchar(50) NOT NULL
	,[emfac_vehicle_class] varchar(50) NOT NULL
	,[value] float NOT NULL
	,PRIMARY KEY ([sandag_vehicle_class], [emfac_vehicle_class])
)
AS

-- ===========================================================================
-- Author:		Gregor Schroeder
-- Create date: 6/13/2018
-- Description:	Take the EMFAC 2014 sandag to emfac vehicle class map
--	and the default vmt for a given year to create the percentage split of
--  emfac vehicle classes into sandag vehicle classes
-- ===========================================================================
BEGIN

	INSERT INTO @tbl_emfac_2014_vmt_map
	SELECT
		[sandag_vehicle_class]
		,[emfac_vehicle_class]
		,[vmt] / (SUM([vmt]) OVER (PARTITION BY [sandag_vehicle_class])) AS [value] -- calculate pct of sandag_vehicle_class that is made up of emfac_vehicle_class weighted by the default vmt of the emfac_vehicle_class
	FROM (
		SELECT 
			[sandag_vehicle_class].[sandag_vehicle_class]
			,CASE	WHEN [emfac_vehicle_class].[emfac_vehicle_class] = 'LDA - Elec' THEN 'LDA - Gas'
					WHEN [emfac_vehicle_class].[emfac_vehicle_class] = 'LDT1 - Elec' THEN 'LDT1 - Gas'
					ELSE [emfac_vehicle_class].[emfac_vehicle_class]
					END AS [emfac_vehicle_class] -- EMFAC 2014 contains these two modes in the default vmt report but does not allow them in the custom input file
			,SUM([emfac_default_vmt].[vmt]) AS [vmt]
		FROM
			[emfac].[emfac_default_vmt]
		INNER JOIN
			[emfac].[emfac_vehicle_class]
		ON
			[emfac_default_vmt].[emfac_vehicle_class_id] = [emfac_vehicle_class].[emfac_vehicle_class_id]
		INNER JOIN
			[emfac].[emfac_vehicle_map]
		ON
			[emfac_default_vmt].[emfac_vehicle_class_id] = [emfac_vehicle_map].[emfac_vehicle_class_id]
		INNER JOIN
			[emfac].[sandag_vehicle_class]
		ON
			[emfac_vehicle_map].[sandag_vehicle_class_id] = [sandag_vehicle_class].[sandag_vehicle_class_id]
		WHERE
			[emfac_default_vmt].[year] = @year
			AND [emfac_vehicle_class].[major_version] = '2014'
			AND [emfac_vehicle_class].[minor_version] = '1.0'
		GROUP BY
			[sandag_vehicle_class].[sandag_vehicle_class]
			,CASE	WHEN [emfac_vehicle_class].[emfac_vehicle_class] = 'LDA - Elec' THEN 'LDA - Gas'
					WHEN [emfac_vehicle_class].[emfac_vehicle_class] = 'LDT1 - Elec' THEN 'LDT1 - Gas'
					ELSE [emfac_vehicle_class].[emfac_vehicle_class]
					END) AS [tt]-- EMFAC 2014 contains these two modes in the default vmt report but does not allow them in the custom input file

	RETURN 
END
GO

-- Add metadata for [emfac].[fn_emfac_2014_vmt_map]
EXECUTE [db_meta].[add_xp] 'emfac.fn_emfac_2014_vmt_map', 'SUBSYSTEM', 'emfac'
EXECUTE [db_meta].[add_xp] 'emfac.fn_emfac_2014_vmt_map', 'MS_Description', 'emfac 2014 function mapping sandag vehicle classes to emfac vehicle classes using the emfac vehicle class default vmt for a given year'
GO




-- Create fn_emfac_2017_vmt_map table valued function
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[emfac].[fn_emfac_2017_vmt_map]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [emfac].[fn_emfac_2017_vmt_map]
GO

CREATE FUNCTION [emfac].[fn_emfac_2017_vmt_map]
(
	@year integer
)
RETURNS @tbl_emfac_2017_vmt_map TABLE 
(
	[sandag_vehicle_class] varchar(50) NOT NULL
	,[emfac_vehicle_class] varchar(50) NOT NULL
	,[value] float NOT NULL
	,PRIMARY KEY ([sandag_vehicle_class], [emfac_vehicle_class])
)
AS

-- ===========================================================================
-- Author:		Gregor Schroeder
-- Create date: 6/13/2018
-- Description:	Take the EMFAC 2017 sandag to emfac vehicle class map
--	and the default vmt for a given year to create the percentage split of
--  emfac vehicle classes into sandag vehicle classes 
-- ===========================================================================
BEGIN

	INSERT INTO @tbl_emfac_2017_vmt_map
	SELECT
		[sandag_vehicle_class]
		,[emfac_vehicle_class]
		,[vmt] / (SUM([vmt]) OVER (PARTITION BY [sandag_vehicle_class])) AS [value] -- calculate pct of sandag_vehicle_class that is made up of emfac_vehicle_class weighted by the default vmt of the emfac_vehicle_class
	FROM (
		SELECT 
			[sandag_vehicle_class].[sandag_vehicle_class]
			,CASE	WHEN [emfac_vehicle_class].[emfac_vehicle_class] = 'LDA - Elec' THEN 'LDA - Gas'
					WHEN [emfac_vehicle_class].[emfac_vehicle_class] = 'LDT1 - Elec' THEN 'LDT1 - Gas'
					WHEN [emfac_vehicle_class].[emfac_vehicle_class] = 'LDT2 - Elec' THEN 'LDT2 - Gas'
					WHEN [emfac_vehicle_class].[emfac_vehicle_class] = 'MDV - Elec' THEN 'MDV - Gas'
					WHEN [emfac_vehicle_class].[emfac_vehicle_class] = 'UBUS - NG' THEN 'UBUS - Dsl'
					WHEN [emfac_vehicle_class].[emfac_vehicle_class] = 'T7 SWCV - NG' THEN 'T7 SWCV - Dsl'
					ELSE [emfac_vehicle_class].[emfac_vehicle_class]
					END AS [emfac_vehicle_class] -- EMFAC 2017 contains these six modes in the default vmt report but does not allow them in the custom input file
			,SUM([emfac_default_vmt].[vmt]) AS [vmt]
		FROM
			[emfac].[emfac_default_vmt]
		INNER JOIN
			[emfac].[emfac_vehicle_class]
		ON
			[emfac_default_vmt].[emfac_vehicle_class_id] = [emfac_vehicle_class].[emfac_vehicle_class_id]
		INNER JOIN
			[emfac].[emfac_vehicle_map]
		ON
			[emfac_default_vmt].[emfac_vehicle_class_id] = [emfac_vehicle_map].[emfac_vehicle_class_id]
		INNER JOIN
			[emfac].[sandag_vehicle_class]
		ON
			[emfac_vehicle_map].[sandag_vehicle_class_id] = [sandag_vehicle_class].[sandag_vehicle_class_id]
		WHERE
			[emfac_default_vmt].[year] = @year
			AND [emfac_vehicle_class].[major_version] = '2017'
			AND [emfac_vehicle_class].[minor_version] = '1.0'
		GROUP BY
			[sandag_vehicle_class].[sandag_vehicle_class]
			,CASE	WHEN [emfac_vehicle_class].[emfac_vehicle_class] = 'LDA - Elec' THEN 'LDA - Gas'
					WHEN [emfac_vehicle_class].[emfac_vehicle_class] = 'LDT1 - Elec' THEN 'LDT1 - Gas'
					WHEN [emfac_vehicle_class].[emfac_vehicle_class] = 'LDT2 - Elec' THEN 'LDT2 - Gas'
					WHEN [emfac_vehicle_class].[emfac_vehicle_class] = 'MDV - Elec' THEN 'MDV - Gas'
					WHEN [emfac_vehicle_class].[emfac_vehicle_class] = 'UBUS - NG' THEN 'UBUS - Dsl'
					WHEN [emfac_vehicle_class].[emfac_vehicle_class] = 'T7 SWCV - NG' THEN 'T7 SWCV - Dsl'
					ELSE [emfac_vehicle_class].[emfac_vehicle_class]
					END) AS [tt] -- EMFAC 2017 contains these six modes in the default vmt report but does not allow them in the custom input file

	RETURN 
END
GO

-- Add metadata for [emfac].[fn_emfac_2017_vmt_map]
EXECUTE [db_meta].[add_xp] 'emfac.fn_emfac_2017_vmt_map', 'SUBSYSTEM', 'emfac'
EXECUTE [db_meta].[add_xp] 'emfac.fn_emfac_2017_vmt_map', 'MS_Description', 'emfac 2017 function mapping sandag vehicle classes to emfac vehicle classes using the emfac vehicle class default vmt for a given year'
GO




-- Create fn_get_unassigned_vmt table valued function
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[emfac].[fn_get_unassigned_vmt]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [emfac].[fn_get_unassigned_vmt]
GO

CREATE FUNCTION [emfac].[fn_get_unassigned_vmt]
(
	@major_version varchar(5),
	@minor_version varchar(5),
	@year integer
)
RETURNS @tbl_unassigned_vmt TABLE 
(
	[emfac_vehicle_class] varchar(50) NOT NULL
	,[vmt] float NOT NULL
	,PRIMARY KEY ([emfac_vehicle_class])
)
AS

-- ===========================================================================
-- Author:		Gregor Schroeder
-- Create date: 6/13/2018
-- Description:	Take the sandag to emfac vehicle class map for a given EMFAC
--	version and return the default vmt for a given year for all unmapped
--  emfac vehicle classes
-- ===========================================================================
BEGIN

	INSERT INTO @tbl_unassigned_vmt
	SELECT
		[emfac_vehicle_class].[emfac_vehicle_class]
		,ISNULL([vmt], 0) AS [vmt]
	FROM
		[emfac].[emfac_vehicle_class]
	FULL OUTER JOIN -- get all emfac vehicle classes for the year, make it a full and not left outer join to catch errors (default vmt with no emfac vehicle class)
		[emfac].[emfac_default_vmt]
	ON
		[emfac_vehicle_class].[emfac_vehicle_class_id] = [emfac_default_vmt].[emfac_vehicle_class_id]
	LEFT OUTER JOIN
		[emfac].[emfac_vehicle_map]
	ON
		[emfac_default_vmt].[emfac_vehicle_class_id] = [emfac_vehicle_map].[emfac_vehicle_class_id]
	WHERE
		([emfac_default_vmt].[year] = @year OR [emfac_default_vmt].[year] IS NULL) -- get emfac vehicle classes with no default vmt
		AND [emfac_vehicle_class].[major_version] = @major_version
		AND [emfac_vehicle_class].[minor_version] = @minor_version
		AND [emfac_vehicle_map].[emfac_vehicle_map_id] IS NULL -- return unassigned emfac vehicle classes

	RETURN 
END
GO

-- Add metadata for [emfac].[fn_get_unassigned_vmt]
EXECUTE [db_meta].[add_xp] 'emfac.fn_get_unassigned_vmt', 'SUBSYSTEM', 'emfac'
EXECUTE [db_meta].[add_xp] 'emfac.fn_get_unassigned_vmt', 'MS_Description', 'emfac function returning default vmt of unmapped emfac vehicle classes for a given emfac version and a given year'
GO




-- Create sp_emfac_2014_vmt stored procedure
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[emfac].[sp_emfac_2014_vmt]') AND type in (N'P', N'PC'))
DROP PROCEDURE [emfac].[sp_emfac_2014_vmt]
GO

CREATE PROCEDURE [emfac].[sp_emfac_2014_vmt]
	@scenario_id int,
	@bus_pce float = 3.0
AS
-- =============================================
-- Author:		Clint Daniels
-- Create date: 8/6/2014
-- Revised: 6/13/2018 by Gregor Schroeder
-- Description:	VMT function for emfac program
-- =============================================

BEGIN
	SET NOCOUNT ON;

	-- get the scenario year
	DECLARE @year integer;
	SET @year = (
		SELECT 
			[year]
		FROM
			[dimension].[scenario]
		WHERE
			[scenario_id] = @scenario_id)

	-- get model vmt by emfac vehicle class
	SELECT
		'SANDAG' AS [MPO]
		,38 AS [GAI]
		,'San Diego (SD)' AS [Sub-Area]
		,@year AS [Cal_Year]
		,[fn_emfac_2014_vmt_map].[emfac_vehicle_class] AS [Veh_Tech]
		,SUM(([hwy_flow_mode].[flow] / (CASE WHEN [mode].[mode_description] = 'Highway Network Preload - Bus' THEN @bus_pce ELSE 1.0 END)) * [hwy_link].[length_mile] * [fn_emfac_2014_vmt_map].[value]) AS [New Total VMT]
	FROM
		[fact].[hwy_flow_mode]
	INNER JOIN 
		[dimension].[hwy_link]
	ON 
		[hwy_flow_mode].[scenario_id] = [hwy_link].[scenario_id]
		AND [hwy_flow_mode].[hwy_link_id] = [hwy_link].[hwy_link_id]
	INNER JOIN
		[dimension].[mode]
	ON
		[hwy_flow_mode].[mode_id] = [mode].[mode_id]
	LEFT OUTER JOIN -- left outer join keeps NULL records if no matches and throws insert error
		[emfac].[fn_emfac_2014_vmt_map](@year)
	ON 
		[mode].[mode_description] = [fn_emfac_2014_vmt_map].[sandag_vehicle_class]
	WHERE
		[hwy_flow_mode].[scenario_id] = @scenario_id
		AND [hwy_link].[scenario_id] = @scenario_id
	GROUP BY 
		[fn_emfac_2014_vmt_map].[emfac_vehicle_class]

	UNION ALL
	-- get non-assigned classes (e.g., school bus) vmt
	SELECT
		'SANDAG' AS [MPO]
		,38 AS [GAI]
		,'San Diego (SD)' AS [Sub-Area]
		,@year AS [Cal_Year]
		,[emfac_vehicle_class] AS [Veh_Tech]
		,[vmt] AS [New Total VMT]
	FROM
		[emfac].[fn_get_unassigned_vmt]('2014', '1.0', @year)
	ORDER BY
		[emfac_vehicle_class]

END
GO

-- Add metadata for [emfac].[sp_emfac_2014_vmt]
EXECUTE [db_meta].[add_xp] 'emfac.sp_emfac_2014_vmt', 'SUBSYSTEM', 'emfac'
EXECUTE [db_meta].[add_xp] 'emfac.sp_emfac_2014_vmt', 'MS_Description', 'emfac 2014 vmt stored procedure for emfac program'
GO





-- Create sp_emfac_2017_vmt stored procedure
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[emfac].[sp_emfac_2017_vmt]') AND type in (N'P', N'PC'))
DROP PROCEDURE [emfac].[sp_emfac_2017_vmt]
GO

CREATE PROCEDURE [emfac].[sp_emfac_2017_vmt]
	@scenario_id int,
	@bus_pce float = 3.0
AS
-- =============================================
-- Author:		Clint Daniels
-- Create date: 8/6/2014
-- Revised: 6/13/2018 by Gregor Schroeder
-- Description:	VMT function for emfac program
-- =============================================

BEGIN
	SET NOCOUNT ON;

	-- get the scenario year
	DECLARE @year integer;
	SET @year = (
		SELECT 
			[year]
		FROM
			[dimension].[scenario]
		WHERE
			[scenario_id] = @scenario_id)

	-- get model vmt by emfac vehicle class
	SELECT
		'SANDAG' AS [MPO]
		,38 AS [GAI]
		,'San Diego (SD)' AS [Sub-Area]
		,@year AS [Cal_Year]
		,[fn_emfac_2017_vmt_map].[emfac_vehicle_class] AS [Veh_Tech]
		,SUM(([hwy_flow_mode].[flow] / (CASE WHEN [mode].[mode_description] = 'Highway Network Preload - Bus' THEN @bus_pce ELSE 1.0 END)) * [hwy_link].[length_mile] * [fn_emfac_2017_vmt_map].[value]) AS [New Total VMT]
	FROM
		[fact].[hwy_flow_mode]
	INNER JOIN 
		[dimension].[hwy_link]
	ON 
		[hwy_flow_mode].[scenario_id] = [hwy_link].[scenario_id]
		AND [hwy_flow_mode].[hwy_link_id] = [hwy_link].[hwy_link_id]
	INNER JOIN
		[dimension].[mode]
	ON
		[hwy_flow_mode].[mode_id] = [mode].[mode_id]
	LEFT OUTER JOIN -- left outer join keeps NULL records if no matches and throws insert error
		[emfac].[fn_emfac_2017_vmt_map](@year)
	ON 
		[mode].[mode_description] = [fn_emfac_2017_vmt_map].[sandag_vehicle_class]
	WHERE
		[hwy_flow_mode].[scenario_id] = @scenario_id
		AND [hwy_link].[scenario_id] = @scenario_id
	GROUP BY 
		[fn_emfac_2017_vmt_map].[emfac_vehicle_class]

	UNION ALL
	-- get non-assigned classes (e.g., school bus) vmt
	SELECT
		'SANDAG' AS [MPO]
		,38 AS [GAI]
		,'San Diego (SD)' AS [Sub-Area]
		,@year AS [Cal_Year]
		,[emfac_vehicle_class] AS [Veh_Tech]
		,[vmt] AS [New Total VMT]
	FROM
		[emfac].[fn_get_unassigned_vmt]('2017', '1.0', @year)
	ORDER BY
		[emfac_vehicle_class]

END
GO

-- Add metadata for [emfac].[sp_emfac_2017_vmt]
EXECUTE [db_meta].[add_xp] 'emfac.sp_emfac_2017_vmt', 'SUBSYSTEM', 'emfac'
EXECUTE [db_meta].[add_xp] 'emfac.sp_emfac_2017_vmt', 'MS_Description', 'emfac 2017 vmt stored procedure for emfac program'
GO




-- Create sp_emfac_2014_vmt_speed stored procedure
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[emfac].[sp_emfac_2014_vmt_speed]') AND type in (N'P', N'PC'))
DROP PROCEDURE [emfac].[sp_emfac_2014_vmt_speed]
GO

CREATE PROCEDURE [emfac].[sp_emfac_2014_vmt_speed]
	@scenario_id integer,
	@bus_pce float = 3.0
AS
BEGIN

	SET NOCOUNT ON;
	-- get the scenario year
	DECLARE @year integer;
	SET @year = (
		SELECT 
			[year]
		FROM
			[dimension].[scenario]
		WHERE
			[scenario_id] = @scenario_id);

	-- declare table to hold mapping of abm assignment five time of day to hour based representation
	DECLARE @tbl_emfac_time TABLE
	(
		[abm_5_tod] int NOT NULL
		,[emfac_hours] int NOT NULL
	)

	-- define mapping of abm assignment five time of day to hour based representation
	-- TODO this split does not look correct give abm 5 time of day definitions
	INSERT INTO @tbl_emfac_time VALUES
		(5,1),
		(5,2),
		(5,3),
		(5,20),
		(5,21),
		(5,22),
		(5,23),
		(5,24),
		(1,4),
		(1,5),
		(1,6),
		(2,7),
		(2,8),
		(2,9),
		(3,10),
		(3,11),
		(3,12),
		(3,13),
		(3,14),
		(3,15),
		(3,16),
		(4,17),
		(4,18),
		(4,19);


	-- calculate model vmt by emfac vehicle class, hour of day, and speed bin
	--Get the ABM assigned VMT by vehicle type and speed  
	with [vmt_speed] AS (
		SELECT
			[fn_emfac_2014_vmt_map].[emfac_vehicle_class]
			,[hwy_flow_mode].[time_id]
			,CEILING([hwy_flow].[speed] / 5) * 5 AS [speed_bin]
			,SUM(([hwy_flow_mode].[flow] / (CASE WHEN [mode].[mode_description] = 'Highway Network Preload - Bus' THEN @bus_pce ELSE 1.0 END)) * [hwy_link].[length_mile] * [fn_emfac_2014_vmt_map].[value]) AS [vmt]
		FROM
			[fact].[hwy_flow_mode]
		INNER JOIN 
			[dimension].[hwy_link]
		ON 
			[hwy_flow_mode].[scenario_id] = [hwy_link].[scenario_id]
			AND [hwy_flow_mode].[hwy_link_id] = [hwy_link].[hwy_link_id]
		INNER JOIN
			[fact].[hwy_flow]
		ON
			[hwy_flow_mode].[scenario_id] = [hwy_flow].[scenario_id]
			AND [hwy_flow_mode].[hwy_link_ab_tod_id] = [hwy_flow].[hwy_link_ab_tod_id]
		INNER JOIN
			[dimension].[mode]
		ON
			[hwy_flow_mode].[mode_id] = [mode].[mode_id]
		INNER JOIN
			[emfac].[fn_emfac_2014_vmt_map](@year)
		ON
			[mode].[mode_description] = [fn_emfac_2014_vmt_map].[sandag_vehicle_class]
		WHERE
			[hwy_flow_mode].[scenario_id] = @scenario_id
			AND [hwy_link].[scenario_id] = @scenario_id
			AND [hwy_flow].[scenario_id] = @scenario_id
			AND [hwy_flow_mode].[flow] > 0
		GROUP BY 
			[fn_emfac_2014_vmt_map].[emfac_vehicle_class]
			,[hwy_flow_mode].[time_id]
			,CEILING([hwy_flow].[speed] / 5) * 5),
	[unassigned_vmt_speed] AS (
	-- get non-assigned classes (e.g., school bus) vmt by hour and speed bin
	-- use LDA-Gas from model vmt, this is ok as it is just used to create percentage of vmt by speed bin
		SELECT
			[fn_get_unassigned_vmt].[emfac_vehicle_class]
			,[vmt_speed].[time_id]
			,[vmt_speed].[speed_bin]
			,[vmt_speed].[vmt]
		FROM
			[vmt_speed]
		CROSS JOIN
			[emfac].[fn_get_unassigned_vmt]('2014', '1.0', @year)
		WHERE
			[vmt_speed].[emfac_vehicle_class] = 'LDA - Gas'),
	[vmt_speed_pct] AS (
		SELECT
			[emfac_vehicle_class]
			,[emfac_hours]
			,[speed_bin]
			,CASE	WHEN [emfac_vehicle_class] = 'PTO - Dsl' 
						 AND [speed_bin] = 20
					THEN 1 -- assign all PTO - Dsl pct vmt to the 20mph speed bin
					WHEN [emfac_vehicle_class] = 'PTO - Dsl'
					THEN 0 -- all other PTO - Dsl pct vmt by speed bin is set to 0, note CASE statements stop execution when first true is evaluated
					ELSE [vmt] / SUM([vmt]) OVER (PARTITION BY [emfac_vehicle_class], [emfac_hours]) -- create pct of vmt by speed bin
					END AS [class_hr_vmt_pct]
		FROM (
			SELECT
				[emfac_vehicle_class]
				,[emfac_hours]
				,[speed_bin]
				,[vmt]
			FROM
				[vmt_speed]
			INNER JOIN
				[dimension].[time]
			ON
				[vmt_speed].[time_id] = [time].[time_id]
			RIGHT JOIN -- TODO does this make sense? It assigns same vmt to every hour within each assignment period, should it be divided in some way?
			-- I could take the amount of time within each hour that makes up each assignment period and divide the period vmt by that?
				@tbl_emfac_time AS [tbl_emfac_time]
			ON
				[time].[abm_5_tod] = CONVERT(varchar, [tbl_emfac_time].[abm_5_tod])

			UNION ALL

			SELECT
				[emfac_vehicle_class]
				,[emfac_hours]
				,[speed_bin]
				,[vmt]
			FROM
				[unassigned_vmt_speed]
			INNER JOIN
				[dimension].[time]
			ON
				[unassigned_vmt_speed].[time_id] = [time].[time_id]
			RIGHT JOIN -- TODO does this make sense? It assigns same vmt to every hour within each assignment period, should it be divided in some way?
			-- I could take the amount of time within each hour that makes up each assignment period and divide the period vmt by that?
				@tbl_emfac_time AS [tbl_emfac_time]
			ON
				[time].[abm_5_tod] = CONVERT(varchar, [tbl_emfac_time].[abm_5_tod])) AS [tt])
	-- pivot results for final return table
	SELECT
		'SANDAG' AS [MPO]
		,38 AS [GAI]
		,'San Diego (SD)' AS [Sub-Area]
		,@year AS [Cal_Year]
		,[emfac_vehicle_class] AS [Veh_Tech]
		,[emfac_hours] AS [Hour]
		,ISNULL([0],0) + ISNULL([5],0) AS [5mph]
		,ISNULL([10],0) AS [10mph]
		,ISNULL([15],0) AS [15mph]
		,ISNULL([20],0) AS [20mph]
		,ISNULL([25],0) AS [25mph]
		,ISNULL([30],0) AS [30mph]
		,ISNULL([35],0) AS [35mph]
		,ISNULL([40],0) AS [40mph]
		,ISNULL([45],0) AS [45mph]
		,ISNULL([50],0) AS [50mph]
		,ISNULL([55],0) AS [55mph]
		,ISNULL([60],0) AS [60mph]
		,CASE	WHEN [emfac_vehicle_class] IN ('LHD1 - Dsl',
											   'LHD1 - Gas',
											   'LHD2 - Dsl',
											   'LHD2 - Gas',
											   'OBUS - Gas',
											   'SBUS - Dsl',
											   'SBUS - Gas',
											   'T6 Ag - Dsl',
											   'T6 CAIRP Heavy - Dsl',
											   'T6 CAIRP Small - Dsl',
											   'T6 Instate Construction Heavy - Dsl',
											   'T6 Instate Construction Small - Dsl',
											   'T6 Instate Heavy - Dsl',
											   'T6 Instate Small - Dsl',
											   'T6 OOS Heavy - Dsl',
											   'T6 OOS Small - Dsl',
											   'T6 Public - Dsl',
											   'T6 Utility - Dsl',
											   'T6TS - Gas',
											   'T7 Ag - Dsl',
											   'T7 CAIRP - Dsl',
											   'T7 CAIRP Construction - Dsl',
											   'T7 NNOOS - Dsl',
											   'T7 NOOS - Dsl',
											   'T7 Other Port - Dsl',
											   'T7 POAK - Dsl',
											   'T7 POLA - Dsl',
											   'T7 Public - Dsl',
											   'T7 Single - Dsl',
											   'T7 Single Construction - Dsl',
											   'T7 SWCV - Dsl',
											   'T7 Tractor - Dsl',
											   'T7 Tractor Construction - Dsl',
											   'T7 Utility - Dsl',
											   'T7IS - Gas',
											   'UBUS - Dsl',
											   'UBUS - Gas')
				THEN ISNULL([65],0)  + ISNULL([70],0)  + ISNULL([75],0)  + ISNULL([80],0)  + ISNULL([85],0)  + ISNULL([90],0) 
				ELSE ISNULL([65],0) 
				END AS [65mph]
		,CASE	WHEN [emfac_vehicle_class] IN ('LHD1 - Dsl',
											   'LHD1 - Gas',
											   'LHD2 - Dsl',
											   'LHD2 - Gas',
											   'OBUS - Gas',
											   'SBUS - Dsl',
											   'SBUS - Gas',
											   'T6 Ag - Dsl',
											   'T6 CAIRP Heavy - Dsl',
											   'T6 CAIRP Small - Dsl',
											   'T6 Instate Construction Heavy - Dsl',
											   'T6 Instate Construction Small - Dsl',
											   'T6 Instate Heavy - Dsl',
											   'T6 Instate Small - Dsl',
											   'T6 OOS Heavy - Dsl',
											   'T6 OOS Small - Dsl',
											   'T6 Public - Dsl',
											   'T6 Utility - Dsl',
											   'T6TS - Gas',
											   'T7 Ag - Dsl',
											   'T7 CAIRP - Dsl',
											   'T7 CAIRP Construction - Dsl',
											   'T7 NNOOS - Dsl',
											   'T7 NOOS - Dsl',
											   'T7 Other Port - Dsl',
											   'T7 POAK - Dsl',
											   'T7 POLA - Dsl',
											   'T7 Public - Dsl',
											   'T7 Single - Dsl',
											   'T7 Single Construction - Dsl',
											   'T7 SWCV - Dsl',
											   'T7 Tractor - Dsl',
											   'T7 Tractor Construction - Dsl',
											   'T7 Utility - Dsl',
											   'T7IS - Gas',
											   'UBUS - Dsl',
											   'UBUS - Gas')
				THEN 0
				ELSE ISNULL([70],0)
				END AS [70mph]
		,CASE	WHEN [emfac_vehicle_class] IN ('LHD1 - Dsl',
											   'LHD1 - Gas',
											   'LHD2 - Dsl',
											   'LHD2 - Gas',
											   'OBUS - Gas',
											   'SBUS - Dsl',
											   'SBUS - Gas',
											   'T6 Ag - Dsl',
											   'T6 CAIRP Heavy - Dsl',
											   'T6 CAIRP Small - Dsl',
											   'T6 Instate Construction Heavy - Dsl',
											   'T6 Instate Construction Small - Dsl',
											   'T6 Instate Heavy - Dsl',
											   'T6 Instate Small - Dsl',
											   'T6 OOS Heavy - Dsl',
											   'T6 OOS Small - Dsl',
											   'T6 Public - Dsl',
											   'T6 Utility - Dsl',
											   'T6TS - Gas',
											   'T7 Ag - Dsl',
											   'T7 CAIRP - Dsl',
											   'T7 CAIRP Construction - Dsl',
											   'T7 NNOOS - Dsl',
											   'T7 NOOS - Dsl',
											   'T7 Other Port - Dsl',
											   'T7 POAK - Dsl',
											   'T7 POLA - Dsl',
											   'T7 Public - Dsl',
											   'T7 Single - Dsl',
											   'T7 Single Construction - Dsl',
											   'T7 SWCV - Dsl',
											   'T7 Tractor - Dsl',
											   'T7 Tractor Construction - Dsl',
											   'T7 Utility - Dsl',
											   'T7IS - Gas',
											   'UBUS - Dsl',
											   'UBUS - Gas')
				THEN 0
				ELSE ISNULL([75],0)
				END AS [75mph]
		,CASE	WHEN [emfac_vehicle_class] IN ('LHD1 - Dsl',
											   'LHD1 - Gas',
											   'LHD2 - Dsl',
											   'LHD2 - Gas',
											   'OBUS - Gas',
											   'SBUS - Dsl',
											   'SBUS - Gas',
											   'T6 Ag - Dsl',
											   'T6 CAIRP Heavy - Dsl',
											   'T6 CAIRP Small - Dsl',
											   'T6 Instate Construction Heavy - Dsl',
											   'T6 Instate Construction Small - Dsl',
											   'T6 Instate Heavy - Dsl',
											   'T6 Instate Small - Dsl',
											   'T6 OOS Heavy - Dsl',
											   'T6 OOS Small - Dsl',
											   'T6 Public - Dsl',
											   'T6 Utility - Dsl',
											   'T6TS - Gas',
											   'T7 Ag - Dsl',
											   'T7 CAIRP - Dsl',
											   'T7 CAIRP Construction - Dsl',
											   'T7 NNOOS - Dsl',
											   'T7 NOOS - Dsl',
											   'T7 Other Port - Dsl',
											   'T7 POAK - Dsl',
											   'T7 POLA - Dsl',
											   'T7 Public - Dsl',
											   'T7 Single - Dsl',
											   'T7 Single Construction - Dsl',
											   'T7 SWCV - Dsl',
											   'T7 Tractor - Dsl',
											   'T7 Tractor Construction - Dsl',
											   'T7 Utility - Dsl',
											   'T7IS - Gas',
											   'UBUS - Dsl',
											   'UBUS - Gas')
				THEN 0
				ELSE ISNULL([80],0)
				END AS [80mph]
		,CASE	WHEN [emfac_vehicle_class] IN ('LHD1 - Dsl',
											   'LHD1 - Gas',
											   'LHD2 - Dsl',
											   'LHD2 - Gas',
											   'OBUS - Gas',
											   'SBUS - Dsl',
											   'SBUS - Gas',
											   'T6 Ag - Dsl',
											   'T6 CAIRP Heavy - Dsl',
											   'T6 CAIRP Small - Dsl',
											   'T6 Instate Construction Heavy - Dsl',
											   'T6 Instate Construction Small - Dsl',
											   'T6 Instate Heavy - Dsl',
											   'T6 Instate Small - Dsl',
											   'T6 OOS Heavy - Dsl',
											   'T6 OOS Small - Dsl',
											   'T6 Public - Dsl',
											   'T6 Utility - Dsl',
											   'T6TS - Gas',
											   'T7 Ag - Dsl',
											   'T7 CAIRP - Dsl',
											   'T7 CAIRP Construction - Dsl',
											   'T7 NNOOS - Dsl',
											   'T7 NOOS - Dsl',
											   'T7 Other Port - Dsl',
											   'T7 POAK - Dsl',
											   'T7 POLA - Dsl',
											   'T7 Public - Dsl',
											   'T7 Single - Dsl',
											   'T7 Single Construction - Dsl',
											   'T7 SWCV - Dsl',
											   'T7 Tractor - Dsl',
											   'T7 Tractor Construction - Dsl',
											   'T7 Utility - Dsl',
											   'T7IS - Gas',
											   'UBUS - Dsl',
											   'UBUS - Gas')
				THEN 0
				ELSE ISNULL([85],0)
				END AS [85mph]
		,CASE	WHEN [emfac_vehicle_class] IN ('LHD1 - Dsl',
											   'LHD1 - Gas',
											   'LHD2 - Dsl',
											   'LHD2 - Gas',
											   'OBUS - Gas',
											   'SBUS - Dsl',
											   'SBUS - Gas',
											   'T6 Ag - Dsl',
											   'T6 CAIRP Heavy - Dsl',
											   'T6 CAIRP Small - Dsl',
											   'T6 Instate Construction Heavy - Dsl',
											   'T6 Instate Construction Small - Dsl',
											   'T6 Instate Heavy - Dsl',
											   'T6 Instate Small - Dsl',
											   'T6 OOS Heavy - Dsl',
											   'T6 OOS Small - Dsl',
											   'T6 Public - Dsl',
											   'T6 Utility - Dsl',
											   'T6TS - Gas',
											   'T7 Ag - Dsl',
											   'T7 CAIRP - Dsl',
											   'T7 CAIRP Construction - Dsl',
											   'T7 NNOOS - Dsl',
											   'T7 NOOS - Dsl',
											   'T7 Other Port - Dsl',
											   'T7 POAK - Dsl',
											   'T7 POLA - Dsl',
											   'T7 Public - Dsl',
											   'T7 Single - Dsl',
											   'T7 Single Construction - Dsl',
											   'T7 SWCV - Dsl',
											   'T7 Tractor - Dsl',
											   'T7 Tractor Construction - Dsl',
											   'T7 Utility - Dsl',
											   'T7IS - Gas',
											   'UBUS - Dsl',
											   'UBUS - Gas')
				THEN 0
				ELSE ISNULL([90],0)
				END AS [90mph]
	FROM
		[vmt_speed_pct]
	PIVOT
		(SUM([class_hr_vmt_pct]) FOR [speed_bin] IN ([0],
													 [5],
													 [10],
													 [15],
													 [20],
													 [25],
													 [30],
													 [35],
													 [40],
													 [45],
													 [50],
													 [55],
													 [60],
													 [65],
													 [70],
													 [75],
													 [80],
													 [85],
													 [90])) AS [pvt]
	 ORDER BY
		[emfac_vehicle_class]
		,[emfac_hours]

	RETURN
END
GO

-- Add metadata for [emfac].[sp_emfac_2014_vmt_speed]
EXECUTE [db_meta].[add_xp] 'emfac.sp_emfac_2014_vmt_speed', 'SUBSYSTEM', 'emfac'
EXECUTE [db_meta].[add_xp] 'emfac.sp_emfac_2014_vmt_speed', 'MS_Description', 'emfac 2014 vmt by hour and speed bin stored procedure for emfac program'
GO




-- Create sp_emfac_2017_vmt_speed stored procedure
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[emfac].[sp_emfac_2017_vmt_speed]') AND type in (N'P', N'PC'))
DROP PROCEDURE [emfac].[sp_emfac_2017_vmt_speed]
GO

CREATE PROCEDURE [emfac].[sp_emfac_2017_vmt_speed]
	@scenario_id integer,
	@bus_pce float = 3.0
AS
BEGIN

	SET NOCOUNT ON;
	-- get the scenario year
	DECLARE @year integer;
	SET @year = (
		SELECT 
			[year]
		FROM
			[dimension].[scenario]
		WHERE
			[scenario_id] = @scenario_id);

	-- declare table to hold mapping of abm assignment five time of day to hour based representation
	DECLARE @tbl_emfac_time TABLE
	(
		[abm_5_tod] int NOT NULL
		,[emfac_hours] int NOT NULL
	)

	-- define mapping of abm assignment five time of day to hour based representation
	-- TODO this split does not look correct give abm 5 time of day definitions
	INSERT INTO @tbl_emfac_time VALUES
		(5,1),
		(5,2),
		(5,3),
		(5,20),
		(5,21),
		(5,22),
		(5,23),
		(5,24),
		(1,4),
		(1,5),
		(1,6),
		(2,7),
		(2,8),
		(2,9),
		(3,10),
		(3,11),
		(3,12),
		(3,13),
		(3,14),
		(3,15),
		(3,16),
		(4,17),
		(4,18),
		(4,19);


	-- calculate model vmt by emfac vehicle class, hour of day, and speed bin
	--Get the ABM assigned VMT by vehicle type and speed  
	with [vmt_speed] AS (
		SELECT
			[fn_emfac_2017_vmt_map].[emfac_vehicle_class]
			,[hwy_flow_mode].[time_id]
			,CEILING([hwy_flow].[speed] / 5) * 5 AS [speed_bin]
			,SUM(([hwy_flow_mode].[flow] / (CASE WHEN [mode].[mode_description] = 'Highway Network Preload - Bus' THEN @bus_pce ELSE 1.0 END)) * [hwy_link].[length_mile] * [fn_emfac_2017_vmt_map].[value]) AS [vmt]
		FROM
			[fact].[hwy_flow_mode]
		INNER JOIN 
			[dimension].[hwy_link]
		ON 
			[hwy_flow_mode].[scenario_id] = [hwy_link].[scenario_id]
			AND [hwy_flow_mode].[hwy_link_id] = [hwy_link].[hwy_link_id]
		INNER JOIN
			[fact].[hwy_flow]
		ON
			[hwy_flow_mode].[scenario_id] = [hwy_flow].[scenario_id]
			AND [hwy_flow_mode].[hwy_link_ab_tod_id] = [hwy_flow].[hwy_link_ab_tod_id]
		INNER JOIN
			[dimension].[mode]
		ON
			[hwy_flow_mode].[mode_id] = [mode].[mode_id]
		INNER JOIN
			[emfac].[fn_emfac_2017_vmt_map](@year)
		ON
			[mode].[mode_description] = [fn_emfac_2017_vmt_map].[sandag_vehicle_class]
		WHERE
			[hwy_flow_mode].[scenario_id] = @scenario_id
			AND [hwy_link].[scenario_id] = @scenario_id
			AND [hwy_flow].[scenario_id] = @scenario_id
			AND [hwy_flow_mode].[flow] > 0
		GROUP BY 
			[fn_emfac_2017_vmt_map].[emfac_vehicle_class]
			,[hwy_flow_mode].[time_id]
			,CEILING([hwy_flow].[speed] / 5) * 5),
	[unassigned_vmt_speed] AS (
	-- get non-assigned classes (e.g., school bus) vmt by hour and speed bin
	-- use LDA-Gas from model vmt, this is ok as it is just used to create percentage of vmt by speed bin
		SELECT
			[fn_get_unassigned_vmt].[emfac_vehicle_class]
			,[vmt_speed].[time_id]
			,[vmt_speed].[speed_bin]
			,[vmt_speed].[vmt]
		FROM
			[vmt_speed]
		CROSS JOIN
			[emfac].[fn_get_unassigned_vmt]('2017', '1.0', @year)
		WHERE
			[vmt_speed].[emfac_vehicle_class] = 'LDA - Gas'),
	[vmt_speed_pct] AS (
		SELECT
			[emfac_vehicle_class]
			,[emfac_hours]
			,[speed_bin]
			,CASE	WHEN [emfac_vehicle_class] = 'PTO - Dsl' 
						 AND [speed_bin] = 20
					THEN 1 -- assign all PTO - Dsl pct vmt to the 20mph speed bin
					WHEN [emfac_vehicle_class] = 'PTO - Dsl'
					THEN 0 -- all other PTO - Dsl pct vmt by speed bin is set to 0, note CASE statements stop execution when first true is evaluated
					ELSE [vmt] / SUM([vmt]) OVER (PARTITION BY [emfac_vehicle_class], [emfac_hours]) -- create pct of vmt by speed bin
					END AS [class_hr_vmt_pct]
		FROM (
			SELECT
				[emfac_vehicle_class]
				,[emfac_hours]
				,[speed_bin]
				,[vmt]
			FROM
				[vmt_speed]
			INNER JOIN
				[dimension].[time]
			ON
				[vmt_speed].[time_id] = [time].[time_id]
			RIGHT JOIN -- TODO does this make sense? It assigns same vmt to every hour within each assignment period, should it be divided in some way?
			-- I could take the amount of time within each hour that makes up each assignment period and divide the period vmt by that?
				@tbl_emfac_time AS [tbl_emfac_time]
			ON
				[time].[abm_5_tod] = CONVERT(varchar, [tbl_emfac_time].[abm_5_tod])

			UNION ALL

			SELECT
				[emfac_vehicle_class]
				,[emfac_hours]
				,[speed_bin]
				,[vmt]
			FROM
				[unassigned_vmt_speed]
			INNER JOIN
				[dimension].[time]
			ON
				[unassigned_vmt_speed].[time_id] = [time].[time_id]
			RIGHT JOIN -- TODO does this make sense? It assigns same vmt to every hour within each assignment period, should it be divided in some way?
			-- I could take the amount of time within each hour that makes up each assignment period and divide the period vmt by that?
				@tbl_emfac_time AS [tbl_emfac_time]
			ON
				[time].[abm_5_tod] = CONVERT(varchar, [tbl_emfac_time].[abm_5_tod])) AS [tt])
	-- pivot results for final return table
	SELECT
		'SANDAG' AS [MPO]
		,38 AS [GAI]
		,'San Diego (SD)' AS [Sub-Area]
		,@year AS [Cal_Year]
		,[emfac_vehicle_class] AS [Veh_Tech]
		,[emfac_hours] AS [Hour]
		,ISNULL([0],0) + ISNULL([5],0) AS [5mph]
		,ISNULL([10],0) AS [10mph]
		,ISNULL([15],0) AS [15mph]
		,ISNULL([20],0) AS [20mph]
		,ISNULL([25],0) AS [25mph]
		,ISNULL([30],0) AS [30mph]
		,ISNULL([35],0) AS [35mph]
		,ISNULL([40],0) AS [40mph]
		,ISNULL([45],0) AS [45mph]
		,ISNULL([50],0) AS [50mph]
		,ISNULL([55],0) AS [55mph]
		,ISNULL([60],0) AS [60mph]
		,CASE	WHEN [emfac_vehicle_class] IN ('LHD1 - Dsl',
											   'LHD1 - Gas',
											   'LHD2 - Dsl',
											   'LHD2 - Gas',
											   'OBUS - Gas',
											   'SBUS - Dsl',
											   'SBUS - Gas',
											   'T6 Ag - Dsl',
											   'T6 CAIRP Heavy - Dsl',
											   'T6 CAIRP Small - Dsl',
											   'T6 Instate Construction Heavy - Dsl',
											   'T6 Instate Construction Small - Dsl',
											   'T6 Instate Heavy - Dsl',
											   'T6 Instate Small - Dsl',
											   'T6 OOS Heavy - Dsl',
											   'T6 OOS Small - Dsl',
											   'T6 Public - Dsl',
											   'T6 Utility - Dsl',
											   'T6TS - Gas',
											   'T7 Ag - Dsl',
											   'T7 CAIRP - Dsl',
											   'T7 CAIRP Construction - Dsl',
											   'T7 NNOOS - Dsl',
											   'T7 NOOS - Dsl',
											   'T7 Other Port - Dsl',
											   'T7 POAK - Dsl',
											   'T7 POLA - Dsl',
											   'T7 Public - Dsl',
											   'T7 Single - Dsl',
											   'T7 Single Construction - Dsl',
											   'T7 SWCV - Dsl',
											   'T7 Tractor - Dsl',
											   'T7 Tractor Construction - Dsl',
											   'T7 Utility - Dsl',
											   'T7IS - Gas',
											   'UBUS - Dsl',
											   'UBUS - Gas')
				THEN ISNULL([65],0)  + ISNULL([70],0)  + ISNULL([75],0)  + ISNULL([80],0)  + ISNULL([85],0)  + ISNULL([90],0) 
				ELSE ISNULL([65],0) 
				END AS [65mph]
		,CASE	WHEN [emfac_vehicle_class] IN ('LHD1 - Dsl',
											   'LHD1 - Gas',
											   'LHD2 - Dsl',
											   'LHD2 - Gas',
											   'OBUS - Gas',
											   'SBUS - Dsl',
											   'SBUS - Gas',
											   'T6 Ag - Dsl',
											   'T6 CAIRP Heavy - Dsl',
											   'T6 CAIRP Small - Dsl',
											   'T6 Instate Construction Heavy - Dsl',
											   'T6 Instate Construction Small - Dsl',
											   'T6 Instate Heavy - Dsl',
											   'T6 Instate Small - Dsl',
											   'T6 OOS Heavy - Dsl',
											   'T6 OOS Small - Dsl',
											   'T6 Public - Dsl',
											   'T6 Utility - Dsl',
											   'T6TS - Gas',
											   'T7 Ag - Dsl',
											   'T7 CAIRP - Dsl',
											   'T7 CAIRP Construction - Dsl',
											   'T7 NNOOS - Dsl',
											   'T7 NOOS - Dsl',
											   'T7 Other Port - Dsl',
											   'T7 POAK - Dsl',
											   'T7 POLA - Dsl',
											   'T7 Public - Dsl',
											   'T7 Single - Dsl',
											   'T7 Single Construction - Dsl',
											   'T7 SWCV - Dsl',
											   'T7 Tractor - Dsl',
											   'T7 Tractor Construction - Dsl',
											   'T7 Utility - Dsl',
											   'T7IS - Gas',
											   'UBUS - Dsl',
											   'UBUS - Gas')
				THEN 0
				ELSE ISNULL([70],0)
				END AS [70mph]
		,CASE	WHEN [emfac_vehicle_class] IN ('LHD1 - Dsl',
											   'LHD1 - Gas',
											   'LHD2 - Dsl',
											   'LHD2 - Gas',
											   'OBUS - Gas',
											   'SBUS - Dsl',
											   'SBUS - Gas',
											   'T6 Ag - Dsl',
											   'T6 CAIRP Heavy - Dsl',
											   'T6 CAIRP Small - Dsl',
											   'T6 Instate Construction Heavy - Dsl',
											   'T6 Instate Construction Small - Dsl',
											   'T6 Instate Heavy - Dsl',
											   'T6 Instate Small - Dsl',
											   'T6 OOS Heavy - Dsl',
											   'T6 OOS Small - Dsl',
											   'T6 Public - Dsl',
											   'T6 Utility - Dsl',
											   'T6TS - Gas',
											   'T7 Ag - Dsl',
											   'T7 CAIRP - Dsl',
											   'T7 CAIRP Construction - Dsl',
											   'T7 NNOOS - Dsl',
											   'T7 NOOS - Dsl',
											   'T7 Other Port - Dsl',
											   'T7 POAK - Dsl',
											   'T7 POLA - Dsl',
											   'T7 Public - Dsl',
											   'T7 Single - Dsl',
											   'T7 Single Construction - Dsl',
											   'T7 SWCV - Dsl',
											   'T7 Tractor - Dsl',
											   'T7 Tractor Construction - Dsl',
											   'T7 Utility - Dsl',
											   'T7IS - Gas',
											   'UBUS - Dsl',
											   'UBUS - Gas')
				THEN 0
				ELSE ISNULL([75],0)
				END AS [75mph]
		,CASE	WHEN [emfac_vehicle_class] IN ('LHD1 - Dsl',
											   'LHD1 - Gas',
											   'LHD2 - Dsl',
											   'LHD2 - Gas',
											   'OBUS - Gas',
											   'SBUS - Dsl',
											   'SBUS - Gas',
											   'T6 Ag - Dsl',
											   'T6 CAIRP Heavy - Dsl',
											   'T6 CAIRP Small - Dsl',
											   'T6 Instate Construction Heavy - Dsl',
											   'T6 Instate Construction Small - Dsl',
											   'T6 Instate Heavy - Dsl',
											   'T6 Instate Small - Dsl',
											   'T6 OOS Heavy - Dsl',
											   'T6 OOS Small - Dsl',
											   'T6 Public - Dsl',
											   'T6 Utility - Dsl',
											   'T6TS - Gas',
											   'T7 Ag - Dsl',
											   'T7 CAIRP - Dsl',
											   'T7 CAIRP Construction - Dsl',
											   'T7 NNOOS - Dsl',
											   'T7 NOOS - Dsl',
											   'T7 Other Port - Dsl',
											   'T7 POAK - Dsl',
											   'T7 POLA - Dsl',
											   'T7 Public - Dsl',
											   'T7 Single - Dsl',
											   'T7 Single Construction - Dsl',
											   'T7 SWCV - Dsl',
											   'T7 Tractor - Dsl',
											   'T7 Tractor Construction - Dsl',
											   'T7 Utility - Dsl',
											   'T7IS - Gas',
											   'UBUS - Dsl',
											   'UBUS - Gas')
				THEN 0
				ELSE ISNULL([80],0)
				END AS [80mph]
		,CASE	WHEN [emfac_vehicle_class] IN ('LHD1 - Dsl',
											   'LHD1 - Gas',
											   'LHD2 - Dsl',
											   'LHD2 - Gas',
											   'OBUS - Gas',
											   'SBUS - Dsl',
											   'SBUS - Gas',
											   'T6 Ag - Dsl',
											   'T6 CAIRP Heavy - Dsl',
											   'T6 CAIRP Small - Dsl',
											   'T6 Instate Construction Heavy - Dsl',
											   'T6 Instate Construction Small - Dsl',
											   'T6 Instate Heavy - Dsl',
											   'T6 Instate Small - Dsl',
											   'T6 OOS Heavy - Dsl',
											   'T6 OOS Small - Dsl',
											   'T6 Public - Dsl',
											   'T6 Utility - Dsl',
											   'T6TS - Gas',
											   'T7 Ag - Dsl',
											   'T7 CAIRP - Dsl',
											   'T7 CAIRP Construction - Dsl',
											   'T7 NNOOS - Dsl',
											   'T7 NOOS - Dsl',
											   'T7 Other Port - Dsl',
											   'T7 POAK - Dsl',
											   'T7 POLA - Dsl',
											   'T7 Public - Dsl',
											   'T7 Single - Dsl',
											   'T7 Single Construction - Dsl',
											   'T7 SWCV - Dsl',
											   'T7 Tractor - Dsl',
											   'T7 Tractor Construction - Dsl',
											   'T7 Utility - Dsl',
											   'T7IS - Gas',
											   'UBUS - Dsl',
											   'UBUS - Gas')
				THEN 0
				ELSE ISNULL([85],0)
				END AS [85mph]
		,CASE	WHEN [emfac_vehicle_class] IN ('LHD1 - Dsl',
											   'LHD1 - Gas',
											   'LHD2 - Dsl',
											   'LHD2 - Gas',
											   'OBUS - Gas',
											   'SBUS - Dsl',
											   'SBUS - Gas',
											   'T6 Ag - Dsl',
											   'T6 CAIRP Heavy - Dsl',
											   'T6 CAIRP Small - Dsl',
											   'T6 Instate Construction Heavy - Dsl',
											   'T6 Instate Construction Small - Dsl',
											   'T6 Instate Heavy - Dsl',
											   'T6 Instate Small - Dsl',
											   'T6 OOS Heavy - Dsl',
											   'T6 OOS Small - Dsl',
											   'T6 Public - Dsl',
											   'T6 Utility - Dsl',
											   'T6TS - Gas',
											   'T7 Ag - Dsl',
											   'T7 CAIRP - Dsl',
											   'T7 CAIRP Construction - Dsl',
											   'T7 NNOOS - Dsl',
											   'T7 NOOS - Dsl',
											   'T7 Other Port - Dsl',
											   'T7 POAK - Dsl',
											   'T7 POLA - Dsl',
											   'T7 Public - Dsl',
											   'T7 Single - Dsl',
											   'T7 Single Construction - Dsl',
											   'T7 SWCV - Dsl',
											   'T7 Tractor - Dsl',
											   'T7 Tractor Construction - Dsl',
											   'T7 Utility - Dsl',
											   'T7IS - Gas',
											   'UBUS - Dsl',
											   'UBUS - Gas')
				THEN 0
				ELSE ISNULL([90],0)
				END AS [90mph]
	FROM
		[vmt_speed_pct]
	PIVOT
		(SUM([class_hr_vmt_pct]) FOR [speed_bin] IN ([0],
													 [5],
													 [10],
													 [15],
													 [20],
													 [25],
													 [30],
													 [35],
													 [40],
													 [45],
													 [50],
													 [55],
													 [60],
													 [65],
													 [70],
													 [75],
													 [80],
													 [85],
													 [90])) AS [pvt]
	 ORDER BY
		[emfac_vehicle_class]
		,[emfac_hours]

	RETURN
END
GO

-- Add metadata for [emfac].[sp_emfac_2017_vmt_speed]
EXECUTE [db_meta].[add_xp] 'emfac.sp_emfac_2017_vmt_speed', 'SUBSYSTEM', 'emfac'
EXECUTE [db_meta].[add_xp] 'emfac.sp_emfac_2017_vmt_speed', 'MS_Description', 'emfac 2017 vmt by hour and speed bin stored procedure for emfac program'
GO