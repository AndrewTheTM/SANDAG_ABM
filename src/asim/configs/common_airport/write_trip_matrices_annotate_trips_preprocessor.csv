Description,Target,Expression
# add additional fields,,
,party,trips.tour_id.map(tours.number_of_participants)
,tour_participants,"np.where(trips.trip_num ==2, 1, party)"
# code time periods,,
,is_ea,"trips.depart.between(time_periods['EA']['first_hour'], time_periods['EA']['last_hour'])"
,is_am,"trips.depart.between(time_periods['AM']['first_hour'], time_periods['AM']['last_hour'])"
,is_md,"trips.depart.between(time_periods['MD']['first_hour'], time_periods['MD']['last_hour'])"
,is_pm,"trips.depart.between(time_periods['PM']['first_hour'], time_periods['PM']['last_hour'])"
,is_ev,"trips.depart.between(time_periods['EV']['first_hour'], time_periods['EV']['last_hour'])"
# ea trips,,
,DRIVEALONE_EA,"(((trips.trip_mode.isin(['PARK_LOC1','PARK_LOC2','PARK_LOC3','PARK_LOC4','PARK_LOC5','PARK_ESCORT','RENTAL'])) & is_ea & tour_participants ==1) | ((trips.trip_mode.isin(['CURB_LOC1','CURB_LOC2','CURB_LOC3','CURB_LOC4','CURB_LOC5']) & is_ea & trips.trip_num == 2))) * tour_participants"
,SHARED2_EA,"(((trips.trip_mode.isin(['PARK_LOC1','PARK_LOC2','PARK_LOC3','PARK_LOC4','PARK_LOC5','PARK_ESCORT','RENTAL'])) & is_ea & tour_participants >= 3) | ((trips.trip_mode.isin(['RIDEHAIL_LOC1','RIDEHAIL_LOC2','TAXI_LOC1','TAXI_LOC2','CURB_LOC1','CURB_LOC2','CURB_LOC3','CURB_LOC4','CURB_LOC5']) & is_ea & tour_participants >=2))) * tour_participants  / OCC_SHARED3"
,SHARED3_EA,"(((trips.trip_mode.isin(['PARK_LOC1','PARK_LOC2','PARK_LOC3','PARK_LOC4','PARK_LOC5','PARK_ESCORT','RENTAL'])) & is_ea & tour_participants ==2) | ((trips.trip_mode.isin(['RIDEHAIL_LOC1','RIDEHAIL_LOC2','TAXI_LOC1','TAXI_LOC2','CURB_LOC1','CURB_LOC2','CURB_LOC3','CURB_LOC4','CURB_LOC5']) & is_ea & tour_participants == 1))) * tour_participants  / OCC_SHARED2"
,WALK_EA,((trips.trip_mode == 'WALK') & is_ea) * tour_participants
,WALK_TRANSIT_EA,"((trips.trip_mode.isin(['WALK_LOC','WALK_PRM','WALK_MIX'])) & is_ea) * tour_participants"
,DRIVE_TRANSIT_EA,"(trips.trip_mode.isin(['KNR_LOC','KNR_PRM','KNR_MIX','TNC_LOC','TNC_PRM','TNC_MIX']) & is_ea ) * tour_participants"
# am trips,,
,DRIVEALONE_AM,"(((trips.trip_mode.isin(['PARK_LOC1','PARK_LOC2','PARK_LOC3','PARK_LOC4','PARK_LOC5','PARK_ESCORT','RENTAL'])) & is_am & tour_participants ==1) | ((trips.trip_mode.isin(['CURB_LOC1','CURB_LOC2','CURB_LOC3','CURB_LOC4','CURB_LOC5']) & is_am & trips.trip_num == 2))) * tour_participants"
,SHARED2_AM,"(((trips.trip_mode.isin(['PARK_LOC1','PARK_LOC2','PARK_LOC3','PARK_LOC4','PARK_LOC5','PARK_ESCORT','RENTAL'])) & is_am & tour_participants >= 3) | ((trips.trip_mode.isin(['RIDEHAIL_LOC1','RIDEHAIL_LOC2','TAXI_LOC1','TAXI_LOC2','CURB_LOC1','CURB_LOC2','CURB_LOC3','CURB_LOC4','CURB_LOC5']) & is_am & tour_participants >=2))) * tour_participants  / OCC_SHARED3"
,SHARED3_AM,"(((trips.trip_mode.isin(['PARK_LOC1','PARK_LOC2','PARK_LOC3','PARK_LOC4','PARK_LOC5','PARK_ESCORT','RENTAL'])) & is_am & tour_participants ==2) | ((trips.trip_mode.isin(['RIDEHAIL_LOC1','RIDEHAIL_LOC2','TAXI_LOC1','TAXI_LOC2','CURB_LOC1','CURB_LOC2','CURB_LOC3','CURB_LOC4','CURB_LOC5']) & is_am & tour_participants == 1))) * tour_participants  / OCC_SHARED2"
,WALK_AM,((trips.trip_mode == 'WALK') & is_am) * tour_participants
,WALK_TRANSIT_AM,"((trips.trip_mode.isin(['WALK_LOC','WALK_PRM','WALK_MIX'])) & is_am) * tour_participants"
,DRIVE_TRANSIT_AM,"(trips.trip_mode.isin(['KNR_LOC','KNR_PRM','KNR_MIX','TNC_LOC','TNC_PRM','TNC_MIX']) & is_am ) * tour_participants"
# md trips,,
,DRIVEALONE_MD,"(((trips.trip_mode.isin(['PARK_LOC1','PARK_LOC2','PARK_LOC3','PARK_LOC4','PARK_LOC5','PARK_ESCORT','RENTAL'])) & is_md & tour_participants ==1) | ((trips.trip_mode.isin(['CURB_LOC1','CURB_LOC2','CURB_LOC3','CURB_LOC4','CURB_LOC5']) & is_md & trips.trip_num == 2))) * tour_participants"
,SHARED2_MD,"(((trips.trip_mode.isin(['PARK_LOC1','PARK_LOC2','PARK_LOC3','PARK_LOC4','PARK_LOC5','PARK_ESCORT','RENTAL'])) & is_md & tour_participants >= 3) | ((trips.trip_mode.isin(['RIDEHAIL_LOC1','RIDEHAIL_LOC2','TAXI_LOC1','TAXI_LOC2','CURB_LOC1','CURB_LOC2','CURB_LOC3','CURB_LOC4','CURB_LOC5']) & is_md & tour_participants >=2))) * tour_participants  / OCC_SHARED3"
,SHARED3_MD,"(((trips.trip_mode.isin(['PARK_LOC1','PARK_LOC2','PARK_LOC3','PARK_LOC4','PARK_LOC5','PARK_ESCORT','RENTAL'])) & is_md & tour_participants ==2) | ((trips.trip_mode.isin(['RIDEHAIL_LOC1','RIDEHAIL_LOC2','TAXI_LOC1','TAXI_LOC2','CURB_LOC1','CURB_LOC2','CURB_LOC3','CURB_LOC4','CURB_LOC5']) & is_md & tour_participants == 1))) * tour_participants  / OCC_SHARED2"
,WALK_MD,((trips.trip_mode == 'WALK') & is_md) * tour_participants
,WALK_TRANSIT_MD,"((trips.trip_mode.isin(['WALK_LOC','WALK_PRM','WALK_MIX'])) & is_md) * tour_participants"
,DRIVE_TRANSIT_MD,"(trips.trip_mode.isin(['KNR_LOC','KNR_PRM','KNR_MIX','TNC_LOC','TNC_PRM','TNC_MIX']) & is_md ) * tour_participants"
# pm trips,,
,DRIVEALONE_PM,"(((trips.trip_mode.isin(['PARK_LOC1','PARK_LOC2','PARK_LOC3','PARK_LOC4','PARK_LOC5','PARK_ESCORT','RENTAL'])) & is_pm & tour_participants ==1) | ((trips.trip_mode.isin(['CURB_LOC1','CURB_LOC2','CURB_LOC3','CURB_LOC4','CURB_LOC5']) & is_pm & trips.trip_num == 2))) * tour_participants"
,SHARED2_PM,"(((trips.trip_mode.isin(['PARK_LOC1','PARK_LOC2','PARK_LOC3','PARK_LOC4','PARK_LOC5','PARK_ESCORT','RENTAL'])) & is_pm & tour_participants >= 3) | ((trips.trip_mode.isin(['RIDEHAIL_LOC1','RIDEHAIL_LOC2','TAXI_LOC1','TAXI_LOC2','CURB_LOC1','CURB_LOC2','CURB_LOC3','CURB_LOC4','CURB_LOC5']) & is_pm & tour_participants >=2))) * tour_participants  / OCC_SHARED3"
,SHARED3_PM,"(((trips.trip_mode.isin(['PARK_LOC1','PARK_LOC2','PARK_LOC3','PARK_LOC4','PARK_LOC5','PARK_ESCORT','RENTAL'])) & is_pm & tour_participants ==2) | ((trips.trip_mode.isin(['RIDEHAIL_LOC1','RIDEHAIL_LOC2','TAXI_LOC1','TAXI_LOC2','CURB_LOC1','CURB_LOC2','CURB_LOC3','CURB_LOC4','CURB_LOC5']) & is_pm & tour_participants == 1))) * tour_participants  / OCC_SHARED2"
,WALK_PM,((trips.trip_mode == 'WALK') & is_pm) * tour_participants
,WALK_TRANSIT_PM,"((trips.trip_mode.isin(['WALK_LOC','WALK_PRM','WALK_MIX'])) & is_pm) * tour_participants"
,DRIVE_TRANSIT_PM,"(trips.trip_mode.isin(['KNR_LOC','KNR_PRM','KNR_MIX','TNC_LOC','TNC_PRM','TNC_MIX']) & is_pm ) * tour_participants"
# ev trips,,
,DRIVEALONE_EV,"(((trips.trip_mode.isin(['PARK_LOC1','PARK_LOC2','PARK_LOC3','PARK_LOC4','PARK_LOC5','PARK_ESCORT','RENTAL'])) & is_ev & tour_participants ==1) | ((trips.trip_mode.isin(['CURB_LOC1','CURB_LOC2','CURB_LOC3','CURB_LOC4','CURB_LOC5']) & is_ev & trips.trip_num == 2))) * tour_participants"
,SHARED2_EV,"(((trips.trip_mode.isin(['PARK_LOC1','PARK_LOC2','PARK_LOC3','PARK_LOC4','PARK_LOC5','PARK_ESCORT','RENTAL'])) & is_ev & tour_participants >= 3) | ((trips.trip_mode.isin(['RIDEHAIL_LOC1','RIDEHAIL_LOC2','TAXI_LOC1','TAXI_LOC2','CURB_LOC1','CURB_LOC2','CURB_LOC3','CURB_LOC4','CURB_LOC5']) & is_ev & tour_participants >=2))) * tour_participants  / OCC_SHARED3"
,SHARED3_EV,"(((trips.trip_mode.isin(['PARK_LOC1','PARK_LOC2','PARK_LOC3','PARK_LOC4','PARK_LOC5','PARK_ESCORT','RENTAL'])) & is_ev & tour_participants ==2) | ((trips.trip_mode.isin(['RIDEHAIL_LOC1','RIDEHAIL_LOC2','TAXI_LOC1','TAXI_LOC2','CURB_LOC1','CURB_LOC2','CURB_LOC3','CURB_LOC4','CURB_LOC5']) & is_ev & tour_participants == 1))) * tour_participants  / OCC_SHARED2"
,WALK_EV,((trips.trip_mode == 'WALK') & is_ev) * tour_participants
,WALK_TRANSIT_EV,"((trips.trip_mode.isin(['WALK_LOC','WALK_PRM','WALK_MIX'])) & is_ev) * tour_participants"
,DRIVE_TRANSIT_EV,"(trips.trip_mode.isin(['KNR_LOC','KNR_PRM','KNR_MIX','TNC_LOC','TNC_PRM','TNC_MIX']) & is_ev ) * tour_participants"
