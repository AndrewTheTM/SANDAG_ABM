Description,Target,Expression
#,, annotate persons table after workplace_location model has run
,workplace_zone_id,"np.where(persons.get('external_workplace_zone_id',-1) > 0, persons.get('external_workplace_zone_id',-1), persons.workplace_zone_id)"
,workplace_location_logsum,"np.where(persons.get('external_workplace_zone_id',-1) > 0, persons.get('external_workplace_location_logsum',-1), persons.workplace_location_logsum)"
,distance_to_work,"np.where(workplace_zone_id>=0,skim_dict.lookup(persons.home_zone_id, workplace_zone_id, 'DIST'),np.nan)"
workplace_in_cbd,workplace_in_cbd,"reindex(land_use.pseudomsa, persons.workplace_zone_id) < setting('cbd_threshold')"
work_zone_area_type,work_zone_area_type,"reindex(land_use.pseudomsa, persons.workplace_zone_id)"
#,, auto time to work - free flow travel time in both directions. MTC TM1 was MD and MD
#,,roundtrip_auto_time_to_work
,_auto_time_home_to_work,"skim_dict.lookup(persons.home_zone_id, workplace_zone_id, ('SOV_TR_M_TIME', 'MD'))"
,_auto_time_work_to_home,"skim_dict.lookup(workplace_zone_id, persons.home_zone_id, ('SOV_TR_M_TIME', 'MD'))"
,roundtrip_auto_time_to_work,"np.where(workplace_zone_id>=0,_auto_time_home_to_work + _auto_time_work_to_home,0)"
#,,_roundtrip_walk_time_to_work
,_MAX_TIME_TO_WORK,999
,_WALK_SPEED_MPH,3
,_walk_time_home_to_work,"60 * skim_dict.lookup(persons.home_zone_id, workplace_zone_id, 'DIST')/_WALK_SPEED_MPH"
,_walk_time_work_to_home,"60 * skim_dict.lookup(workplace_zone_id, persons.home_zone_id, 'DIST')/_WALK_SPEED_MPH"
,_work_walk_available,(_walk_time_home_to_work > 0) & (_walk_time_work_to_home > 0)
,_roundtrip_walk_time_to_work,"np.where(_work_walk_available, _walk_time_home_to_work + _walk_time_work_to_home, _MAX_TIME_TO_WORK)"
